\hypertarget{stb__image__write_8h_source}{}\doxysection{stb\+\_\+image\+\_\+write.\+h}
\label{stb__image__write_8h_source}\index{C:/Users/wcjb/Documents/CodeSpace/YFlow/img/stb\_image\_write.h@{C:/Users/wcjb/Documents/CodeSpace/YFlow/img/stb\_image\_write.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/* stb\_image\_write -\/ v1.15 -\/ public domain -\/ http://nothings.org/stb}}
\DoxyCodeLine{2 \textcolor{comment}{   writes out PNG/BMP/TGA/JPEG/HDR images to C stdio -\/ Sean Barrett 2010-\/2015}}
\DoxyCodeLine{3 \textcolor{comment}{                                     no warranty implied; use at your own risk}}
\DoxyCodeLine{4 \textcolor{comment}{}}
\DoxyCodeLine{5 \textcolor{comment}{   Before \#including,}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{       \#define STB\_IMAGE\_WRITE\_IMPLEMENTATION}}
\DoxyCodeLine{8 \textcolor{comment}{}}
\DoxyCodeLine{9 \textcolor{comment}{   in the file that you want to have the implementation.}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{   Will probably not work correctly with strict-\/aliasing optimizations.}}
\DoxyCodeLine{12 \textcolor{comment}{}}
\DoxyCodeLine{13 \textcolor{comment}{ABOUT:}}
\DoxyCodeLine{14 \textcolor{comment}{}}
\DoxyCodeLine{15 \textcolor{comment}{   This header file is a library for writing images to C stdio or a callback.}}
\DoxyCodeLine{16 \textcolor{comment}{}}
\DoxyCodeLine{17 \textcolor{comment}{   The PNG output is not optimal; it is 20-\/50\% larger than the file}}
\DoxyCodeLine{18 \textcolor{comment}{   written by a decent optimizing implementation; though providing a custom}}
\DoxyCodeLine{19 \textcolor{comment}{   zlib compress function (see STBIW\_ZLIB\_COMPRESS) can mitigate that.}}
\DoxyCodeLine{20 \textcolor{comment}{   This library is designed for source code compactness and simplicity,}}
\DoxyCodeLine{21 \textcolor{comment}{   not optimal image file size or run-\/time performance.}}
\DoxyCodeLine{22 \textcolor{comment}{}}
\DoxyCodeLine{23 \textcolor{comment}{BUILDING:}}
\DoxyCodeLine{24 \textcolor{comment}{}}
\DoxyCodeLine{25 \textcolor{comment}{   You can \#define STBIW\_ASSERT(x) before the \#include to avoid using assert.h.}}
\DoxyCodeLine{26 \textcolor{comment}{   You can \#define STBIW\_MALLOC(), STBIW\_REALLOC(), and STBIW\_FREE() to replace}}
\DoxyCodeLine{27 \textcolor{comment}{   malloc,realloc,free.}}
\DoxyCodeLine{28 \textcolor{comment}{   You can \#define STBIW\_MEMMOVE() to replace memmove()}}
\DoxyCodeLine{29 \textcolor{comment}{   You can \#define STBIW\_ZLIB\_COMPRESS to use a custom zlib-\/style compress function}}
\DoxyCodeLine{30 \textcolor{comment}{   for PNG compression (instead of the builtin one), it must have the following signature:}}
\DoxyCodeLine{31 \textcolor{comment}{   unsigned char * my\_compress(unsigned char *data, int data\_len, int *out\_len, int quality);}}
\DoxyCodeLine{32 \textcolor{comment}{   The returned data will be freed with STBIW\_FREE() (free() by default),}}
\DoxyCodeLine{33 \textcolor{comment}{   so it must be heap allocated with STBIW\_MALLOC() (malloc() by default),}}
\DoxyCodeLine{34 \textcolor{comment}{}}
\DoxyCodeLine{35 \textcolor{comment}{UNICODE:}}
\DoxyCodeLine{36 \textcolor{comment}{}}
\DoxyCodeLine{37 \textcolor{comment}{   If compiling for Windows and you wish to use Unicode filenames, compile}}
\DoxyCodeLine{38 \textcolor{comment}{   with}}
\DoxyCodeLine{39 \textcolor{comment}{       \#define STBIW\_WINDOWS\_UTF8}}
\DoxyCodeLine{40 \textcolor{comment}{   and pass utf8-\/encoded filenames. Call stbiw\_convert\_wchar\_to\_utf8 to convert}}
\DoxyCodeLine{41 \textcolor{comment}{   Windows wchar\_t filenames to utf8.}}
\DoxyCodeLine{42 \textcolor{comment}{}}
\DoxyCodeLine{43 \textcolor{comment}{USAGE:}}
\DoxyCodeLine{44 \textcolor{comment}{}}
\DoxyCodeLine{45 \textcolor{comment}{   There are five functions, one for each image file format:}}
\DoxyCodeLine{46 \textcolor{comment}{}}
\DoxyCodeLine{47 \textcolor{comment}{     int stbi\_write\_png(char const *filename, int w, int h, int comp, const void *data, int stride\_in\_bytes);}}
\DoxyCodeLine{48 \textcolor{comment}{     int stbi\_write\_bmp(char const *filename, int w, int h, int comp, const void *data);}}
\DoxyCodeLine{49 \textcolor{comment}{     int stbi\_write\_tga(char const *filename, int w, int h, int comp, const void *data);}}
\DoxyCodeLine{50 \textcolor{comment}{     int stbi\_write\_jpg(char const *filename, int w, int h, int comp, const void *data, int quality);}}
\DoxyCodeLine{51 \textcolor{comment}{     int stbi\_write\_hdr(char const *filename, int w, int h, int comp, const float *data);}}
\DoxyCodeLine{52 \textcolor{comment}{}}
\DoxyCodeLine{53 \textcolor{comment}{     void stbi\_flip\_vertically\_on\_write(int flag); // flag is non-\/zero to flip data vertically}}
\DoxyCodeLine{54 \textcolor{comment}{}}
\DoxyCodeLine{55 \textcolor{comment}{   There are also five equivalent functions that use an arbitrary write function. You are}}
\DoxyCodeLine{56 \textcolor{comment}{   expected to open/close your file-\/equivalent before and after calling these:}}
\DoxyCodeLine{57 \textcolor{comment}{}}
\DoxyCodeLine{58 \textcolor{comment}{     int stbi\_write\_png\_to\_func(stbi\_write\_func *func, void *context, int w, int h, int comp, const void  *data, int stride\_in\_bytes);}}
\DoxyCodeLine{59 \textcolor{comment}{     int stbi\_write\_bmp\_to\_func(stbi\_write\_func *func, void *context, int w, int h, int comp, const void  *data);}}
\DoxyCodeLine{60 \textcolor{comment}{     int stbi\_write\_tga\_to\_func(stbi\_write\_func *func, void *context, int w, int h, int comp, const void  *data);}}
\DoxyCodeLine{61 \textcolor{comment}{     int stbi\_write\_hdr\_to\_func(stbi\_write\_func *func, void *context, int w, int h, int comp, const float *data);}}
\DoxyCodeLine{62 \textcolor{comment}{     int stbi\_write\_jpg\_to\_func(stbi\_write\_func *func, void *context, int x, int y, int comp, const void *data, int quality);}}
\DoxyCodeLine{63 \textcolor{comment}{}}
\DoxyCodeLine{64 \textcolor{comment}{   where the callback is:}}
\DoxyCodeLine{65 \textcolor{comment}{      void stbi\_write\_func(void *context, void *data, int size);}}
\DoxyCodeLine{66 \textcolor{comment}{}}
\DoxyCodeLine{67 \textcolor{comment}{   You can configure it with these global variables:}}
\DoxyCodeLine{68 \textcolor{comment}{      int stbi\_write\_tga\_with\_rle;             // defaults to true; set to 0 to disable RLE}}
\DoxyCodeLine{69 \textcolor{comment}{      int stbi\_write\_png\_compression\_level;    // defaults to 8; set to higher for more compression}}
\DoxyCodeLine{70 \textcolor{comment}{      int stbi\_write\_force\_png\_filter;         // defaults to -\/1; set to 0..5 to force a filter mode}}
\DoxyCodeLine{71 \textcolor{comment}{}}
\DoxyCodeLine{72 \textcolor{comment}{}}
\DoxyCodeLine{73 \textcolor{comment}{   You can define STBI\_WRITE\_NO\_STDIO to disable the file variant of these}}
\DoxyCodeLine{74 \textcolor{comment}{   functions, so the library will not use stdio.h at all. However, this will}}
\DoxyCodeLine{75 \textcolor{comment}{   also disable HDR writing, because it requires stdio for formatted output.}}
\DoxyCodeLine{76 \textcolor{comment}{}}
\DoxyCodeLine{77 \textcolor{comment}{   Each function returns 0 on failure and non-\/0 on success.}}
\DoxyCodeLine{78 \textcolor{comment}{}}
\DoxyCodeLine{79 \textcolor{comment}{   The functions create an image file defined by the parameters. The image}}
\DoxyCodeLine{80 \textcolor{comment}{   is a rectangle of pixels stored from left-\/to-\/right, top-\/to-\/bottom.}}
\DoxyCodeLine{81 \textcolor{comment}{   Each pixel contains 'comp' channels of data stored interleaved with 8-\/bits}}
\DoxyCodeLine{82 \textcolor{comment}{   per channel, in the following order: 1=Y, 2=YA, 3=RGB, 4=RGBA. (Y is}}
\DoxyCodeLine{83 \textcolor{comment}{   monochrome color.) The rectangle is 'w' pixels wide and 'h' pixels tall.}}
\DoxyCodeLine{84 \textcolor{comment}{   The *data pointer points to the first byte of the top-\/left-\/most pixel.}}
\DoxyCodeLine{85 \textcolor{comment}{   For PNG, "{}stride\_in\_bytes"{} is the distance in bytes from the first byte of}}
\DoxyCodeLine{86 \textcolor{comment}{   a row of pixels to the first byte of the next row of pixels.}}
\DoxyCodeLine{87 \textcolor{comment}{}}
\DoxyCodeLine{88 \textcolor{comment}{   PNG creates output files with the same number of components as the input.}}
\DoxyCodeLine{89 \textcolor{comment}{   The BMP format expands Y to RGB in the file format and does not}}
\DoxyCodeLine{90 \textcolor{comment}{   output alpha.}}
\DoxyCodeLine{91 \textcolor{comment}{}}
\DoxyCodeLine{92 \textcolor{comment}{   PNG supports writing rectangles of data even when the bytes storing rows of}}
\DoxyCodeLine{93 \textcolor{comment}{   data are not consecutive in memory (e.g. sub-\/rectangles of a larger image),}}
\DoxyCodeLine{94 \textcolor{comment}{   by supplying the stride between the beginning of adjacent rows. The other}}
\DoxyCodeLine{95 \textcolor{comment}{   formats do not. (Thus you cannot write a native-\/format BMP through the BMP}}
\DoxyCodeLine{96 \textcolor{comment}{   writer, both because it is in BGR order and because it may have padding}}
\DoxyCodeLine{97 \textcolor{comment}{   at the end of the line.)}}
\DoxyCodeLine{98 \textcolor{comment}{}}
\DoxyCodeLine{99 \textcolor{comment}{   PNG allows you to set the deflate compression level by setting the global}}
\DoxyCodeLine{100 \textcolor{comment}{   variable 'stbi\_write\_png\_compression\_level' (it defaults to 8).}}
\DoxyCodeLine{101 \textcolor{comment}{}}
\DoxyCodeLine{102 \textcolor{comment}{   HDR expects linear float data. Since the format is always 32-\/bit rgb(e)}}
\DoxyCodeLine{103 \textcolor{comment}{   data, alpha (if provided) is discarded, and for monochrome data it is}}
\DoxyCodeLine{104 \textcolor{comment}{   replicated across all three channels.}}
\DoxyCodeLine{105 \textcolor{comment}{}}
\DoxyCodeLine{106 \textcolor{comment}{   TGA supports RLE or non-\/RLE compressed data. To use non-\/RLE-\/compressed}}
\DoxyCodeLine{107 \textcolor{comment}{   data, set the global variable 'stbi\_write\_tga\_with\_rle' to 0.}}
\DoxyCodeLine{108 \textcolor{comment}{}}
\DoxyCodeLine{109 \textcolor{comment}{   JPEG does ignore alpha channels in input data; quality is between 1 and 100.}}
\DoxyCodeLine{110 \textcolor{comment}{   Higher quality looks better but results in a bigger image.}}
\DoxyCodeLine{111 \textcolor{comment}{   JPEG baseline (no JPEG progressive).}}
\DoxyCodeLine{112 \textcolor{comment}{}}
\DoxyCodeLine{113 \textcolor{comment}{CREDITS:}}
\DoxyCodeLine{114 \textcolor{comment}{}}
\DoxyCodeLine{115 \textcolor{comment}{}}
\DoxyCodeLine{116 \textcolor{comment}{   Sean Barrett           -\/    PNG/BMP/TGA}}
\DoxyCodeLine{117 \textcolor{comment}{   Baldur Karlsson        -\/    HDR}}
\DoxyCodeLine{118 \textcolor{comment}{   Jean-\/Sebastien Guay    -\/    TGA monochrome}}
\DoxyCodeLine{119 \textcolor{comment}{   Tim Kelsey             -\/    misc enhancements}}
\DoxyCodeLine{120 \textcolor{comment}{   Alan Hickman           -\/    TGA RLE}}
\DoxyCodeLine{121 \textcolor{comment}{   Emmanuel Julien        -\/    initial file IO callback implementation}}
\DoxyCodeLine{122 \textcolor{comment}{   Jon Olick              -\/    original jo\_jpeg.cpp code}}
\DoxyCodeLine{123 \textcolor{comment}{   Daniel Gibson          -\/    integrate JPEG, allow external zlib}}
\DoxyCodeLine{124 \textcolor{comment}{   Aarni Koskela          -\/    allow choosing PNG filter}}
\DoxyCodeLine{125 \textcolor{comment}{}}
\DoxyCodeLine{126 \textcolor{comment}{   bugfixes:}}
\DoxyCodeLine{127 \textcolor{comment}{      github:Chribba}}
\DoxyCodeLine{128 \textcolor{comment}{      Guillaume Chereau}}
\DoxyCodeLine{129 \textcolor{comment}{      github:jry2}}
\DoxyCodeLine{130 \textcolor{comment}{      github:romigrou}}
\DoxyCodeLine{131 \textcolor{comment}{      Sergio Gonzalez}}
\DoxyCodeLine{132 \textcolor{comment}{      Jonas Karlsson}}
\DoxyCodeLine{133 \textcolor{comment}{      Filip Wasil}}
\DoxyCodeLine{134 \textcolor{comment}{      Thatcher Ulrich}}
\DoxyCodeLine{135 \textcolor{comment}{      github:poppolopoppo}}
\DoxyCodeLine{136 \textcolor{comment}{      Patrick Boettcher}}
\DoxyCodeLine{137 \textcolor{comment}{      github:xeekworx}}
\DoxyCodeLine{138 \textcolor{comment}{      Cap Petschulat}}
\DoxyCodeLine{139 \textcolor{comment}{      Simon Rodriguez}}
\DoxyCodeLine{140 \textcolor{comment}{      Ivan Tikhonov}}
\DoxyCodeLine{141 \textcolor{comment}{      github:ignotion}}
\DoxyCodeLine{142 \textcolor{comment}{      Adam Schackart}}
\DoxyCodeLine{143 \textcolor{comment}{}}
\DoxyCodeLine{144 \textcolor{comment}{LICENSE}}
\DoxyCodeLine{145 \textcolor{comment}{}}
\DoxyCodeLine{146 \textcolor{comment}{  See end of file for license information.}}
\DoxyCodeLine{147 \textcolor{comment}{}}
\DoxyCodeLine{148 \textcolor{comment}{*/}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150 \textcolor{preprocessor}{\#ifndef INCLUDE\_STB\_IMAGE\_WRITE\_H}}
\DoxyCodeLine{151 \textcolor{preprocessor}{\#define INCLUDE\_STB\_IMAGE\_WRITE\_H}}
\DoxyCodeLine{152 }
\DoxyCodeLine{153 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{154 }
\DoxyCodeLine{155 \textcolor{comment}{// if STB\_IMAGE\_WRITE\_STATIC causes problems, try defining STBIWDEF to 'inline' or 'static inline'}}
\DoxyCodeLine{156 \textcolor{preprocessor}{\#ifndef STBIWDEF}}
\DoxyCodeLine{157 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_WRITE\_STATIC}}
\DoxyCodeLine{158 \textcolor{preprocessor}{\#define STBIWDEF  static}}
\DoxyCodeLine{159 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{160 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{161 \textcolor{preprocessor}{\#define STBIWDEF  extern "{}C"{}}}
\DoxyCodeLine{162 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{163 \textcolor{preprocessor}{\#define STBIWDEF  extern}}
\DoxyCodeLine{164 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{165 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{166 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{preprocessor}{\#ifndef STB\_IMAGE\_WRITE\_STATIC  }\textcolor{comment}{// C++ forbids static forward declarations}}
\DoxyCodeLine{169 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} stbi\_write\_tga\_with\_rle;}
\DoxyCodeLine{170 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} stbi\_write\_png\_compression\_level;}
\DoxyCodeLine{171 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} stbi\_write\_force\_png\_filter;}
\DoxyCodeLine{172 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{173 }
\DoxyCodeLine{174 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{175 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_png(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void}  *data, \textcolor{keywordtype}{int} stride\_in\_bytes);}
\DoxyCodeLine{176 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_bmp(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void}  *data);}
\DoxyCodeLine{177 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_tga(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void}  *data);}
\DoxyCodeLine{178 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_hdr(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *data);}
\DoxyCodeLine{179 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_jpg(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void}  *data, \textcolor{keywordtype}{int} quality);}
\DoxyCodeLine{180 }
\DoxyCodeLine{181 \textcolor{preprocessor}{\#ifdef STBI\_WINDOWS\_UTF8}}
\DoxyCodeLine{182 STBIWDEF \textcolor{keywordtype}{int} stbiw\_convert\_wchar\_to\_utf8(\textcolor{keywordtype}{char} *buffer, \textcolor{keywordtype}{size\_t} bufferlen, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* input);}
\DoxyCodeLine{183 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{184 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{185 }
\DoxyCodeLine{186 \textcolor{keyword}{typedef} \textcolor{keywordtype}{void} stbi\_write\_func(\textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} size);}
\DoxyCodeLine{187 }
\DoxyCodeLine{188 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_png\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void}  *data, \textcolor{keywordtype}{int} stride\_in\_bytes);}
\DoxyCodeLine{189 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_bmp\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void}  *data);}
\DoxyCodeLine{190 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_tga\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void}  *data);}
\DoxyCodeLine{191 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_hdr\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *data);}
\DoxyCodeLine{192 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_jpg\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void}  *data, \textcolor{keywordtype}{int} quality);}
\DoxyCodeLine{193 }
\DoxyCodeLine{194 STBIWDEF \textcolor{keywordtype}{void} stbi\_flip\_vertically\_on\_write(\textcolor{keywordtype}{int} flip\_boolean);}
\DoxyCodeLine{195 }
\DoxyCodeLine{196 \textcolor{preprocessor}{\#endif}\textcolor{comment}{//INCLUDE\_STB\_IMAGE\_WRITE\_H}}
\DoxyCodeLine{197 }
\DoxyCodeLine{198 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_WRITE\_IMPLEMENTATION}}
\DoxyCodeLine{199 }
\DoxyCodeLine{200 \textcolor{preprocessor}{\#ifdef \_WIN32}}
\DoxyCodeLine{201 \textcolor{preprocessor}{   \#ifndef \_CRT\_SECURE\_NO\_WARNINGS}}
\DoxyCodeLine{202 \textcolor{preprocessor}{   \#define \_CRT\_SECURE\_NO\_WARNINGS}}
\DoxyCodeLine{203 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{204 \textcolor{preprocessor}{   \#ifndef \_CRT\_NONSTDC\_NO\_DEPRECATE}}
\DoxyCodeLine{205 \textcolor{preprocessor}{   \#define \_CRT\_NONSTDC\_NO\_DEPRECATE}}
\DoxyCodeLine{206 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{207 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{210 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{211 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{212 }
\DoxyCodeLine{213 \textcolor{preprocessor}{\#include <stdarg.h>}}
\DoxyCodeLine{214 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{215 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{216 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{217 }
\DoxyCodeLine{218 \textcolor{preprocessor}{\#if defined(STBIW\_MALLOC) \&\& defined(STBIW\_FREE) \&\& (defined(STBIW\_REALLOC) || defined(STBIW\_REALLOC\_SIZED))}}
\DoxyCodeLine{219 \textcolor{comment}{// ok}}
\DoxyCodeLine{220 \textcolor{preprocessor}{\#elif !defined(STBIW\_MALLOC) \&\& !defined(STBIW\_FREE) \&\& !defined(STBIW\_REALLOC) \&\& !defined(STBIW\_REALLOC\_SIZED)}}
\DoxyCodeLine{221 \textcolor{comment}{// ok}}
\DoxyCodeLine{222 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{223 \textcolor{preprocessor}{\#error "{}Must define all or none of STBIW\_MALLOC, STBIW\_FREE, and STBIW\_REALLOC (or STBIW\_REALLOC\_SIZED)."{}}}
\DoxyCodeLine{224 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{225 }
\DoxyCodeLine{226 \textcolor{preprocessor}{\#ifndef STBIW\_MALLOC}}
\DoxyCodeLine{227 \textcolor{preprocessor}{\#define STBIW\_MALLOC(sz)        malloc(sz)}}
\DoxyCodeLine{228 \textcolor{preprocessor}{\#define STBIW\_REALLOC(p,newsz)  realloc(p,newsz)}}
\DoxyCodeLine{229 \textcolor{preprocessor}{\#define STBIW\_FREE(p)           free(p)}}
\DoxyCodeLine{230 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{231 }
\DoxyCodeLine{232 \textcolor{preprocessor}{\#ifndef STBIW\_REALLOC\_SIZED}}
\DoxyCodeLine{233 \textcolor{preprocessor}{\#define STBIW\_REALLOC\_SIZED(p,oldsz,newsz) STBIW\_REALLOC(p,newsz)}}
\DoxyCodeLine{234 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{235 }
\DoxyCodeLine{236 }
\DoxyCodeLine{237 \textcolor{preprocessor}{\#ifndef STBIW\_MEMMOVE}}
\DoxyCodeLine{238 \textcolor{preprocessor}{\#define STBIW\_MEMMOVE(a,b,sz) memmove(a,b,sz)}}
\DoxyCodeLine{239 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{240 }
\DoxyCodeLine{241 }
\DoxyCodeLine{242 \textcolor{preprocessor}{\#ifndef STBIW\_ASSERT}}
\DoxyCodeLine{243 \textcolor{preprocessor}{\#include <assert.h>}}
\DoxyCodeLine{244 \textcolor{preprocessor}{\#define STBIW\_ASSERT(x) assert(x)}}
\DoxyCodeLine{245 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{246 }
\DoxyCodeLine{247 \textcolor{preprocessor}{\#define STBIW\_UCHAR(x) (unsigned char) ((x) \& 0xff)}}
\DoxyCodeLine{248 }
\DoxyCodeLine{249 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_WRITE\_STATIC}}
\DoxyCodeLine{250 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_png\_compression\_level = 8;}
\DoxyCodeLine{251 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_tga\_with\_rle = 1;}
\DoxyCodeLine{252 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_force\_png\_filter = -\/1;}
\DoxyCodeLine{253 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{254 \textcolor{keywordtype}{int} stbi\_write\_png\_compression\_level = 8;}
\DoxyCodeLine{255 \textcolor{keywordtype}{int} stbi\_write\_tga\_with\_rle = 1;}
\DoxyCodeLine{256 \textcolor{keywordtype}{int} stbi\_write\_force\_png\_filter = -\/1;}
\DoxyCodeLine{257 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{258 }
\DoxyCodeLine{259 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_flip\_vertically\_on\_write = 0;}
\DoxyCodeLine{260 }
\DoxyCodeLine{261 STBIWDEF \textcolor{keywordtype}{void} stbi\_flip\_vertically\_on\_write(\textcolor{keywordtype}{int} flag)}
\DoxyCodeLine{262 \{}
\DoxyCodeLine{263    stbi\_\_flip\_vertically\_on\_write = flag;}
\DoxyCodeLine{264 \}}
\DoxyCodeLine{265 }
\DoxyCodeLine{266 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{267 \{}
\DoxyCodeLine{268    stbi\_write\_func *func;}
\DoxyCodeLine{269    \textcolor{keywordtype}{void} *context;}
\DoxyCodeLine{270    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} buffer[64];}
\DoxyCodeLine{271    \textcolor{keywordtype}{int} buf\_used;}
\DoxyCodeLine{272 \} stbi\_\_write\_context;}
\DoxyCodeLine{273 }
\DoxyCodeLine{274 \textcolor{comment}{// initialize a callback-\/based context}}
\DoxyCodeLine{275 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_start\_write\_callbacks(stbi\_\_write\_context *s, stbi\_write\_func *c, \textcolor{keywordtype}{void} *context)}
\DoxyCodeLine{276 \{}
\DoxyCodeLine{277    s-\/>func    = c;}
\DoxyCodeLine{278    s-\/>context = context;}
\DoxyCodeLine{279 \}}
\DoxyCodeLine{280 }
\DoxyCodeLine{281 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{282 }
\DoxyCodeLine{283 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_stdio\_write(\textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} size)}
\DoxyCodeLine{284 \{}
\DoxyCodeLine{285    fwrite(data,1,size,(FILE*) context);}
\DoxyCodeLine{286 \}}
\DoxyCodeLine{287 }
\DoxyCodeLine{288 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& defined(STBI\_WINDOWS\_UTF8)}}
\DoxyCodeLine{289 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{290 \textcolor{preprocessor}{\#define STBIW\_EXTERN extern "{}C"{}}}
\DoxyCodeLine{291 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{292 \textcolor{preprocessor}{\#define STBIW\_EXTERN extern}}
\DoxyCodeLine{293 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{294 STBIW\_EXTERN \_\_declspec(dllimport) \textcolor{keywordtype}{int} \_\_stdcall MultiByteToWideChar(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} cp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} flags, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *str, \textcolor{keywordtype}{int} cbmb, \textcolor{keywordtype}{wchar\_t} *widestr, \textcolor{keywordtype}{int} cchwide);}
\DoxyCodeLine{295 STBIW\_EXTERN \_\_declspec(dllimport) \textcolor{keywordtype}{int} \_\_stdcall WideCharToMultiByte(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} cp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} flags, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t} *widestr, \textcolor{keywordtype}{int} cchwide, \textcolor{keywordtype}{char} *str, \textcolor{keywordtype}{int} cbmb, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *defchar, \textcolor{keywordtype}{int} *used\_default);}
\DoxyCodeLine{296 }
\DoxyCodeLine{297 STBIWDEF \textcolor{keywordtype}{int} stbiw\_convert\_wchar\_to\_utf8(\textcolor{keywordtype}{char} *buffer, \textcolor{keywordtype}{size\_t} bufferlen, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* input)}
\DoxyCodeLine{298 \{}
\DoxyCodeLine{299     \textcolor{keywordflow}{return} WideCharToMultiByte(65001 \textcolor{comment}{/* UTF8 */}, 0, input, -\/1, buffer, (\textcolor{keywordtype}{int}) bufferlen, NULL, NULL);}
\DoxyCodeLine{300 \}}
\DoxyCodeLine{301 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{302 }
\DoxyCodeLine{303 \textcolor{keyword}{static} FILE *stbiw\_\_fopen(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{char} \textcolor{keyword}{const} *mode)}
\DoxyCodeLine{304 \{}
\DoxyCodeLine{305    FILE *f;}
\DoxyCodeLine{306 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& defined(STBI\_WINDOWS\_UTF8)}}
\DoxyCodeLine{307    \textcolor{keywordtype}{wchar\_t} wMode[64];}
\DoxyCodeLine{308    \textcolor{keywordtype}{wchar\_t} wFilename[1024];}
\DoxyCodeLine{309     \textcolor{keywordflow}{if} (0 == MultiByteToWideChar(65001 \textcolor{comment}{/* UTF8 */}, 0, filename, -\/1, wFilename, \textcolor{keyword}{sizeof}(wFilename)))}
\DoxyCodeLine{310       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{311 }
\DoxyCodeLine{312     \textcolor{keywordflow}{if} (0 == MultiByteToWideChar(65001 \textcolor{comment}{/* UTF8 */}, 0, mode, -\/1, wMode, \textcolor{keyword}{sizeof}(wMode)))}
\DoxyCodeLine{313       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{314 }
\DoxyCodeLine{315 \textcolor{preprocessor}{\#if \_MSC\_VER >= 1400}}
\DoxyCodeLine{316     \textcolor{keywordflow}{if} (0 != \_wfopen\_s(\&f, wFilename, wMode))}
\DoxyCodeLine{317         f = 0;}
\DoxyCodeLine{318 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{319    f = \_wfopen(wFilename, wMode);}
\DoxyCodeLine{320 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{321 }
\DoxyCodeLine{322 \textcolor{preprocessor}{\#elif defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{323    \textcolor{keywordflow}{if} (0 != fopen\_s(\&f, filename, mode))}
\DoxyCodeLine{324       f=0;}
\DoxyCodeLine{325 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{326    f = fopen(filename, mode);}
\DoxyCodeLine{327 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{328    \textcolor{keywordflow}{return} f;}
\DoxyCodeLine{329 \}}
\DoxyCodeLine{330 }
\DoxyCodeLine{331 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_start\_write\_file(stbi\_\_write\_context *s, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *filename)}
\DoxyCodeLine{332 \{}
\DoxyCodeLine{333    FILE *f = stbiw\_\_fopen(filename, \textcolor{stringliteral}{"{}wb"{}});}
\DoxyCodeLine{334    stbi\_\_start\_write\_callbacks(s, stbi\_\_stdio\_write, (\textcolor{keywordtype}{void} *) f);}
\DoxyCodeLine{335    \textcolor{keywordflow}{return} f != NULL;}
\DoxyCodeLine{336 \}}
\DoxyCodeLine{337 }
\DoxyCodeLine{338 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_end\_write\_file(stbi\_\_write\_context *s)}
\DoxyCodeLine{339 \{}
\DoxyCodeLine{340    fclose((FILE *)s-\/>context);}
\DoxyCodeLine{341 \}}
\DoxyCodeLine{342 }
\DoxyCodeLine{343 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{344 }
\DoxyCodeLine{345 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stbiw\_uint32;}
\DoxyCodeLine{346 \textcolor{keyword}{typedef} \textcolor{keywordtype}{int} stb\_image\_write\_test[\textcolor{keyword}{sizeof}(stbiw\_uint32)==4 ? 1 : -\/1];}
\DoxyCodeLine{347 }
\DoxyCodeLine{348 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_writefv(stbi\_\_write\_context *s, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt, va\_list v)}
\DoxyCodeLine{349 \{}
\DoxyCodeLine{350    \textcolor{keywordflow}{while} (*fmt) \{}
\DoxyCodeLine{351       \textcolor{keywordflow}{switch} (*fmt++) \{}
\DoxyCodeLine{352          \textcolor{keywordflow}{case} \textcolor{charliteral}{' '}: \textcolor{keywordflow}{break};}
\DoxyCodeLine{353          \textcolor{keywordflow}{case} \textcolor{charliteral}{'1'}: \{ \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} x = STBIW\_UCHAR(va\_arg(v, \textcolor{keywordtype}{int}));}
\DoxyCodeLine{354                      s-\/>func(s-\/>context,\&x,1);}
\DoxyCodeLine{355                      \textcolor{keywordflow}{break}; \}}
\DoxyCodeLine{356          \textcolor{keywordflow}{case} \textcolor{charliteral}{'2'}: \{ \textcolor{keywordtype}{int} x = va\_arg(v,\textcolor{keywordtype}{int});}
\DoxyCodeLine{357                      \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} b[2];}
\DoxyCodeLine{358                      b[0] = STBIW\_UCHAR(x);}
\DoxyCodeLine{359                      b[1] = STBIW\_UCHAR(x>>8);}
\DoxyCodeLine{360                      s-\/>func(s-\/>context,b,2);}
\DoxyCodeLine{361                      \textcolor{keywordflow}{break}; \}}
\DoxyCodeLine{362          \textcolor{keywordflow}{case} \textcolor{charliteral}{'4'}: \{ stbiw\_uint32 x = va\_arg(v,\textcolor{keywordtype}{int});}
\DoxyCodeLine{363                      \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} b[4];}
\DoxyCodeLine{364                      b[0]=STBIW\_UCHAR(x);}
\DoxyCodeLine{365                      b[1]=STBIW\_UCHAR(x>>8);}
\DoxyCodeLine{366                      b[2]=STBIW\_UCHAR(x>>16);}
\DoxyCodeLine{367                      b[3]=STBIW\_UCHAR(x>>24);}
\DoxyCodeLine{368                      s-\/>func(s-\/>context,b,4);}
\DoxyCodeLine{369                      \textcolor{keywordflow}{break}; \}}
\DoxyCodeLine{370          \textcolor{keywordflow}{default}:}
\DoxyCodeLine{371             STBIW\_ASSERT(0);}
\DoxyCodeLine{372             \textcolor{keywordflow}{return};}
\DoxyCodeLine{373       \}}
\DoxyCodeLine{374    \}}
\DoxyCodeLine{375 \}}
\DoxyCodeLine{376 }
\DoxyCodeLine{377 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_writef(stbi\_\_write\_context *s, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt, ...)}
\DoxyCodeLine{378 \{}
\DoxyCodeLine{379    va\_list v;}
\DoxyCodeLine{380    va\_start(v, fmt);}
\DoxyCodeLine{381    stbiw\_\_writefv(s, fmt, v);}
\DoxyCodeLine{382    va\_end(v);}
\DoxyCodeLine{383 \}}
\DoxyCodeLine{384 }
\DoxyCodeLine{385 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_flush(stbi\_\_write\_context *s)}
\DoxyCodeLine{386 \{}
\DoxyCodeLine{387    \textcolor{keywordflow}{if} (s-\/>buf\_used) \{}
\DoxyCodeLine{388       s-\/>func(s-\/>context, \&s-\/>buffer, s-\/>buf\_used);}
\DoxyCodeLine{389       s-\/>buf\_used = 0;}
\DoxyCodeLine{390    \}}
\DoxyCodeLine{391 \}}
\DoxyCodeLine{392 }
\DoxyCodeLine{393 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_putc(stbi\_\_write\_context *s, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} c)}
\DoxyCodeLine{394 \{}
\DoxyCodeLine{395    s-\/>func(s-\/>context, \&c, 1);}
\DoxyCodeLine{396 \}}
\DoxyCodeLine{397 }
\DoxyCodeLine{398 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write1(stbi\_\_write\_context *s, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} a)}
\DoxyCodeLine{399 \{}
\DoxyCodeLine{400    \textcolor{keywordflow}{if} (s-\/>buf\_used + 1 > \textcolor{keyword}{sizeof}(s-\/>buffer))}
\DoxyCodeLine{401       stbiw\_\_write\_flush(s);}
\DoxyCodeLine{402    s-\/>buffer[s-\/>buf\_used++] = a;}
\DoxyCodeLine{403 \}}
\DoxyCodeLine{404 }
\DoxyCodeLine{405 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write3(stbi\_\_write\_context *s, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} a, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} b, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} c)}
\DoxyCodeLine{406 \{}
\DoxyCodeLine{407    \textcolor{keywordtype}{int} n;}
\DoxyCodeLine{408    \textcolor{keywordflow}{if} (s-\/>buf\_used + 3 > \textcolor{keyword}{sizeof}(s-\/>buffer))}
\DoxyCodeLine{409       stbiw\_\_write\_flush(s);}
\DoxyCodeLine{410    n = s-\/>buf\_used;}
\DoxyCodeLine{411    s-\/>buf\_used = n+3;}
\DoxyCodeLine{412    s-\/>buffer[n+0] = a;}
\DoxyCodeLine{413    s-\/>buffer[n+1] = b;}
\DoxyCodeLine{414    s-\/>buffer[n+2] = c;}
\DoxyCodeLine{415 \}}
\DoxyCodeLine{416 }
\DoxyCodeLine{417 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_pixel(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} rgb\_dir, \textcolor{keywordtype}{int} comp, \textcolor{keywordtype}{int} write\_alpha, \textcolor{keywordtype}{int} expand\_mono, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *d)}
\DoxyCodeLine{418 \{}
\DoxyCodeLine{419    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} bg[3] = \{ 255, 0, 255\}, px[3];}
\DoxyCodeLine{420    \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{421 }
\DoxyCodeLine{422    \textcolor{keywordflow}{if} (write\_alpha < 0)}
\DoxyCodeLine{423       stbiw\_\_write1(s, d[comp -\/ 1]);}
\DoxyCodeLine{424 }
\DoxyCodeLine{425    \textcolor{keywordflow}{switch} (comp) \{}
\DoxyCodeLine{426       \textcolor{keywordflow}{case} 2: \textcolor{comment}{// 2 pixels = mono + alpha, alpha is written separately, so same as 1-\/channel case}}
\DoxyCodeLine{427       \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{428          \textcolor{keywordflow}{if} (expand\_mono)}
\DoxyCodeLine{429             stbiw\_\_write3(s, d[0], d[0], d[0]); \textcolor{comment}{// monochrome bmp}}
\DoxyCodeLine{430          \textcolor{keywordflow}{else}}
\DoxyCodeLine{431             stbiw\_\_write1(s, d[0]);  \textcolor{comment}{// monochrome TGA}}
\DoxyCodeLine{432          \textcolor{keywordflow}{break};}
\DoxyCodeLine{433       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{434          \textcolor{keywordflow}{if} (!write\_alpha) \{}
\DoxyCodeLine{435             \textcolor{comment}{// composite against pink background}}
\DoxyCodeLine{436             \textcolor{keywordflow}{for} (k = 0; k < 3; ++k)}
\DoxyCodeLine{437                px[k] = bg[k] + ((d[k] -\/ bg[k]) * d[3]) / 255;}
\DoxyCodeLine{438             stbiw\_\_write3(s, px[1 -\/ rgb\_dir], px[1], px[1 + rgb\_dir]);}
\DoxyCodeLine{439             \textcolor{keywordflow}{break};}
\DoxyCodeLine{440          \}}
\DoxyCodeLine{441          \textcolor{comment}{/* FALLTHROUGH */}}
\DoxyCodeLine{442       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{443          stbiw\_\_write3(s, d[1 -\/ rgb\_dir], d[1], d[1 + rgb\_dir]);}
\DoxyCodeLine{444          \textcolor{keywordflow}{break};}
\DoxyCodeLine{445    \}}
\DoxyCodeLine{446    \textcolor{keywordflow}{if} (write\_alpha > 0)}
\DoxyCodeLine{447       stbiw\_\_write1(s, d[comp -\/ 1]);}
\DoxyCodeLine{448 \}}
\DoxyCodeLine{449 }
\DoxyCodeLine{450 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_pixels(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} rgb\_dir, \textcolor{keywordtype}{int} vdir, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} write\_alpha, \textcolor{keywordtype}{int} scanline\_pad, \textcolor{keywordtype}{int} expand\_mono)}
\DoxyCodeLine{451 \{}
\DoxyCodeLine{452    stbiw\_uint32 zero = 0;}
\DoxyCodeLine{453    \textcolor{keywordtype}{int} i,j, j\_end;}
\DoxyCodeLine{454 }
\DoxyCodeLine{455    \textcolor{keywordflow}{if} (y <= 0)}
\DoxyCodeLine{456       \textcolor{keywordflow}{return};}
\DoxyCodeLine{457 }
\DoxyCodeLine{458    \textcolor{keywordflow}{if} (stbi\_\_flip\_vertically\_on\_write)}
\DoxyCodeLine{459       vdir *= -\/1;}
\DoxyCodeLine{460 }
\DoxyCodeLine{461    \textcolor{keywordflow}{if} (vdir < 0) \{}
\DoxyCodeLine{462       j\_end = -\/1; j = y-\/1;}
\DoxyCodeLine{463    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{464       j\_end =  y; j = 0;}
\DoxyCodeLine{465    \}}
\DoxyCodeLine{466 }
\DoxyCodeLine{467    \textcolor{keywordflow}{for} (; j != j\_end; j += vdir) \{}
\DoxyCodeLine{468       \textcolor{keywordflow}{for} (i=0; i < x; ++i) \{}
\DoxyCodeLine{469          \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *d = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) data + (j*x+i)*comp;}
\DoxyCodeLine{470          stbiw\_\_write\_pixel(s, rgb\_dir, comp, write\_alpha, expand\_mono, d);}
\DoxyCodeLine{471       \}}
\DoxyCodeLine{472       stbiw\_\_write\_flush(s);}
\DoxyCodeLine{473       s-\/>func(s-\/>context, \&zero, scanline\_pad);}
\DoxyCodeLine{474    \}}
\DoxyCodeLine{475 \}}
\DoxyCodeLine{476 }
\DoxyCodeLine{477 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbiw\_\_outfile(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} rgb\_dir, \textcolor{keywordtype}{int} vdir, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keywordtype}{int} expand\_mono, \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} alpha, \textcolor{keywordtype}{int} pad, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt, ...)}
\DoxyCodeLine{478 \{}
\DoxyCodeLine{479    \textcolor{keywordflow}{if} (y < 0 || x < 0) \{}
\DoxyCodeLine{480       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{481    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{482       va\_list v;}
\DoxyCodeLine{483       va\_start(v, fmt);}
\DoxyCodeLine{484       stbiw\_\_writefv(s, fmt, v);}
\DoxyCodeLine{485       va\_end(v);}
\DoxyCodeLine{486       stbiw\_\_write\_pixels(s,rgb\_dir,vdir,x,y,comp,data,alpha,pad, expand\_mono);}
\DoxyCodeLine{487       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{488    \}}
\DoxyCodeLine{489 \}}
\DoxyCodeLine{490 }
\DoxyCodeLine{491 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_bmp\_core(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data)}
\DoxyCodeLine{492 \{}
\DoxyCodeLine{493    \textcolor{keywordtype}{int} pad = (-\/x*3) \& 3;}
\DoxyCodeLine{494    \textcolor{keywordflow}{return} stbiw\_\_outfile(s,-\/1,-\/1,x,y,comp,1,(\textcolor{keywordtype}{void} *) data,0,pad,}
\DoxyCodeLine{495            \textcolor{stringliteral}{"{}11 4 22 4"{}} \textcolor{stringliteral}{"{}4 44 22 444444"{}},}
\DoxyCodeLine{496            \textcolor{charliteral}{'B'}, \textcolor{charliteral}{'M'}, 14+40+(x*3+pad)*y, 0,0, 14+40,  \textcolor{comment}{// file header}}
\DoxyCodeLine{497             40, x,y, 1,24, 0,0,0,0,0,0);             \textcolor{comment}{// bitmap header}}
\DoxyCodeLine{498 \}}
\DoxyCodeLine{499 }
\DoxyCodeLine{500 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_bmp\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data)}
\DoxyCodeLine{501 \{}
\DoxyCodeLine{502    stbi\_\_write\_context s = \{ 0 \};}
\DoxyCodeLine{503    stbi\_\_start\_write\_callbacks(\&s, func, context);}
\DoxyCodeLine{504    \textcolor{keywordflow}{return} stbi\_write\_bmp\_core(\&s, x, y, comp, data);}
\DoxyCodeLine{505 \}}
\DoxyCodeLine{506 }
\DoxyCodeLine{507 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{508 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_bmp(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data)}
\DoxyCodeLine{509 \{}
\DoxyCodeLine{510    stbi\_\_write\_context s = \{ 0 \};}
\DoxyCodeLine{511    \textcolor{keywordflow}{if} (stbi\_\_start\_write\_file(\&s,filename)) \{}
\DoxyCodeLine{512       \textcolor{keywordtype}{int} r = stbi\_write\_bmp\_core(\&s, x, y, comp, data);}
\DoxyCodeLine{513       stbi\_\_end\_write\_file(\&s);}
\DoxyCodeLine{514       \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{515    \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{516       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{517 \}}
\DoxyCodeLine{518 \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{519 }
\DoxyCodeLine{520 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_tga\_core(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keywordtype}{void} *data)}
\DoxyCodeLine{521 \{}
\DoxyCodeLine{522    \textcolor{keywordtype}{int} has\_alpha = (comp == 2 || comp == 4);}
\DoxyCodeLine{523    \textcolor{keywordtype}{int} colorbytes = has\_alpha ? comp-\/1 : comp;}
\DoxyCodeLine{524    \textcolor{keywordtype}{int} format = colorbytes < 2 ? 3 : 2; \textcolor{comment}{// 3 color channels (RGB/RGBA) = 2, 1 color channel (Y/YA) = 3}}
\DoxyCodeLine{525 }
\DoxyCodeLine{526    \textcolor{keywordflow}{if} (y < 0 || x < 0)}
\DoxyCodeLine{527       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{528 }
\DoxyCodeLine{529    \textcolor{keywordflow}{if} (!stbi\_write\_tga\_with\_rle) \{}
\DoxyCodeLine{530       \textcolor{keywordflow}{return} stbiw\_\_outfile(s, -\/1, -\/1, x, y, comp, 0, (\textcolor{keywordtype}{void} *) data, has\_alpha, 0,}
\DoxyCodeLine{531          \textcolor{stringliteral}{"{}111 221 2222 11"{}}, 0, 0, format, 0, 0, 0, 0, 0, x, y, (colorbytes + has\_alpha) * 8, has\_alpha * 8);}
\DoxyCodeLine{532    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{533       \textcolor{keywordtype}{int} i,j,k;}
\DoxyCodeLine{534       \textcolor{keywordtype}{int} jend, jdir;}
\DoxyCodeLine{535 }
\DoxyCodeLine{536       stbiw\_\_writef(s, \textcolor{stringliteral}{"{}111 221 2222 11"{}}, 0,0,format+8, 0,0,0, 0,0,x,y, (colorbytes + has\_alpha) * 8, has\_alpha * 8);}
\DoxyCodeLine{537 }
\DoxyCodeLine{538       \textcolor{keywordflow}{if} (stbi\_\_flip\_vertically\_on\_write) \{}
\DoxyCodeLine{539          j = 0;}
\DoxyCodeLine{540          jend = y;}
\DoxyCodeLine{541          jdir = 1;}
\DoxyCodeLine{542       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{543          j = y-\/1;}
\DoxyCodeLine{544          jend = -\/1;}
\DoxyCodeLine{545          jdir = -\/1;}
\DoxyCodeLine{546       \}}
\DoxyCodeLine{547       \textcolor{keywordflow}{for} (; j != jend; j += jdir) \{}
\DoxyCodeLine{548          \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *row = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) data + j * x * comp;}
\DoxyCodeLine{549          \textcolor{keywordtype}{int} len;}
\DoxyCodeLine{550 }
\DoxyCodeLine{551          \textcolor{keywordflow}{for} (i = 0; i < x; i += len) \{}
\DoxyCodeLine{552             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *begin = row + i * comp;}
\DoxyCodeLine{553             \textcolor{keywordtype}{int} diff = 1;}
\DoxyCodeLine{554             len = 1;}
\DoxyCodeLine{555 }
\DoxyCodeLine{556             \textcolor{keywordflow}{if} (i < x -\/ 1) \{}
\DoxyCodeLine{557                ++len;}
\DoxyCodeLine{558                diff = memcmp(begin, row + (i + 1) * comp, comp);}
\DoxyCodeLine{559                \textcolor{keywordflow}{if} (diff) \{}
\DoxyCodeLine{560                   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *prev = begin;}
\DoxyCodeLine{561                   \textcolor{keywordflow}{for} (k = i + 2; k < x \&\& len < 128; ++k) \{}
\DoxyCodeLine{562                      \textcolor{keywordflow}{if} (memcmp(prev, row + k * comp, comp)) \{}
\DoxyCodeLine{563                         prev += comp;}
\DoxyCodeLine{564                         ++len;}
\DoxyCodeLine{565                      \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{566                         -\/-\/len;}
\DoxyCodeLine{567                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{568                      \}}
\DoxyCodeLine{569                   \}}
\DoxyCodeLine{570                \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{571                   \textcolor{keywordflow}{for} (k = i + 2; k < x \&\& len < 128; ++k) \{}
\DoxyCodeLine{572                      \textcolor{keywordflow}{if} (!memcmp(begin, row + k * comp, comp)) \{}
\DoxyCodeLine{573                         ++len;}
\DoxyCodeLine{574                      \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{575                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{576                      \}}
\DoxyCodeLine{577                   \}}
\DoxyCodeLine{578                \}}
\DoxyCodeLine{579             \}}
\DoxyCodeLine{580 }
\DoxyCodeLine{581             \textcolor{keywordflow}{if} (diff) \{}
\DoxyCodeLine{582                \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} header = STBIW\_UCHAR(len -\/ 1);}
\DoxyCodeLine{583                stbiw\_\_write1(s, header);}
\DoxyCodeLine{584                \textcolor{keywordflow}{for} (k = 0; k < len; ++k) \{}
\DoxyCodeLine{585                   stbiw\_\_write\_pixel(s, -\/1, comp, has\_alpha, 0, begin + k * comp);}
\DoxyCodeLine{586                \}}
\DoxyCodeLine{587             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{588                \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} header = STBIW\_UCHAR(len -\/ 129);}
\DoxyCodeLine{589                stbiw\_\_write1(s, header);}
\DoxyCodeLine{590                stbiw\_\_write\_pixel(s, -\/1, comp, has\_alpha, 0, begin);}
\DoxyCodeLine{591             \}}
\DoxyCodeLine{592          \}}
\DoxyCodeLine{593       \}}
\DoxyCodeLine{594       stbiw\_\_write\_flush(s);}
\DoxyCodeLine{595    \}}
\DoxyCodeLine{596    \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{597 \}}
\DoxyCodeLine{598 }
\DoxyCodeLine{599 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_tga\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data)}
\DoxyCodeLine{600 \{}
\DoxyCodeLine{601    stbi\_\_write\_context s = \{ 0 \};}
\DoxyCodeLine{602    stbi\_\_start\_write\_callbacks(\&s, func, context);}
\DoxyCodeLine{603    \textcolor{keywordflow}{return} stbi\_write\_tga\_core(\&s, x, y, comp, (\textcolor{keywordtype}{void} *) data);}
\DoxyCodeLine{604 \}}
\DoxyCodeLine{605 }
\DoxyCodeLine{606 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{607 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_tga(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data)}
\DoxyCodeLine{608 \{}
\DoxyCodeLine{609    stbi\_\_write\_context s = \{ 0 \};}
\DoxyCodeLine{610    \textcolor{keywordflow}{if} (stbi\_\_start\_write\_file(\&s,filename)) \{}
\DoxyCodeLine{611       \textcolor{keywordtype}{int} r = stbi\_write\_tga\_core(\&s, x, y, comp, (\textcolor{keywordtype}{void} *) data);}
\DoxyCodeLine{612       stbi\_\_end\_write\_file(\&s);}
\DoxyCodeLine{613       \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{614    \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{615       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{616 \}}
\DoxyCodeLine{617 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{618 }
\DoxyCodeLine{619 \textcolor{comment}{// *************************************************************************************************}}
\DoxyCodeLine{620 \textcolor{comment}{// Radiance RGBE HDR writer}}
\DoxyCodeLine{621 \textcolor{comment}{// by Baldur Karlsson}}
\DoxyCodeLine{622 }
\DoxyCodeLine{623 \textcolor{preprocessor}{\#define stbiw\_\_max(a, b)  ((a) > (b) ? (a) : (b))}}
\DoxyCodeLine{624 }
\DoxyCodeLine{625 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_linear\_to\_rgbe(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *rgbe, \textcolor{keywordtype}{float} *linear)}
\DoxyCodeLine{626 \{}
\DoxyCodeLine{627    \textcolor{keywordtype}{int} exponent;}
\DoxyCodeLine{628    \textcolor{keywordtype}{float} maxcomp = stbiw\_\_max(linear[0], stbiw\_\_max(linear[1], linear[2]));}
\DoxyCodeLine{629 }
\DoxyCodeLine{630    \textcolor{keywordflow}{if} (maxcomp < 1e-\/32f) \{}
\DoxyCodeLine{631       rgbe[0] = rgbe[1] = rgbe[2] = rgbe[3] = 0;}
\DoxyCodeLine{632    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{633       \textcolor{keywordtype}{float} normalize = (float) frexp(maxcomp, \&exponent) * 256.0f/maxcomp;}
\DoxyCodeLine{634 }
\DoxyCodeLine{635       rgbe[0] = (\textcolor{keywordtype}{unsigned} char)(linear[0] * normalize);}
\DoxyCodeLine{636       rgbe[1] = (\textcolor{keywordtype}{unsigned} char)(linear[1] * normalize);}
\DoxyCodeLine{637       rgbe[2] = (\textcolor{keywordtype}{unsigned} char)(linear[2] * normalize);}
\DoxyCodeLine{638       rgbe[3] = (\textcolor{keywordtype}{unsigned} char)(exponent + 128);}
\DoxyCodeLine{639    \}}
\DoxyCodeLine{640 \}}
\DoxyCodeLine{641 }
\DoxyCodeLine{642 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_run\_data(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} length, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} databyte)}
\DoxyCodeLine{643 \{}
\DoxyCodeLine{644    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} lengthbyte = STBIW\_UCHAR(length+128);}
\DoxyCodeLine{645    STBIW\_ASSERT(length+128 <= 255);}
\DoxyCodeLine{646    s-\/>func(s-\/>context, \&lengthbyte, 1);}
\DoxyCodeLine{647    s-\/>func(s-\/>context, \&databyte, 1);}
\DoxyCodeLine{648 \}}
\DoxyCodeLine{649 }
\DoxyCodeLine{650 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_dump\_data(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} length, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *data)}
\DoxyCodeLine{651 \{}
\DoxyCodeLine{652    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} lengthbyte = STBIW\_UCHAR(length);}
\DoxyCodeLine{653    STBIW\_ASSERT(length <= 128); \textcolor{comment}{// inconsistent with spec but consistent with official code}}
\DoxyCodeLine{654    s-\/>func(s-\/>context, \&lengthbyte, 1);}
\DoxyCodeLine{655    s-\/>func(s-\/>context, data, length);}
\DoxyCodeLine{656 \}}
\DoxyCodeLine{657 }
\DoxyCodeLine{658 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_hdr\_scanline(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} ncomp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *scratch, \textcolor{keywordtype}{float} *scanline)}
\DoxyCodeLine{659 \{}
\DoxyCodeLine{660    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} scanlineheader[4] = \{ 2, 2, 0, 0 \};}
\DoxyCodeLine{661    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} rgbe[4];}
\DoxyCodeLine{662    \textcolor{keywordtype}{float} linear[3];}
\DoxyCodeLine{663    \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{664 }
\DoxyCodeLine{665    scanlineheader[2] = (width\&0xff00)>>8;}
\DoxyCodeLine{666    scanlineheader[3] = (width\&0x00ff);}
\DoxyCodeLine{667 }
\DoxyCodeLine{668    \textcolor{comment}{/* skip RLE for images too small or large */}}
\DoxyCodeLine{669    \textcolor{keywordflow}{if} (width < 8 || width >= 32768) \{}
\DoxyCodeLine{670       \textcolor{keywordflow}{for} (x=0; x < width; x++) \{}
\DoxyCodeLine{671          \textcolor{keywordflow}{switch} (ncomp) \{}
\DoxyCodeLine{672             \textcolor{keywordflow}{case} 4: \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{673             \textcolor{keywordflow}{case} 3: linear[2] = scanline[x*ncomp + 2];}
\DoxyCodeLine{674                     linear[1] = scanline[x*ncomp + 1];}
\DoxyCodeLine{675                     linear[0] = scanline[x*ncomp + 0];}
\DoxyCodeLine{676                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{677             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{678                     linear[0] = linear[1] = linear[2] = scanline[x*ncomp + 0];}
\DoxyCodeLine{679                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{680          \}}
\DoxyCodeLine{681          stbiw\_\_linear\_to\_rgbe(rgbe, linear);}
\DoxyCodeLine{682          s-\/>func(s-\/>context, rgbe, 4);}
\DoxyCodeLine{683       \}}
\DoxyCodeLine{684    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{685       \textcolor{keywordtype}{int} c,r;}
\DoxyCodeLine{686       \textcolor{comment}{/* encode into scratch buffer */}}
\DoxyCodeLine{687       \textcolor{keywordflow}{for} (x=0; x < width; x++) \{}
\DoxyCodeLine{688          \textcolor{keywordflow}{switch}(ncomp) \{}
\DoxyCodeLine{689             \textcolor{keywordflow}{case} 4: \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{690             \textcolor{keywordflow}{case} 3: linear[2] = scanline[x*ncomp + 2];}
\DoxyCodeLine{691                     linear[1] = scanline[x*ncomp + 1];}
\DoxyCodeLine{692                     linear[0] = scanline[x*ncomp + 0];}
\DoxyCodeLine{693                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{694             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{695                     linear[0] = linear[1] = linear[2] = scanline[x*ncomp + 0];}
\DoxyCodeLine{696                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{697          \}}
\DoxyCodeLine{698          stbiw\_\_linear\_to\_rgbe(rgbe, linear);}
\DoxyCodeLine{699          scratch[x + width*0] = rgbe[0];}
\DoxyCodeLine{700          scratch[x + width*1] = rgbe[1];}
\DoxyCodeLine{701          scratch[x + width*2] = rgbe[2];}
\DoxyCodeLine{702          scratch[x + width*3] = rgbe[3];}
\DoxyCodeLine{703       \}}
\DoxyCodeLine{704 }
\DoxyCodeLine{705       s-\/>func(s-\/>context, scanlineheader, 4);}
\DoxyCodeLine{706 }
\DoxyCodeLine{707       \textcolor{comment}{/* RLE each component separately */}}
\DoxyCodeLine{708       \textcolor{keywordflow}{for} (c=0; c < 4; c++) \{}
\DoxyCodeLine{709          \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *comp = \&scratch[width*c];}
\DoxyCodeLine{710 }
\DoxyCodeLine{711          x = 0;}
\DoxyCodeLine{712          \textcolor{keywordflow}{while} (x < width) \{}
\DoxyCodeLine{713             \textcolor{comment}{// find first run}}
\DoxyCodeLine{714             r = x;}
\DoxyCodeLine{715             \textcolor{keywordflow}{while} (r+2 < width) \{}
\DoxyCodeLine{716                \textcolor{keywordflow}{if} (comp[r] == comp[r+1] \&\& comp[r] == comp[r+2])}
\DoxyCodeLine{717                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{718                ++r;}
\DoxyCodeLine{719             \}}
\DoxyCodeLine{720             \textcolor{keywordflow}{if} (r+2 >= width)}
\DoxyCodeLine{721                r = width;}
\DoxyCodeLine{722             \textcolor{comment}{// dump up to first run}}
\DoxyCodeLine{723             \textcolor{keywordflow}{while} (x < r) \{}
\DoxyCodeLine{724                \textcolor{keywordtype}{int} len = r-\/x;}
\DoxyCodeLine{725                \textcolor{keywordflow}{if} (len > 128) len = 128;}
\DoxyCodeLine{726                stbiw\_\_write\_dump\_data(s, len, \&comp[x]);}
\DoxyCodeLine{727                x += len;}
\DoxyCodeLine{728             \}}
\DoxyCodeLine{729             \textcolor{comment}{// if there's a run, output it}}
\DoxyCodeLine{730             \textcolor{keywordflow}{if} (r+2 < width) \{ \textcolor{comment}{// same test as what we break out of in search loop, so only true if we break'd}}
\DoxyCodeLine{731                \textcolor{comment}{// find next byte after run}}
\DoxyCodeLine{732                \textcolor{keywordflow}{while} (r < width \&\& comp[r] == comp[x])}
\DoxyCodeLine{733                   ++r;}
\DoxyCodeLine{734                \textcolor{comment}{// output run up to r}}
\DoxyCodeLine{735                \textcolor{keywordflow}{while} (x < r) \{}
\DoxyCodeLine{736                   \textcolor{keywordtype}{int} len = r-\/x;}
\DoxyCodeLine{737                   \textcolor{keywordflow}{if} (len > 127) len = 127;}
\DoxyCodeLine{738                   stbiw\_\_write\_run\_data(s, len, comp[x]);}
\DoxyCodeLine{739                   x += len;}
\DoxyCodeLine{740                \}}
\DoxyCodeLine{741             \}}
\DoxyCodeLine{742          \}}
\DoxyCodeLine{743       \}}
\DoxyCodeLine{744    \}}
\DoxyCodeLine{745 \}}
\DoxyCodeLine{746 }
\DoxyCodeLine{747 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_hdr\_core(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keywordtype}{float} *data)}
\DoxyCodeLine{748 \{}
\DoxyCodeLine{749    \textcolor{keywordflow}{if} (y <= 0 || x <= 0 || data == NULL)}
\DoxyCodeLine{750       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{751    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{752       \textcolor{comment}{// Each component is stored separately. Allocate scratch space for full output scanline.}}
\DoxyCodeLine{753       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *scratch = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) STBIW\_MALLOC(x*4);}
\DoxyCodeLine{754       \textcolor{keywordtype}{int} i, len;}
\DoxyCodeLine{755       \textcolor{keywordtype}{char} buffer[128];}
\DoxyCodeLine{756       \textcolor{keywordtype}{char} header[] = \textcolor{stringliteral}{"{}\#?RADIANCE\(\backslash\)n\# Written by stb\_image\_write.h\(\backslash\)nFORMAT=32-\/bit\_rle\_rgbe\(\backslash\)n"{}};}
\DoxyCodeLine{757       s-\/>func(s-\/>context, header, \textcolor{keyword}{sizeof}(header)-\/1);}
\DoxyCodeLine{758 }
\DoxyCodeLine{759 \textcolor{preprocessor}{\#ifdef \_\_STDC\_WANT\_SECURE\_LIB\_\_}}
\DoxyCodeLine{760       len = sprintf\_s(buffer, \textcolor{keyword}{sizeof}(buffer), \textcolor{stringliteral}{"{}EXPOSURE=          1.0000000000000\(\backslash\)n\(\backslash\)n-\/Y \%d +X \%d\(\backslash\)n"{}}, y, x);}
\DoxyCodeLine{761 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{762       len = sprintf(buffer, \textcolor{stringliteral}{"{}EXPOSURE=          1.0000000000000\(\backslash\)n\(\backslash\)n-\/Y \%d +X \%d\(\backslash\)n"{}}, y, x);}
\DoxyCodeLine{763 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{764       s-\/>func(s-\/>context, buffer, len);}
\DoxyCodeLine{765 }
\DoxyCodeLine{766       \textcolor{keywordflow}{for}(i=0; i < y; i++)}
\DoxyCodeLine{767          stbiw\_\_write\_hdr\_scanline(s, x, comp, scratch, data + comp*x*(stbi\_\_flip\_vertically\_on\_write ? y-\/1-\/i : i));}
\DoxyCodeLine{768       STBIW\_FREE(scratch);}
\DoxyCodeLine{769       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{770    \}}
\DoxyCodeLine{771 \}}
\DoxyCodeLine{772 }
\DoxyCodeLine{773 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_hdr\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *data)}
\DoxyCodeLine{774 \{}
\DoxyCodeLine{775    stbi\_\_write\_context s = \{ 0 \};}
\DoxyCodeLine{776    stbi\_\_start\_write\_callbacks(\&s, func, context);}
\DoxyCodeLine{777    \textcolor{keywordflow}{return} stbi\_write\_hdr\_core(\&s, x, y, comp, (\textcolor{keywordtype}{float} *) data);}
\DoxyCodeLine{778 \}}
\DoxyCodeLine{779 }
\DoxyCodeLine{780 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{781 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_hdr(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *data)}
\DoxyCodeLine{782 \{}
\DoxyCodeLine{783    stbi\_\_write\_context s = \{ 0 \};}
\DoxyCodeLine{784    \textcolor{keywordflow}{if} (stbi\_\_start\_write\_file(\&s,filename)) \{}
\DoxyCodeLine{785       \textcolor{keywordtype}{int} r = stbi\_write\_hdr\_core(\&s, x, y, comp, (\textcolor{keywordtype}{float} *) data);}
\DoxyCodeLine{786       stbi\_\_end\_write\_file(\&s);}
\DoxyCodeLine{787       \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{788    \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{789       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{790 \}}
\DoxyCodeLine{791 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{792 }
\DoxyCodeLine{793 }
\DoxyCodeLine{795 \textcolor{comment}{//}}
\DoxyCodeLine{796 \textcolor{comment}{// PNG writer}}
\DoxyCodeLine{797 \textcolor{comment}{//}}
\DoxyCodeLine{798 }
\DoxyCodeLine{799 \textcolor{preprocessor}{\#ifndef STBIW\_ZLIB\_COMPRESS}}
\DoxyCodeLine{800 \textcolor{comment}{// stretchy buffer; stbiw\_\_sbpush() == vector<>::push\_back() -\/-\/ stbiw\_\_sbcount() == vector<>::size()}}
\DoxyCodeLine{801 \textcolor{preprocessor}{\#define stbiw\_\_sbraw(a) ((int *) (void *) (a) -\/ 2)}}
\DoxyCodeLine{802 \textcolor{preprocessor}{\#define stbiw\_\_sbm(a)   stbiw\_\_sbraw(a)[0]}}
\DoxyCodeLine{803 \textcolor{preprocessor}{\#define stbiw\_\_sbn(a)   stbiw\_\_sbraw(a)[1]}}
\DoxyCodeLine{804 }
\DoxyCodeLine{805 \textcolor{preprocessor}{\#define stbiw\_\_sbneedgrow(a,n)  ((a)==0 || stbiw\_\_sbn(a)+n >= stbiw\_\_sbm(a))}}
\DoxyCodeLine{806 \textcolor{preprocessor}{\#define stbiw\_\_sbmaybegrow(a,n) (stbiw\_\_sbneedgrow(a,(n)) ? stbiw\_\_sbgrow(a,n) : 0)}}
\DoxyCodeLine{807 \textcolor{preprocessor}{\#define stbiw\_\_sbgrow(a,n)  stbiw\_\_sbgrowf((void **) \&(a), (n), sizeof(*(a)))}}
\DoxyCodeLine{808 }
\DoxyCodeLine{809 \textcolor{preprocessor}{\#define stbiw\_\_sbpush(a, v)      (stbiw\_\_sbmaybegrow(a,1), (a)[stbiw\_\_sbn(a)++] = (v))}}
\DoxyCodeLine{810 \textcolor{preprocessor}{\#define stbiw\_\_sbcount(a)        ((a) ? stbiw\_\_sbn(a) : 0)}}
\DoxyCodeLine{811 \textcolor{preprocessor}{\#define stbiw\_\_sbfree(a)         ((a) ? STBIW\_FREE(stbiw\_\_sbraw(a)),0 : 0)}}
\DoxyCodeLine{812 }
\DoxyCodeLine{813 \textcolor{keyword}{static} \textcolor{keywordtype}{void} *stbiw\_\_sbgrowf(\textcolor{keywordtype}{void} **arr, \textcolor{keywordtype}{int} increment, \textcolor{keywordtype}{int} itemsize)}
\DoxyCodeLine{814 \{}
\DoxyCodeLine{815    \textcolor{keywordtype}{int} m = *arr ? 2*stbiw\_\_sbm(*arr)+increment : increment+1;}
\DoxyCodeLine{816    \textcolor{keywordtype}{void} *p = STBIW\_REALLOC\_SIZED(*arr ? stbiw\_\_sbraw(*arr) : 0, *arr ? (stbiw\_\_sbm(*arr)*itemsize + \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int})*2) : 0, itemsize * m + \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int})*2);}
\DoxyCodeLine{817    STBIW\_ASSERT(p);}
\DoxyCodeLine{818    \textcolor{keywordflow}{if} (p) \{}
\DoxyCodeLine{819       \textcolor{keywordflow}{if} (!*arr) ((\textcolor{keywordtype}{int} *) p)[1] = 0;}
\DoxyCodeLine{820       *arr = (\textcolor{keywordtype}{void} *) ((\textcolor{keywordtype}{int} *) p + 2);}
\DoxyCodeLine{821       stbiw\_\_sbm(*arr) = m;}
\DoxyCodeLine{822    \}}
\DoxyCodeLine{823    \textcolor{keywordflow}{return} *arr;}
\DoxyCodeLine{824 \}}
\DoxyCodeLine{825 }
\DoxyCodeLine{826 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *stbiw\_\_zlib\_flushf(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *data, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *bitbuffer, \textcolor{keywordtype}{int} *bitcount)}
\DoxyCodeLine{827 \{}
\DoxyCodeLine{828    \textcolor{keywordflow}{while} (*bitcount >= 8) \{}
\DoxyCodeLine{829       stbiw\_\_sbpush(data, STBIW\_UCHAR(*bitbuffer));}
\DoxyCodeLine{830       *bitbuffer >>= 8;}
\DoxyCodeLine{831       *bitcount -\/= 8;}
\DoxyCodeLine{832    \}}
\DoxyCodeLine{833    \textcolor{keywordflow}{return} data;}
\DoxyCodeLine{834 \}}
\DoxyCodeLine{835 }
\DoxyCodeLine{836 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbiw\_\_zlib\_bitrev(\textcolor{keywordtype}{int} code, \textcolor{keywordtype}{int} codebits)}
\DoxyCodeLine{837 \{}
\DoxyCodeLine{838    \textcolor{keywordtype}{int} res=0;}
\DoxyCodeLine{839    \textcolor{keywordflow}{while} (codebits-\/-\/) \{}
\DoxyCodeLine{840       res = (res << 1) | (code \& 1);}
\DoxyCodeLine{841       code >>= 1;}
\DoxyCodeLine{842    \}}
\DoxyCodeLine{843    \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{844 \}}
\DoxyCodeLine{845 }
\DoxyCodeLine{846 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stbiw\_\_zlib\_countm(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *a, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *b, \textcolor{keywordtype}{int} limit)}
\DoxyCodeLine{847 \{}
\DoxyCodeLine{848    \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{849    \textcolor{keywordflow}{for} (i=0; i < limit \&\& i < 258; ++i)}
\DoxyCodeLine{850       \textcolor{keywordflow}{if} (a[i] != b[i]) \textcolor{keywordflow}{break};}
\DoxyCodeLine{851    \textcolor{keywordflow}{return} i;}
\DoxyCodeLine{852 \}}
\DoxyCodeLine{853 }
\DoxyCodeLine{854 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stbiw\_\_zhash(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *data)}
\DoxyCodeLine{855 \{}
\DoxyCodeLine{856    stbiw\_uint32 hash = data[0] + (data[1] << 8) + (data[2] << 16);}
\DoxyCodeLine{857    hash \string^= hash << 3;}
\DoxyCodeLine{858    hash += hash >> 5;}
\DoxyCodeLine{859    hash \string^= hash << 4;}
\DoxyCodeLine{860    hash += hash >> 17;}
\DoxyCodeLine{861    hash \string^= hash << 25;}
\DoxyCodeLine{862    hash += hash >> 6;}
\DoxyCodeLine{863    \textcolor{keywordflow}{return} hash;}
\DoxyCodeLine{864 \}}
\DoxyCodeLine{865 }
\DoxyCodeLine{866 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_flush() (out = stbiw\_\_zlib\_flushf(out, \&bitbuf, \&bitcount))}}
\DoxyCodeLine{867 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_add(code,codebits) \(\backslash\)}}
\DoxyCodeLine{868 \textcolor{preprocessor}{      (bitbuf |= (code) << bitcount, bitcount += (codebits), stbiw\_\_zlib\_flush())}}
\DoxyCodeLine{869 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huffa(b,c)  stbiw\_\_zlib\_add(stbiw\_\_zlib\_bitrev(b,c),c)}}
\DoxyCodeLine{870 \textcolor{comment}{// default huffman tables}}
\DoxyCodeLine{871 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff1(n)  stbiw\_\_zlib\_huffa(0x30 + (n), 8)}}
\DoxyCodeLine{872 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff2(n)  stbiw\_\_zlib\_huffa(0x190 + (n)-\/144, 9)}}
\DoxyCodeLine{873 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff3(n)  stbiw\_\_zlib\_huffa(0 + (n)-\/256,7)}}
\DoxyCodeLine{874 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff4(n)  stbiw\_\_zlib\_huffa(0xc0 + (n)-\/280,8)}}
\DoxyCodeLine{875 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff(n)  ((n) <= 143 ? stbiw\_\_zlib\_huff1(n) : (n) <= 255 ? stbiw\_\_zlib\_huff2(n) : (n) <= 279 ? stbiw\_\_zlib\_huff3(n) : stbiw\_\_zlib\_huff4(n))}}
\DoxyCodeLine{876 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huffb(n) ((n) <= 143 ? stbiw\_\_zlib\_huff1(n) : stbiw\_\_zlib\_huff2(n))}}
\DoxyCodeLine{877 }
\DoxyCodeLine{878 \textcolor{preprocessor}{\#define stbiw\_\_ZHASH   16384}}
\DoxyCodeLine{879 }
\DoxyCodeLine{880 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBIW\_ZLIB\_COMPRESS}}
\DoxyCodeLine{881 }
\DoxyCodeLine{882 STBIWDEF \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} * stbi\_zlib\_compress(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *data, \textcolor{keywordtype}{int} data\_len, \textcolor{keywordtype}{int} *out\_len, \textcolor{keywordtype}{int} quality)}
\DoxyCodeLine{883 \{}
\DoxyCodeLine{884 \textcolor{preprocessor}{\#ifdef STBIW\_ZLIB\_COMPRESS}}
\DoxyCodeLine{885    \textcolor{comment}{// user provided a zlib compress implementation, use that}}
\DoxyCodeLine{886    \textcolor{keywordflow}{return} STBIW\_ZLIB\_COMPRESS(data, data\_len, out\_len, quality);}
\DoxyCodeLine{887 \textcolor{preprocessor}{\#else }\textcolor{comment}{// use builtin}}
\DoxyCodeLine{888    \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} lengthc[] = \{ 3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258, 259 \};}
\DoxyCodeLine{889    \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}  lengtheb[]= \{ 0,0,0,0,0,0,0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4,  4,  5,  5,  5,  5,  0 \};}
\DoxyCodeLine{890    \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} distc[]   = \{ 1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577, 32768 \};}
\DoxyCodeLine{891    \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}  disteb[]  = \{ 0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13 \};}
\DoxyCodeLine{892    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitbuf=0;}
\DoxyCodeLine{893    \textcolor{keywordtype}{int} i,j, bitcount=0;}
\DoxyCodeLine{894    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *out = NULL;}
\DoxyCodeLine{895    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} ***hash\_table = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}***) STBIW\_MALLOC(stbiw\_\_ZHASH * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}**));}
\DoxyCodeLine{896    \textcolor{keywordflow}{if} (hash\_table == NULL)}
\DoxyCodeLine{897       \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{898    \textcolor{keywordflow}{if} (quality < 5) quality = 5;}
\DoxyCodeLine{899 }
\DoxyCodeLine{900    stbiw\_\_sbpush(out, 0x78);   \textcolor{comment}{// DEFLATE 32K window}}
\DoxyCodeLine{901    stbiw\_\_sbpush(out, 0x5e);   \textcolor{comment}{// FLEVEL = 1}}
\DoxyCodeLine{902    stbiw\_\_zlib\_add(1,1);  \textcolor{comment}{// BFINAL = 1}}
\DoxyCodeLine{903    stbiw\_\_zlib\_add(1,2);  \textcolor{comment}{// BTYPE = 1 -\/-\/ fixed huffman}}
\DoxyCodeLine{904 }
\DoxyCodeLine{905    \textcolor{keywordflow}{for} (i=0; i < stbiw\_\_ZHASH; ++i)}
\DoxyCodeLine{906       hash\_table[i] = NULL;}
\DoxyCodeLine{907 }
\DoxyCodeLine{908    i=0;}
\DoxyCodeLine{909    \textcolor{keywordflow}{while} (i < data\_len-\/3) \{}
\DoxyCodeLine{910       \textcolor{comment}{// hash next 3 bytes of data to be compressed}}
\DoxyCodeLine{911       \textcolor{keywordtype}{int} h = stbiw\_\_zhash(data+i)\&(stbiw\_\_ZHASH-\/1), best=3;}
\DoxyCodeLine{912       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *bestloc = 0;}
\DoxyCodeLine{913       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} **hlist = hash\_table[h];}
\DoxyCodeLine{914       \textcolor{keywordtype}{int} n = stbiw\_\_sbcount(hlist);}
\DoxyCodeLine{915       \textcolor{keywordflow}{for} (j=0; j < n; ++j) \{}
\DoxyCodeLine{916          \textcolor{keywordflow}{if} (hlist[j]-\/data > i-\/32768) \{ \textcolor{comment}{// if entry lies within window}}
\DoxyCodeLine{917             \textcolor{keywordtype}{int} d = stbiw\_\_zlib\_countm(hlist[j], data+i, data\_len-\/i);}
\DoxyCodeLine{918             \textcolor{keywordflow}{if} (d >= best) \{ best=d; bestloc=hlist[j]; \}}
\DoxyCodeLine{919          \}}
\DoxyCodeLine{920       \}}
\DoxyCodeLine{921       \textcolor{comment}{// when hash table entry is too long, delete half the entries}}
\DoxyCodeLine{922       \textcolor{keywordflow}{if} (hash\_table[h] \&\& stbiw\_\_sbn(hash\_table[h]) == 2*quality) \{}
\DoxyCodeLine{923          STBIW\_MEMMOVE(hash\_table[h], hash\_table[h]+quality, \textcolor{keyword}{sizeof}(hash\_table[h][0])*quality);}
\DoxyCodeLine{924          stbiw\_\_sbn(hash\_table[h]) = quality;}
\DoxyCodeLine{925       \}}
\DoxyCodeLine{926       stbiw\_\_sbpush(hash\_table[h],data+i);}
\DoxyCodeLine{927 }
\DoxyCodeLine{928       \textcolor{keywordflow}{if} (bestloc) \{}
\DoxyCodeLine{929          \textcolor{comment}{// "{}lazy matching"{} -\/ check match at *next* byte, and if it's better, do cur byte as literal}}
\DoxyCodeLine{930          h = stbiw\_\_zhash(data+i+1)\&(stbiw\_\_ZHASH-\/1);}
\DoxyCodeLine{931          hlist = hash\_table[h];}
\DoxyCodeLine{932          n = stbiw\_\_sbcount(hlist);}
\DoxyCodeLine{933          \textcolor{keywordflow}{for} (j=0; j < n; ++j) \{}
\DoxyCodeLine{934             \textcolor{keywordflow}{if} (hlist[j]-\/data > i-\/32767) \{}
\DoxyCodeLine{935                \textcolor{keywordtype}{int} e = stbiw\_\_zlib\_countm(hlist[j], data+i+1, data\_len-\/i-\/1);}
\DoxyCodeLine{936                \textcolor{keywordflow}{if} (e > best) \{ \textcolor{comment}{// if next match is better, bail on current match}}
\DoxyCodeLine{937                   bestloc = NULL;}
\DoxyCodeLine{938                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{939                \}}
\DoxyCodeLine{940             \}}
\DoxyCodeLine{941          \}}
\DoxyCodeLine{942       \}}
\DoxyCodeLine{943 }
\DoxyCodeLine{944       \textcolor{keywordflow}{if} (bestloc) \{}
\DoxyCodeLine{945          \textcolor{keywordtype}{int} d = (int) (data+i -\/ bestloc); \textcolor{comment}{// distance back}}
\DoxyCodeLine{946          STBIW\_ASSERT(d <= 32767 \&\& best <= 258);}
\DoxyCodeLine{947          \textcolor{keywordflow}{for} (j=0; best > lengthc[j+1]-\/1; ++j);}
\DoxyCodeLine{948          stbiw\_\_zlib\_huff(j+257);}
\DoxyCodeLine{949          \textcolor{keywordflow}{if} (lengtheb[j]) stbiw\_\_zlib\_add(best -\/ lengthc[j], lengtheb[j]);}
\DoxyCodeLine{950          \textcolor{keywordflow}{for} (j=0; d > distc[j+1]-\/1; ++j);}
\DoxyCodeLine{951          stbiw\_\_zlib\_add(stbiw\_\_zlib\_bitrev(j,5),5);}
\DoxyCodeLine{952          \textcolor{keywordflow}{if} (disteb[j]) stbiw\_\_zlib\_add(d -\/ distc[j], disteb[j]);}
\DoxyCodeLine{953          i += best;}
\DoxyCodeLine{954       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{955          stbiw\_\_zlib\_huffb(data[i]);}
\DoxyCodeLine{956          ++i;}
\DoxyCodeLine{957       \}}
\DoxyCodeLine{958    \}}
\DoxyCodeLine{959    \textcolor{comment}{// write out final bytes}}
\DoxyCodeLine{960    \textcolor{keywordflow}{for} (;i < data\_len; ++i)}
\DoxyCodeLine{961       stbiw\_\_zlib\_huffb(data[i]);}
\DoxyCodeLine{962    stbiw\_\_zlib\_huff(256); \textcolor{comment}{// end of block}}
\DoxyCodeLine{963    \textcolor{comment}{// pad with 0 bits to byte boundary}}
\DoxyCodeLine{964    \textcolor{keywordflow}{while} (bitcount)}
\DoxyCodeLine{965       stbiw\_\_zlib\_add(0,1);}
\DoxyCodeLine{966 }
\DoxyCodeLine{967    \textcolor{keywordflow}{for} (i=0; i < stbiw\_\_ZHASH; ++i)}
\DoxyCodeLine{968       (\textcolor{keywordtype}{void}) stbiw\_\_sbfree(hash\_table[i]);}
\DoxyCodeLine{969    STBIW\_FREE(hash\_table);}
\DoxyCodeLine{970 }
\DoxyCodeLine{971    \{}
\DoxyCodeLine{972       \textcolor{comment}{// compute adler32 on input}}
\DoxyCodeLine{973       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} s1=1, s2=0;}
\DoxyCodeLine{974       \textcolor{keywordtype}{int} blocklen = (int) (data\_len \% 5552);}
\DoxyCodeLine{975       j=0;}
\DoxyCodeLine{976       \textcolor{keywordflow}{while} (j < data\_len) \{}
\DoxyCodeLine{977          \textcolor{keywordflow}{for} (i=0; i < blocklen; ++i) \{ s1 += data[j+i]; s2 += s1; \}}
\DoxyCodeLine{978          s1 \%= 65521; s2 \%= 65521;}
\DoxyCodeLine{979          j += blocklen;}
\DoxyCodeLine{980          blocklen = 5552;}
\DoxyCodeLine{981       \}}
\DoxyCodeLine{982       stbiw\_\_sbpush(out, STBIW\_UCHAR(s2 >> 8));}
\DoxyCodeLine{983       stbiw\_\_sbpush(out, STBIW\_UCHAR(s2));}
\DoxyCodeLine{984       stbiw\_\_sbpush(out, STBIW\_UCHAR(s1 >> 8));}
\DoxyCodeLine{985       stbiw\_\_sbpush(out, STBIW\_UCHAR(s1));}
\DoxyCodeLine{986    \}}
\DoxyCodeLine{987    *out\_len = stbiw\_\_sbn(out);}
\DoxyCodeLine{988    \textcolor{comment}{// make returned pointer freeable}}
\DoxyCodeLine{989    STBIW\_MEMMOVE(stbiw\_\_sbraw(out), out, *out\_len);}
\DoxyCodeLine{990    \textcolor{keywordflow}{return} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) stbiw\_\_sbraw(out);}
\DoxyCodeLine{991 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBIW\_ZLIB\_COMPRESS}}
\DoxyCodeLine{992 \}}
\DoxyCodeLine{993 }
\DoxyCodeLine{994 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stbiw\_\_crc32(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *buffer, \textcolor{keywordtype}{int} len)}
\DoxyCodeLine{995 \{}
\DoxyCodeLine{996 \textcolor{preprocessor}{\#ifdef STBIW\_CRC32}}
\DoxyCodeLine{997     \textcolor{keywordflow}{return} STBIW\_CRC32(buffer, len);}
\DoxyCodeLine{998 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{999    \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} crc\_table[256] =}
\DoxyCodeLine{1000    \{}
\DoxyCodeLine{1001       0x00000000, 0x77073096, 0xEE0E612C, 0x990951BA, 0x076DC419, 0x706AF48F, 0xE963A535, 0x9E6495A3,}
\DoxyCodeLine{1002       0x0eDB8832, 0x79DCB8A4, 0xE0D5E91E, 0x97D2D988, 0x09B64C2B, 0x7EB17CBD, 0xE7B82D07, 0x90BF1D91,}
\DoxyCodeLine{1003       0x1DB71064, 0x6AB020F2, 0xF3B97148, 0x84BE41DE, 0x1ADAD47D, 0x6DDDE4EB, 0xF4D4B551, 0x83D385C7,}
\DoxyCodeLine{1004       0x136C9856, 0x646BA8C0, 0xFD62F97A, 0x8A65C9EC, 0x14015C4F, 0x63066CD9, 0xFA0F3D63, 0x8D080DF5,}
\DoxyCodeLine{1005       0x3B6E20C8, 0x4C69105E, 0xD56041E4, 0xA2677172, 0x3C03E4D1, 0x4B04D447, 0xD20D85FD, 0xA50AB56B,}
\DoxyCodeLine{1006       0x35B5A8FA, 0x42B2986C, 0xDBBBC9D6, 0xACBCF940, 0x32D86CE3, 0x45DF5C75, 0xDCD60DCF, 0xABD13D59,}
\DoxyCodeLine{1007       0x26D930AC, 0x51DE003A, 0xC8D75180, 0xBFD06116, 0x21B4F4B5, 0x56B3C423, 0xCFBA9599, 0xB8BDA50F,}
\DoxyCodeLine{1008       0x2802B89E, 0x5F058808, 0xC60CD9B2, 0xB10BE924, 0x2F6F7C87, 0x58684C11, 0xC1611DAB, 0xB6662D3D,}
\DoxyCodeLine{1009       0x76DC4190, 0x01DB7106, 0x98D220BC, 0xEFD5102A, 0x71B18589, 0x06B6B51F, 0x9FBFE4A5, 0xE8B8D433,}
\DoxyCodeLine{1010       0x7807C9A2, 0x0F00F934, 0x9609A88E, 0xE10E9818, 0x7F6A0DBB, 0x086D3D2D, 0x91646C97, 0xE6635C01,}
\DoxyCodeLine{1011       0x6B6B51F4, 0x1C6C6162, 0x856530D8, 0xF262004E, 0x6C0695ED, 0x1B01A57B, 0x8208F4C1, 0xF50FC457,}
\DoxyCodeLine{1012       0x65B0D9C6, 0x12B7E950, 0x8BBEB8EA, 0xFCB9887C, 0x62DD1DDF, 0x15DA2D49, 0x8CD37CF3, 0xFBD44C65,}
\DoxyCodeLine{1013       0x4DB26158, 0x3AB551CE, 0xA3BC0074, 0xD4BB30E2, 0x4ADFA541, 0x3DD895D7, 0xA4D1C46D, 0xD3D6F4FB,}
\DoxyCodeLine{1014       0x4369E96A, 0x346ED9FC, 0xAD678846, 0xDA60B8D0, 0x44042D73, 0x33031DE5, 0xAA0A4C5F, 0xDD0D7CC9,}
\DoxyCodeLine{1015       0x5005713C, 0x270241AA, 0xBE0B1010, 0xC90C2086, 0x5768B525, 0x206F85B3, 0xB966D409, 0xCE61E49F,}
\DoxyCodeLine{1016       0x5EDEF90E, 0x29D9C998, 0xB0D09822, 0xC7D7A8B4, 0x59B33D17, 0x2EB40D81, 0xB7BD5C3B, 0xC0BA6CAD,}
\DoxyCodeLine{1017       0xEDB88320, 0x9ABFB3B6, 0x03B6E20C, 0x74B1D29A, 0xEAD54739, 0x9DD277AF, 0x04DB2615, 0x73DC1683,}
\DoxyCodeLine{1018       0xE3630B12, 0x94643B84, 0x0D6D6A3E, 0x7A6A5AA8, 0xE40ECF0B, 0x9309FF9D, 0x0A00AE27, 0x7D079EB1,}
\DoxyCodeLine{1019       0xF00F9344, 0x8708A3D2, 0x1E01F268, 0x6906C2FE, 0xF762575D, 0x806567CB, 0x196C3671, 0x6E6B06E7,}
\DoxyCodeLine{1020       0xFED41B76, 0x89D32BE0, 0x10DA7A5A, 0x67DD4ACC, 0xF9B9DF6F, 0x8EBEEFF9, 0x17B7BE43, 0x60B08ED5,}
\DoxyCodeLine{1021       0xD6D6A3E8, 0xA1D1937E, 0x38D8C2C4, 0x4FDFF252, 0xD1BB67F1, 0xA6BC5767, 0x3FB506DD, 0x48B2364B,}
\DoxyCodeLine{1022       0xD80D2BDA, 0xAF0A1B4C, 0x36034AF6, 0x41047A60, 0xDF60EFC3, 0xA867DF55, 0x316E8EEF, 0x4669BE79,}
\DoxyCodeLine{1023       0xCB61B38C, 0xBC66831A, 0x256FD2A0, 0x5268E236, 0xCC0C7795, 0xBB0B4703, 0x220216B9, 0x5505262F,}
\DoxyCodeLine{1024       0xC5BA3BBE, 0xB2BD0B28, 0x2BB45A92, 0x5CB36A04, 0xC2D7FFA7, 0xB5D0CF31, 0x2CD99E8B, 0x5BDEAE1D,}
\DoxyCodeLine{1025       0x9B64C2B0, 0xEC63F226, 0x756AA39C, 0x026D930A, 0x9C0906A9, 0xEB0E363F, 0x72076785, 0x05005713,}
\DoxyCodeLine{1026       0x95BF4A82, 0xE2B87A14, 0x7BB12BAE, 0x0CB61B38, 0x92D28E9B, 0xE5D5BE0D, 0x7CDCEFB7, 0x0BDBDF21,}
\DoxyCodeLine{1027       0x86D3D2D4, 0xF1D4E242, 0x68DDB3F8, 0x1FDA836E, 0x81BE16CD, 0xF6B9265B, 0x6FB077E1, 0x18B74777,}
\DoxyCodeLine{1028       0x88085AE6, 0xFF0F6A70, 0x66063BCA, 0x11010B5C, 0x8F659EFF, 0xF862AE69, 0x616BFFD3, 0x166CCF45,}
\DoxyCodeLine{1029       0xA00AE278, 0xD70DD2EE, 0x4E048354, 0x3903B3C2, 0xA7672661, 0xD06016F7, 0x4969474D, 0x3E6E77DB,}
\DoxyCodeLine{1030       0xAED16A4A, 0xD9D65ADC, 0x40DF0B66, 0x37D83BF0, 0xA9BCAE53, 0xDEBB9EC5, 0x47B2CF7F, 0x30B5FFE9,}
\DoxyCodeLine{1031       0xBDBDF21C, 0xCABAC28A, 0x53B39330, 0x24B4A3A6, 0xBAD03605, 0xCDD70693, 0x54DE5729, 0x23D967BF,}
\DoxyCodeLine{1032       0xB3667A2E, 0xC4614AB8, 0x5D681B02, 0x2A6F2B94, 0xB40BBE37, 0xC30C8EA1, 0x5A05DF1B, 0x2D02EF8D}
\DoxyCodeLine{1033    \};}
\DoxyCodeLine{1034 }
\DoxyCodeLine{1035    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} crc = \string~0u;}
\DoxyCodeLine{1036    \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1037    \textcolor{keywordflow}{for} (i=0; i < len; ++i)}
\DoxyCodeLine{1038       crc = (crc >> 8) \string^ crc\_table[buffer[i] \string^ (crc \& 0xff)];}
\DoxyCodeLine{1039    \textcolor{keywordflow}{return} \string~crc;}
\DoxyCodeLine{1040 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1041 \}}
\DoxyCodeLine{1042 }
\DoxyCodeLine{1043 \textcolor{preprocessor}{\#define stbiw\_\_wpng4(o,a,b,c,d) ((o)[0]=STBIW\_UCHAR(a),(o)[1]=STBIW\_UCHAR(b),(o)[2]=STBIW\_UCHAR(c),(o)[3]=STBIW\_UCHAR(d),(o)+=4)}}
\DoxyCodeLine{1044 \textcolor{preprocessor}{\#define stbiw\_\_wp32(data,v) stbiw\_\_wpng4(data, (v)>>24,(v)>>16,(v)>>8,(v));}}
\DoxyCodeLine{1045 \textcolor{preprocessor}{\#define stbiw\_\_wptag(data,s) stbiw\_\_wpng4(data, s[0],s[1],s[2],s[3])}}
\DoxyCodeLine{1046 }
\DoxyCodeLine{1047 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_wpcrc(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} **data, \textcolor{keywordtype}{int} len)}
\DoxyCodeLine{1048 \{}
\DoxyCodeLine{1049    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} crc = stbiw\_\_crc32(*data -\/ len -\/ 4, len+4);}
\DoxyCodeLine{1050    stbiw\_\_wp32(*data, crc);}
\DoxyCodeLine{1051 \}}
\DoxyCodeLine{1052 }
\DoxyCodeLine{1053 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} stbiw\_\_paeth(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} c)}
\DoxyCodeLine{1054 \{}
\DoxyCodeLine{1055    \textcolor{keywordtype}{int} p = a + b -\/ c, pa = abs(p-\/a), pb = abs(p-\/b), pc = abs(p-\/c);}
\DoxyCodeLine{1056    \textcolor{keywordflow}{if} (pa <= pb \&\& pa <= pc) \textcolor{keywordflow}{return} STBIW\_UCHAR(a);}
\DoxyCodeLine{1057    \textcolor{keywordflow}{if} (pb <= pc) \textcolor{keywordflow}{return} STBIW\_UCHAR(b);}
\DoxyCodeLine{1058    \textcolor{keywordflow}{return} STBIW\_UCHAR(c);}
\DoxyCodeLine{1059 \}}
\DoxyCodeLine{1060 }
\DoxyCodeLine{1061 \textcolor{comment}{// @OPTIMIZE: provide an option that always forces left-\/predict or paeth predict}}
\DoxyCodeLine{1062 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_encode\_png\_line(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *pixels, \textcolor{keywordtype}{int} stride\_bytes, \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} filter\_type, \textcolor{keywordtype}{signed} \textcolor{keywordtype}{char} *line\_buffer)}
\DoxyCodeLine{1063 \{}
\DoxyCodeLine{1064    \textcolor{keyword}{static} \textcolor{keywordtype}{int} mapping[] = \{ 0,1,2,3,4 \};}
\DoxyCodeLine{1065    \textcolor{keyword}{static} \textcolor{keywordtype}{int} firstmap[] = \{ 0,1,0,5,6 \};}
\DoxyCodeLine{1066    \textcolor{keywordtype}{int} *mymap = (y != 0) ? mapping : firstmap;}
\DoxyCodeLine{1067    \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1068    \textcolor{keywordtype}{int} type = mymap[filter\_type];}
\DoxyCodeLine{1069    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *z = pixels + stride\_bytes * (stbi\_\_flip\_vertically\_on\_write ? height-\/1-\/y : y);}
\DoxyCodeLine{1070    \textcolor{keywordtype}{int} signed\_stride = stbi\_\_flip\_vertically\_on\_write ? -\/stride\_bytes : stride\_bytes;}
\DoxyCodeLine{1071 }
\DoxyCodeLine{1072    \textcolor{keywordflow}{if} (type==0) \{}
\DoxyCodeLine{1073       memcpy(line\_buffer, z, width*n);}
\DoxyCodeLine{1074       \textcolor{keywordflow}{return};}
\DoxyCodeLine{1075    \}}
\DoxyCodeLine{1076 }
\DoxyCodeLine{1077    \textcolor{comment}{// first loop isn't optimized since it's just one pixel}}
\DoxyCodeLine{1078    \textcolor{keywordflow}{for} (i = 0; i < n; ++i) \{}
\DoxyCodeLine{1079       \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{1080          \textcolor{keywordflow}{case} 1: line\_buffer[i] = z[i]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{1081          \textcolor{keywordflow}{case} 2: line\_buffer[i] = z[i] -\/ z[i-\/signed\_stride]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{1082          \textcolor{keywordflow}{case} 3: line\_buffer[i] = z[i] -\/ (z[i-\/signed\_stride]>>1); \textcolor{keywordflow}{break};}
\DoxyCodeLine{1083          \textcolor{keywordflow}{case} 4: line\_buffer[i] = (\textcolor{keywordtype}{signed} char) (z[i] -\/ stbiw\_\_paeth(0,z[i-\/signed\_stride],0)); \textcolor{keywordflow}{break};}
\DoxyCodeLine{1084          \textcolor{keywordflow}{case} 5: line\_buffer[i] = z[i]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{1085          \textcolor{keywordflow}{case} 6: line\_buffer[i] = z[i]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{1086       \}}
\DoxyCodeLine{1087    \}}
\DoxyCodeLine{1088    \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{1089       \textcolor{keywordflow}{case} 1: \textcolor{keywordflow}{for} (i=n; i < width*n; ++i) line\_buffer[i] = z[i] -\/ z[i-\/n]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{1090       \textcolor{keywordflow}{case} 2: \textcolor{keywordflow}{for} (i=n; i < width*n; ++i) line\_buffer[i] = z[i] -\/ z[i-\/signed\_stride]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{1091       \textcolor{keywordflow}{case} 3: \textcolor{keywordflow}{for} (i=n; i < width*n; ++i) line\_buffer[i] = z[i] -\/ ((z[i-\/n] + z[i-\/signed\_stride])>>1); \textcolor{keywordflow}{break};}
\DoxyCodeLine{1092       \textcolor{keywordflow}{case} 4: \textcolor{keywordflow}{for} (i=n; i < width*n; ++i) line\_buffer[i] = z[i] -\/ stbiw\_\_paeth(z[i-\/n], z[i-\/signed\_stride], z[i-\/signed\_stride-\/n]); \textcolor{keywordflow}{break};}
\DoxyCodeLine{1093       \textcolor{keywordflow}{case} 5: \textcolor{keywordflow}{for} (i=n; i < width*n; ++i) line\_buffer[i] = z[i] -\/ (z[i-\/n]>>1); \textcolor{keywordflow}{break};}
\DoxyCodeLine{1094       \textcolor{keywordflow}{case} 6: \textcolor{keywordflow}{for} (i=n; i < width*n; ++i) line\_buffer[i] = z[i] -\/ stbiw\_\_paeth(z[i-\/n], 0,0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{1095    \}}
\DoxyCodeLine{1096 \}}
\DoxyCodeLine{1097 }
\DoxyCodeLine{1098 STBIWDEF \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *stbi\_write\_png\_to\_mem(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *pixels, \textcolor{keywordtype}{int} stride\_bytes, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} *out\_len)}
\DoxyCodeLine{1099 \{}
\DoxyCodeLine{1100    \textcolor{keywordtype}{int} force\_filter = stbi\_write\_force\_png\_filter;}
\DoxyCodeLine{1101    \textcolor{keywordtype}{int} ctype[5] = \{ -\/1, 0, 4, 2, 6 \};}
\DoxyCodeLine{1102    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} sig[8] = \{ 137,80,78,71,13,10,26,10 \};}
\DoxyCodeLine{1103    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *out,*o, *filt, *zlib;}
\DoxyCodeLine{1104    \textcolor{keywordtype}{signed} \textcolor{keywordtype}{char} *line\_buffer;}
\DoxyCodeLine{1105    \textcolor{keywordtype}{int} j,zlen;}
\DoxyCodeLine{1106 }
\DoxyCodeLine{1107    \textcolor{keywordflow}{if} (stride\_bytes == 0)}
\DoxyCodeLine{1108       stride\_bytes = x * n;}
\DoxyCodeLine{1109 }
\DoxyCodeLine{1110    \textcolor{keywordflow}{if} (force\_filter >= 5) \{}
\DoxyCodeLine{1111       force\_filter = -\/1;}
\DoxyCodeLine{1112    \}}
\DoxyCodeLine{1113 }
\DoxyCodeLine{1114    filt = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) STBIW\_MALLOC((x*n+1) * y); \textcolor{keywordflow}{if} (!filt) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1115    line\_buffer = (\textcolor{keywordtype}{signed} \textcolor{keywordtype}{char} *) STBIW\_MALLOC(x * n); \textcolor{keywordflow}{if} (!line\_buffer) \{ STBIW\_FREE(filt); \textcolor{keywordflow}{return} 0; \}}
\DoxyCodeLine{1116    \textcolor{keywordflow}{for} (j=0; j < y; ++j) \{}
\DoxyCodeLine{1117       \textcolor{keywordtype}{int} filter\_type;}
\DoxyCodeLine{1118       \textcolor{keywordflow}{if} (force\_filter > -\/1) \{}
\DoxyCodeLine{1119          filter\_type = force\_filter;}
\DoxyCodeLine{1120          stbiw\_\_encode\_png\_line((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)(pixels), stride\_bytes, x, y, j, n, force\_filter, line\_buffer);}
\DoxyCodeLine{1121       \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{// Estimate the best filter by running through all of them:}}
\DoxyCodeLine{1122          \textcolor{keywordtype}{int} best\_filter = 0, best\_filter\_val = 0x7fffffff, est, i;}
\DoxyCodeLine{1123          \textcolor{keywordflow}{for} (filter\_type = 0; filter\_type < 5; filter\_type++) \{}
\DoxyCodeLine{1124             stbiw\_\_encode\_png\_line((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)(pixels), stride\_bytes, x, y, j, n, filter\_type, line\_buffer);}
\DoxyCodeLine{1125 }
\DoxyCodeLine{1126             \textcolor{comment}{// Estimate the entropy of the line using this filter; the less, the better.}}
\DoxyCodeLine{1127             est = 0;}
\DoxyCodeLine{1128             \textcolor{keywordflow}{for} (i = 0; i < x*n; ++i) \{}
\DoxyCodeLine{1129                est += abs((\textcolor{keywordtype}{signed} \textcolor{keywordtype}{char}) line\_buffer[i]);}
\DoxyCodeLine{1130             \}}
\DoxyCodeLine{1131             \textcolor{keywordflow}{if} (est < best\_filter\_val) \{}
\DoxyCodeLine{1132                best\_filter\_val = est;}
\DoxyCodeLine{1133                best\_filter = filter\_type;}
\DoxyCodeLine{1134             \}}
\DoxyCodeLine{1135          \}}
\DoxyCodeLine{1136          \textcolor{keywordflow}{if} (filter\_type != best\_filter) \{  \textcolor{comment}{// If the last iteration already got us the best filter, don't redo it}}
\DoxyCodeLine{1137             stbiw\_\_encode\_png\_line((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)(pixels), stride\_bytes, x, y, j, n, best\_filter, line\_buffer);}
\DoxyCodeLine{1138             filter\_type = best\_filter;}
\DoxyCodeLine{1139          \}}
\DoxyCodeLine{1140       \}}
\DoxyCodeLine{1141       \textcolor{comment}{// when we get here, filter\_type contains the filter type, and line\_buffer contains the data}}
\DoxyCodeLine{1142       filt[j*(x*n+1)] = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}) filter\_type;}
\DoxyCodeLine{1143       STBIW\_MEMMOVE(filt+j*(x*n+1)+1, line\_buffer, x*n);}
\DoxyCodeLine{1144    \}}
\DoxyCodeLine{1145    STBIW\_FREE(line\_buffer);}
\DoxyCodeLine{1146    zlib = stbi\_zlib\_compress(filt, y*( x*n+1), \&zlen, stbi\_write\_png\_compression\_level);}
\DoxyCodeLine{1147    STBIW\_FREE(filt);}
\DoxyCodeLine{1148    \textcolor{keywordflow}{if} (!zlib) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1149 }
\DoxyCodeLine{1150    \textcolor{comment}{// each tag requires 12 bytes of overhead}}
\DoxyCodeLine{1151    out = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) STBIW\_MALLOC(8 + 12+13 + 12+zlen + 12);}
\DoxyCodeLine{1152    \textcolor{keywordflow}{if} (!out) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1153    *out\_len = 8 + 12+13 + 12+zlen + 12;}
\DoxyCodeLine{1154 }
\DoxyCodeLine{1155    o=out;}
\DoxyCodeLine{1156    STBIW\_MEMMOVE(o,sig,8); o+= 8;}
\DoxyCodeLine{1157    stbiw\_\_wp32(o, 13); \textcolor{comment}{// header length}}
\DoxyCodeLine{1158    stbiw\_\_wptag(o, \textcolor{stringliteral}{"{}IHDR"{}});}
\DoxyCodeLine{1159    stbiw\_\_wp32(o, x);}
\DoxyCodeLine{1160    stbiw\_\_wp32(o, y);}
\DoxyCodeLine{1161    *o++ = 8;}
\DoxyCodeLine{1162    *o++ = STBIW\_UCHAR(ctype[n]);}
\DoxyCodeLine{1163    *o++ = 0;}
\DoxyCodeLine{1164    *o++ = 0;}
\DoxyCodeLine{1165    *o++ = 0;}
\DoxyCodeLine{1166    stbiw\_\_wpcrc(\&o,13);}
\DoxyCodeLine{1167 }
\DoxyCodeLine{1168    stbiw\_\_wp32(o, zlen);}
\DoxyCodeLine{1169    stbiw\_\_wptag(o, \textcolor{stringliteral}{"{}IDAT"{}});}
\DoxyCodeLine{1170    STBIW\_MEMMOVE(o, zlib, zlen);}
\DoxyCodeLine{1171    o += zlen;}
\DoxyCodeLine{1172    STBIW\_FREE(zlib);}
\DoxyCodeLine{1173    stbiw\_\_wpcrc(\&o, zlen);}
\DoxyCodeLine{1174 }
\DoxyCodeLine{1175    stbiw\_\_wp32(o,0);}
\DoxyCodeLine{1176    stbiw\_\_wptag(o, \textcolor{stringliteral}{"{}IEND"{}});}
\DoxyCodeLine{1177    stbiw\_\_wpcrc(\&o,0);}
\DoxyCodeLine{1178 }
\DoxyCodeLine{1179    STBIW\_ASSERT(o == out + *out\_len);}
\DoxyCodeLine{1180 }
\DoxyCodeLine{1181    \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1182 \}}
\DoxyCodeLine{1183 }
\DoxyCodeLine{1184 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{1185 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_png(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} stride\_bytes)}
\DoxyCodeLine{1186 \{}
\DoxyCodeLine{1187    FILE *f;}
\DoxyCodeLine{1188    \textcolor{keywordtype}{int} len;}
\DoxyCodeLine{1189    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *png = stbi\_write\_png\_to\_mem((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) data, stride\_bytes, x, y, comp, \&len);}
\DoxyCodeLine{1190    \textcolor{keywordflow}{if} (png == NULL) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1191 }
\DoxyCodeLine{1192    f = stbiw\_\_fopen(filename, \textcolor{stringliteral}{"{}wb"{}});}
\DoxyCodeLine{1193    \textcolor{keywordflow}{if} (!f) \{ STBIW\_FREE(png); \textcolor{keywordflow}{return} 0; \}}
\DoxyCodeLine{1194    fwrite(png, 1, len, f);}
\DoxyCodeLine{1195    fclose(f);}
\DoxyCodeLine{1196    STBIW\_FREE(png);}
\DoxyCodeLine{1197    \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{1198 \}}
\DoxyCodeLine{1199 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1200 }
\DoxyCodeLine{1201 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_png\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} stride\_bytes)}
\DoxyCodeLine{1202 \{}
\DoxyCodeLine{1203    \textcolor{keywordtype}{int} len;}
\DoxyCodeLine{1204    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *png = stbi\_write\_png\_to\_mem((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) data, stride\_bytes, x, y, comp, \&len);}
\DoxyCodeLine{1205    \textcolor{keywordflow}{if} (png == NULL) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1206    func(context, png, len);}
\DoxyCodeLine{1207    STBIW\_FREE(png);}
\DoxyCodeLine{1208    \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{1209 \}}
\DoxyCodeLine{1210 }
\DoxyCodeLine{1211 }
\DoxyCodeLine{1212 \textcolor{comment}{/* ***************************************************************************}}
\DoxyCodeLine{1213 \textcolor{comment}{ *}}
\DoxyCodeLine{1214 \textcolor{comment}{ * JPEG writer}}
\DoxyCodeLine{1215 \textcolor{comment}{ *}}
\DoxyCodeLine{1216 \textcolor{comment}{ * This is based on Jon Olick's jo\_jpeg.cpp:}}
\DoxyCodeLine{1217 \textcolor{comment}{ * public domain Simple, Minimalistic JPEG writer -\/ http://www.jonolick.com/code.html}}
\DoxyCodeLine{1218 \textcolor{comment}{ */}}
\DoxyCodeLine{1219 }
\DoxyCodeLine{1220 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} stbiw\_\_jpg\_ZigZag[] = \{ 0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,}
\DoxyCodeLine{1221       24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63 \};}
\DoxyCodeLine{1222 }
\DoxyCodeLine{1223 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_jpg\_writeBits(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} *bitBufP, \textcolor{keywordtype}{int} *bitCntP, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} *bs) \{}
\DoxyCodeLine{1224    \textcolor{keywordtype}{int} bitBuf = *bitBufP, bitCnt = *bitCntP;}
\DoxyCodeLine{1225    bitCnt += bs[1];}
\DoxyCodeLine{1226    bitBuf |= bs[0] << (24 -\/ bitCnt);}
\DoxyCodeLine{1227    \textcolor{keywordflow}{while}(bitCnt >= 8) \{}
\DoxyCodeLine{1228       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} c = (bitBuf >> 16) \& 255;}
\DoxyCodeLine{1229       stbiw\_\_putc(s, c);}
\DoxyCodeLine{1230       \textcolor{keywordflow}{if}(c == 255) \{}
\DoxyCodeLine{1231          stbiw\_\_putc(s, 0);}
\DoxyCodeLine{1232       \}}
\DoxyCodeLine{1233       bitBuf <<= 8;}
\DoxyCodeLine{1234       bitCnt -\/= 8;}
\DoxyCodeLine{1235    \}}
\DoxyCodeLine{1236    *bitBufP = bitBuf;}
\DoxyCodeLine{1237    *bitCntP = bitCnt;}
\DoxyCodeLine{1238 \}}
\DoxyCodeLine{1239 }
\DoxyCodeLine{1240 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_jpg\_DCT(\textcolor{keywordtype}{float} *d0p, \textcolor{keywordtype}{float} *d1p, \textcolor{keywordtype}{float} *d2p, \textcolor{keywordtype}{float} *d3p, \textcolor{keywordtype}{float} *d4p, \textcolor{keywordtype}{float} *d5p, \textcolor{keywordtype}{float} *d6p, \textcolor{keywordtype}{float} *d7p) \{}
\DoxyCodeLine{1241    \textcolor{keywordtype}{float} d0 = *d0p, d1 = *d1p, d2 = *d2p, d3 = *d3p, d4 = *d4p, d5 = *d5p, d6 = *d6p, d7 = *d7p;}
\DoxyCodeLine{1242    \textcolor{keywordtype}{float} z1, z2, z3, z4, z5, z11, z13;}
\DoxyCodeLine{1243 }
\DoxyCodeLine{1244    \textcolor{keywordtype}{float} tmp0 = d0 + d7;}
\DoxyCodeLine{1245    \textcolor{keywordtype}{float} tmp7 = d0 -\/ d7;}
\DoxyCodeLine{1246    \textcolor{keywordtype}{float} tmp1 = d1 + d6;}
\DoxyCodeLine{1247    \textcolor{keywordtype}{float} tmp6 = d1 -\/ d6;}
\DoxyCodeLine{1248    \textcolor{keywordtype}{float} tmp2 = d2 + d5;}
\DoxyCodeLine{1249    \textcolor{keywordtype}{float} tmp5 = d2 -\/ d5;}
\DoxyCodeLine{1250    \textcolor{keywordtype}{float} tmp3 = d3 + d4;}
\DoxyCodeLine{1251    \textcolor{keywordtype}{float} tmp4 = d3 -\/ d4;}
\DoxyCodeLine{1252 }
\DoxyCodeLine{1253    \textcolor{comment}{// Even part}}
\DoxyCodeLine{1254    \textcolor{keywordtype}{float} tmp10 = tmp0 + tmp3;   \textcolor{comment}{// phase 2}}
\DoxyCodeLine{1255    \textcolor{keywordtype}{float} tmp13 = tmp0 -\/ tmp3;}
\DoxyCodeLine{1256    \textcolor{keywordtype}{float} tmp11 = tmp1 + tmp2;}
\DoxyCodeLine{1257    \textcolor{keywordtype}{float} tmp12 = tmp1 -\/ tmp2;}
\DoxyCodeLine{1258 }
\DoxyCodeLine{1259    d0 = tmp10 + tmp11;       \textcolor{comment}{// phase 3}}
\DoxyCodeLine{1260    d4 = tmp10 -\/ tmp11;}
\DoxyCodeLine{1261 }
\DoxyCodeLine{1262    z1 = (tmp12 + tmp13) * 0.707106781f; \textcolor{comment}{// c4}}
\DoxyCodeLine{1263    d2 = tmp13 + z1;       \textcolor{comment}{// phase 5}}
\DoxyCodeLine{1264    d6 = tmp13 -\/ z1;}
\DoxyCodeLine{1265 }
\DoxyCodeLine{1266    \textcolor{comment}{// Odd part}}
\DoxyCodeLine{1267    tmp10 = tmp4 + tmp5;       \textcolor{comment}{// phase 2}}
\DoxyCodeLine{1268    tmp11 = tmp5 + tmp6;}
\DoxyCodeLine{1269    tmp12 = tmp6 + tmp7;}
\DoxyCodeLine{1270 }
\DoxyCodeLine{1271    \textcolor{comment}{// The rotator is modified from fig 4-\/8 to avoid extra negations.}}
\DoxyCodeLine{1272    z5 = (tmp10 -\/ tmp12) * 0.382683433f; \textcolor{comment}{// c6}}
\DoxyCodeLine{1273    z2 = tmp10 * 0.541196100f + z5; \textcolor{comment}{// c2-\/c6}}
\DoxyCodeLine{1274    z4 = tmp12 * 1.306562965f + z5; \textcolor{comment}{// c2+c6}}
\DoxyCodeLine{1275    z3 = tmp11 * 0.707106781f; \textcolor{comment}{// c4}}
\DoxyCodeLine{1276 }
\DoxyCodeLine{1277    z11 = tmp7 + z3;      \textcolor{comment}{// phase 5}}
\DoxyCodeLine{1278    z13 = tmp7 -\/ z3;}
\DoxyCodeLine{1279 }
\DoxyCodeLine{1280    *d5p = z13 + z2;         \textcolor{comment}{// phase 6}}
\DoxyCodeLine{1281    *d3p = z13 -\/ z2;}
\DoxyCodeLine{1282    *d1p = z11 + z4;}
\DoxyCodeLine{1283    *d7p = z11 -\/ z4;}
\DoxyCodeLine{1284 }
\DoxyCodeLine{1285    *d0p = d0;  *d2p = d2;  *d4p = d4;  *d6p = d6;}
\DoxyCodeLine{1286 \}}
\DoxyCodeLine{1287 }
\DoxyCodeLine{1288 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_jpg\_calcBits(\textcolor{keywordtype}{int} val, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} bits[2]) \{}
\DoxyCodeLine{1289    \textcolor{keywordtype}{int} tmp1 = val < 0 ? -\/val : val;}
\DoxyCodeLine{1290    val = val < 0 ? val-\/1 : val;}
\DoxyCodeLine{1291    bits[1] = 1;}
\DoxyCodeLine{1292    \textcolor{keywordflow}{while}(tmp1 >>= 1) \{}
\DoxyCodeLine{1293       ++bits[1];}
\DoxyCodeLine{1294    \}}
\DoxyCodeLine{1295    bits[0] = val \& ((1<<bits[1])-\/1);}
\DoxyCodeLine{1296 \}}
\DoxyCodeLine{1297 }
\DoxyCodeLine{1298 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbiw\_\_jpg\_processDU(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} *bitBuf, \textcolor{keywordtype}{int} *bitCnt, \textcolor{keywordtype}{float} *CDU, \textcolor{keywordtype}{int} du\_stride, \textcolor{keywordtype}{float} *fdtbl, \textcolor{keywordtype}{int} DC, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} HTDC[256][2], \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} HTAC[256][2]) \{}
\DoxyCodeLine{1299    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} EOB[2] = \{ HTAC[0x00][0], HTAC[0x00][1] \};}
\DoxyCodeLine{1300    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} M16zeroes[2] = \{ HTAC[0xF0][0], HTAC[0xF0][1] \};}
\DoxyCodeLine{1301    \textcolor{keywordtype}{int} dataOff, i, j, n, diff, end0pos, x, y;}
\DoxyCodeLine{1302    \textcolor{keywordtype}{int} DU[64];}
\DoxyCodeLine{1303 }
\DoxyCodeLine{1304    \textcolor{comment}{// DCT rows}}
\DoxyCodeLine{1305    \textcolor{keywordflow}{for}(dataOff=0, n=du\_stride*8; dataOff<n; dataOff+=du\_stride) \{}
\DoxyCodeLine{1306       stbiw\_\_jpg\_DCT(\&CDU[dataOff], \&CDU[dataOff+1], \&CDU[dataOff+2], \&CDU[dataOff+3], \&CDU[dataOff+4], \&CDU[dataOff+5], \&CDU[dataOff+6], \&CDU[dataOff+7]);}
\DoxyCodeLine{1307    \}}
\DoxyCodeLine{1308    \textcolor{comment}{// DCT columns}}
\DoxyCodeLine{1309    \textcolor{keywordflow}{for}(dataOff=0; dataOff<8; ++dataOff) \{}
\DoxyCodeLine{1310       stbiw\_\_jpg\_DCT(\&CDU[dataOff], \&CDU[dataOff+du\_stride], \&CDU[dataOff+du\_stride*2], \&CDU[dataOff+du\_stride*3], \&CDU[dataOff+du\_stride*4],}
\DoxyCodeLine{1311                      \&CDU[dataOff+du\_stride*5], \&CDU[dataOff+du\_stride*6], \&CDU[dataOff+du\_stride*7]);}
\DoxyCodeLine{1312    \}}
\DoxyCodeLine{1313    \textcolor{comment}{// Quantize/descale/zigzag the coefficients}}
\DoxyCodeLine{1314    \textcolor{keywordflow}{for}(y = 0, j=0; y < 8; ++y) \{}
\DoxyCodeLine{1315       \textcolor{keywordflow}{for}(x = 0; x < 8; ++x,++j) \{}
\DoxyCodeLine{1316          \textcolor{keywordtype}{float} v;}
\DoxyCodeLine{1317          i = y*du\_stride+x;}
\DoxyCodeLine{1318          v = CDU[i]*fdtbl[j];}
\DoxyCodeLine{1319          \textcolor{comment}{// DU[stbiw\_\_jpg\_ZigZag[j]] = (int)(v < 0 ? ceilf(v -\/ 0.5f) : floorf(v + 0.5f));}}
\DoxyCodeLine{1320          \textcolor{comment}{// ceilf() and floorf() are C99, not C89, but I /think/ they're not needed here anyway?}}
\DoxyCodeLine{1321          DU[stbiw\_\_jpg\_ZigZag[j]] = (int)(v < 0 ? v -\/ 0.5f : v + 0.5f);}
\DoxyCodeLine{1322       \}}
\DoxyCodeLine{1323    \}}
\DoxyCodeLine{1324 }
\DoxyCodeLine{1325    \textcolor{comment}{// Encode DC}}
\DoxyCodeLine{1326    diff = DU[0] -\/ DC;}
\DoxyCodeLine{1327    \textcolor{keywordflow}{if} (diff == 0) \{}
\DoxyCodeLine{1328       stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, HTDC[0]);}
\DoxyCodeLine{1329    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1330       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} bits[2];}
\DoxyCodeLine{1331       stbiw\_\_jpg\_calcBits(diff, bits);}
\DoxyCodeLine{1332       stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, HTDC[bits[1]]);}
\DoxyCodeLine{1333       stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, bits);}
\DoxyCodeLine{1334    \}}
\DoxyCodeLine{1335    \textcolor{comment}{// Encode ACs}}
\DoxyCodeLine{1336    end0pos = 63;}
\DoxyCodeLine{1337    \textcolor{keywordflow}{for}(; (end0pos>0)\&\&(DU[end0pos]==0); -\/-\/end0pos) \{}
\DoxyCodeLine{1338    \}}
\DoxyCodeLine{1339    \textcolor{comment}{// end0pos = first element in reverse order !=0}}
\DoxyCodeLine{1340    \textcolor{keywordflow}{if}(end0pos == 0) \{}
\DoxyCodeLine{1341       stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, EOB);}
\DoxyCodeLine{1342       \textcolor{keywordflow}{return} DU[0];}
\DoxyCodeLine{1343    \}}
\DoxyCodeLine{1344    \textcolor{keywordflow}{for}(i = 1; i <= end0pos; ++i) \{}
\DoxyCodeLine{1345       \textcolor{keywordtype}{int} startpos = i;}
\DoxyCodeLine{1346       \textcolor{keywordtype}{int} nrzeroes;}
\DoxyCodeLine{1347       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} bits[2];}
\DoxyCodeLine{1348       \textcolor{keywordflow}{for} (; DU[i]==0 \&\& i<=end0pos; ++i) \{}
\DoxyCodeLine{1349       \}}
\DoxyCodeLine{1350       nrzeroes = i-\/startpos;}
\DoxyCodeLine{1351       \textcolor{keywordflow}{if} ( nrzeroes >= 16 ) \{}
\DoxyCodeLine{1352          \textcolor{keywordtype}{int} lng = nrzeroes>>4;}
\DoxyCodeLine{1353          \textcolor{keywordtype}{int} nrmarker;}
\DoxyCodeLine{1354          \textcolor{keywordflow}{for} (nrmarker=1; nrmarker <= lng; ++nrmarker)}
\DoxyCodeLine{1355             stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, M16zeroes);}
\DoxyCodeLine{1356          nrzeroes \&= 15;}
\DoxyCodeLine{1357       \}}
\DoxyCodeLine{1358       stbiw\_\_jpg\_calcBits(DU[i], bits);}
\DoxyCodeLine{1359       stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, HTAC[(nrzeroes<<4)+bits[1]]);}
\DoxyCodeLine{1360       stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, bits);}
\DoxyCodeLine{1361    \}}
\DoxyCodeLine{1362    \textcolor{keywordflow}{if}(end0pos != 63) \{}
\DoxyCodeLine{1363       stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, EOB);}
\DoxyCodeLine{1364    \}}
\DoxyCodeLine{1365    \textcolor{keywordflow}{return} DU[0];}
\DoxyCodeLine{1366 \}}
\DoxyCodeLine{1367 }
\DoxyCodeLine{1368 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_jpg\_core(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{int} quality) \{}
\DoxyCodeLine{1369    \textcolor{comment}{// Constants that don't pollute global namespace}}
\DoxyCodeLine{1370    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_dc\_luminance\_nrcodes[] = \{0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0\};}
\DoxyCodeLine{1371    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_dc\_luminance\_values[] = \{0,1,2,3,4,5,6,7,8,9,10,11\};}
\DoxyCodeLine{1372    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_ac\_luminance\_nrcodes[] = \{0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d\};}
\DoxyCodeLine{1373    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_ac\_luminance\_values[] = \{}
\DoxyCodeLine{1374       0x01,0x02,0x03,0x00,0x04,0x11,0x05,0x12,0x21,0x31,0x41,0x06,0x13,0x51,0x61,0x07,0x22,0x71,0x14,0x32,0x81,0x91,0xa1,0x08,}
\DoxyCodeLine{1375       0x23,0x42,0xb1,0xc1,0x15,0x52,0xd1,0xf0,0x24,0x33,0x62,0x72,0x82,0x09,0x0a,0x16,0x17,0x18,0x19,0x1a,0x25,0x26,0x27,0x28,}
\DoxyCodeLine{1376       0x29,0x2a,0x34,0x35,0x36,0x37,0x38,0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,0x59,}
\DoxyCodeLine{1377       0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x7a,0x83,0x84,0x85,0x86,0x87,0x88,0x89,}
\DoxyCodeLine{1378       0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,0xb5,0xb6,}
\DoxyCodeLine{1379       0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,0xe1,0xe2,}
\DoxyCodeLine{1380       0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,0xf9,0xfa}
\DoxyCodeLine{1381    \};}
\DoxyCodeLine{1382    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_dc\_chrominance\_nrcodes[] = \{0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0\};}
\DoxyCodeLine{1383    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_dc\_chrominance\_values[] = \{0,1,2,3,4,5,6,7,8,9,10,11\};}
\DoxyCodeLine{1384    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_ac\_chrominance\_nrcodes[] = \{0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77\};}
\DoxyCodeLine{1385    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_ac\_chrominance\_values[] = \{}
\DoxyCodeLine{1386       0x00,0x01,0x02,0x03,0x11,0x04,0x05,0x21,0x31,0x06,0x12,0x41,0x51,0x07,0x61,0x71,0x13,0x22,0x32,0x81,0x08,0x14,0x42,0x91,}
\DoxyCodeLine{1387       0xa1,0xb1,0xc1,0x09,0x23,0x33,0x52,0xf0,0x15,0x62,0x72,0xd1,0x0a,0x16,0x24,0x34,0xe1,0x25,0xf1,0x17,0x18,0x19,0x1a,0x26,}
\DoxyCodeLine{1388       0x27,0x28,0x29,0x2a,0x35,0x36,0x37,0x38,0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,}
\DoxyCodeLine{1389       0x59,0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x7a,0x82,0x83,0x84,0x85,0x86,0x87,}
\DoxyCodeLine{1390       0x88,0x89,0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,}
\DoxyCodeLine{1391       0xb5,0xb6,0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,}
\DoxyCodeLine{1392       0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,0xf9,0xfa}
\DoxyCodeLine{1393    \};}
\DoxyCodeLine{1394    \textcolor{comment}{// Huffman tables}}
\DoxyCodeLine{1395    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} YDC\_HT[256][2] = \{ \{0,2\},\{2,3\},\{3,3\},\{4,3\},\{5,3\},\{6,3\},\{14,4\},\{30,5\},\{62,6\},\{126,7\},\{254,8\},\{510,9\}\};}
\DoxyCodeLine{1396    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} UVDC\_HT[256][2] = \{ \{0,2\},\{1,2\},\{2,2\},\{6,3\},\{14,4\},\{30,5\},\{62,6\},\{126,7\},\{254,8\},\{510,9\},\{1022,10\},\{2046,11\}\};}
\DoxyCodeLine{1397    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} YAC\_HT[256][2] = \{}
\DoxyCodeLine{1398       \{10,4\},\{0,2\},\{1,2\},\{4,3\},\{11,4\},\{26,5\},\{120,7\},\{248,8\},\{1014,10\},\{65410,16\},\{65411,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1399       \{12,4\},\{27,5\},\{121,7\},\{502,9\},\{2038,11\},\{65412,16\},\{65413,16\},\{65414,16\},\{65415,16\},\{65416,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1400       \{28,5\},\{249,8\},\{1015,10\},\{4084,12\},\{65417,16\},\{65418,16\},\{65419,16\},\{65420,16\},\{65421,16\},\{65422,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1401       \{58,6\},\{503,9\},\{4085,12\},\{65423,16\},\{65424,16\},\{65425,16\},\{65426,16\},\{65427,16\},\{65428,16\},\{65429,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1402       \{59,6\},\{1016,10\},\{65430,16\},\{65431,16\},\{65432,16\},\{65433,16\},\{65434,16\},\{65435,16\},\{65436,16\},\{65437,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1403       \{122,7\},\{2039,11\},\{65438,16\},\{65439,16\},\{65440,16\},\{65441,16\},\{65442,16\},\{65443,16\},\{65444,16\},\{65445,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1404       \{123,7\},\{4086,12\},\{65446,16\},\{65447,16\},\{65448,16\},\{65449,16\},\{65450,16\},\{65451,16\},\{65452,16\},\{65453,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1405       \{250,8\},\{4087,12\},\{65454,16\},\{65455,16\},\{65456,16\},\{65457,16\},\{65458,16\},\{65459,16\},\{65460,16\},\{65461,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1406       \{504,9\},\{32704,15\},\{65462,16\},\{65463,16\},\{65464,16\},\{65465,16\},\{65466,16\},\{65467,16\},\{65468,16\},\{65469,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1407       \{505,9\},\{65470,16\},\{65471,16\},\{65472,16\},\{65473,16\},\{65474,16\},\{65475,16\},\{65476,16\},\{65477,16\},\{65478,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1408       \{506,9\},\{65479,16\},\{65480,16\},\{65481,16\},\{65482,16\},\{65483,16\},\{65484,16\},\{65485,16\},\{65486,16\},\{65487,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1409       \{1017,10\},\{65488,16\},\{65489,16\},\{65490,16\},\{65491,16\},\{65492,16\},\{65493,16\},\{65494,16\},\{65495,16\},\{65496,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1410       \{1018,10\},\{65497,16\},\{65498,16\},\{65499,16\},\{65500,16\},\{65501,16\},\{65502,16\},\{65503,16\},\{65504,16\},\{65505,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1411       \{2040,11\},\{65506,16\},\{65507,16\},\{65508,16\},\{65509,16\},\{65510,16\},\{65511,16\},\{65512,16\},\{65513,16\},\{65514,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1412       \{65515,16\},\{65516,16\},\{65517,16\},\{65518,16\},\{65519,16\},\{65520,16\},\{65521,16\},\{65522,16\},\{65523,16\},\{65524,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1413       \{2041,11\},\{65525,16\},\{65526,16\},\{65527,16\},\{65528,16\},\{65529,16\},\{65530,16\},\{65531,16\},\{65532,16\},\{65533,16\},\{65534,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\}}
\DoxyCodeLine{1414    \};}
\DoxyCodeLine{1415    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} UVAC\_HT[256][2] = \{}
\DoxyCodeLine{1416       \{0,2\},\{1,2\},\{4,3\},\{10,4\},\{24,5\},\{25,5\},\{56,6\},\{120,7\},\{500,9\},\{1014,10\},\{4084,12\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1417       \{11,4\},\{57,6\},\{246,8\},\{501,9\},\{2038,11\},\{4085,12\},\{65416,16\},\{65417,16\},\{65418,16\},\{65419,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1418       \{26,5\},\{247,8\},\{1015,10\},\{4086,12\},\{32706,15\},\{65420,16\},\{65421,16\},\{65422,16\},\{65423,16\},\{65424,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1419       \{27,5\},\{248,8\},\{1016,10\},\{4087,12\},\{65425,16\},\{65426,16\},\{65427,16\},\{65428,16\},\{65429,16\},\{65430,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1420       \{58,6\},\{502,9\},\{65431,16\},\{65432,16\},\{65433,16\},\{65434,16\},\{65435,16\},\{65436,16\},\{65437,16\},\{65438,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1421       \{59,6\},\{1017,10\},\{65439,16\},\{65440,16\},\{65441,16\},\{65442,16\},\{65443,16\},\{65444,16\},\{65445,16\},\{65446,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1422       \{121,7\},\{2039,11\},\{65447,16\},\{65448,16\},\{65449,16\},\{65450,16\},\{65451,16\},\{65452,16\},\{65453,16\},\{65454,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1423       \{122,7\},\{2040,11\},\{65455,16\},\{65456,16\},\{65457,16\},\{65458,16\},\{65459,16\},\{65460,16\},\{65461,16\},\{65462,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1424       \{249,8\},\{65463,16\},\{65464,16\},\{65465,16\},\{65466,16\},\{65467,16\},\{65468,16\},\{65469,16\},\{65470,16\},\{65471,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1425       \{503,9\},\{65472,16\},\{65473,16\},\{65474,16\},\{65475,16\},\{65476,16\},\{65477,16\},\{65478,16\},\{65479,16\},\{65480,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1426       \{504,9\},\{65481,16\},\{65482,16\},\{65483,16\},\{65484,16\},\{65485,16\},\{65486,16\},\{65487,16\},\{65488,16\},\{65489,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1427       \{505,9\},\{65490,16\},\{65491,16\},\{65492,16\},\{65493,16\},\{65494,16\},\{65495,16\},\{65496,16\},\{65497,16\},\{65498,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1428       \{506,9\},\{65499,16\},\{65500,16\},\{65501,16\},\{65502,16\},\{65503,16\},\{65504,16\},\{65505,16\},\{65506,16\},\{65507,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1429       \{2041,11\},\{65508,16\},\{65509,16\},\{65510,16\},\{65511,16\},\{65512,16\},\{65513,16\},\{65514,16\},\{65515,16\},\{65516,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1430       \{16352,14\},\{65517,16\},\{65518,16\},\{65519,16\},\{65520,16\},\{65521,16\},\{65522,16\},\{65523,16\},\{65524,16\},\{65525,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},}
\DoxyCodeLine{1431       \{1018,10\},\{32707,15\},\{65526,16\},\{65527,16\},\{65528,16\},\{65529,16\},\{65530,16\},\{65531,16\},\{65532,16\},\{65533,16\},\{65534,16\},\{0,0\},\{0,0\},\{0,0\},\{0,0\},\{0,0\}}
\DoxyCodeLine{1432    \};}
\DoxyCodeLine{1433    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} YQT[] = \{16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,}
\DoxyCodeLine{1434                              37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99\};}
\DoxyCodeLine{1435    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} UVQT[] = \{17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,}
\DoxyCodeLine{1436                               99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99\};}
\DoxyCodeLine{1437    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} aasf[] = \{ 1.0f * 2.828427125f, 1.387039845f * 2.828427125f, 1.306562965f * 2.828427125f, 1.175875602f * 2.828427125f,}
\DoxyCodeLine{1438                                  1.0f * 2.828427125f, 0.785694958f * 2.828427125f, 0.541196100f * 2.828427125f, 0.275899379f * 2.828427125f \};}
\DoxyCodeLine{1439 }
\DoxyCodeLine{1440    \textcolor{keywordtype}{int} row, col, i, k, subsample;}
\DoxyCodeLine{1441    \textcolor{keywordtype}{float} fdtbl\_Y[64], fdtbl\_UV[64];}
\DoxyCodeLine{1442    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} YTable[64], UVTable[64];}
\DoxyCodeLine{1443 }
\DoxyCodeLine{1444    \textcolor{keywordflow}{if}(!data || !width || !height || comp > 4 || comp < 1) \{}
\DoxyCodeLine{1445       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1446    \}}
\DoxyCodeLine{1447 }
\DoxyCodeLine{1448    quality = quality ? quality : 90;}
\DoxyCodeLine{1449    subsample = quality <= 90 ? 1 : 0;}
\DoxyCodeLine{1450    quality = quality < 1 ? 1 : quality > 100 ? 100 : quality;}
\DoxyCodeLine{1451    quality = quality < 50 ? 5000 / quality : 200 -\/ quality * 2;}
\DoxyCodeLine{1452 }
\DoxyCodeLine{1453    \textcolor{keywordflow}{for}(i = 0; i < 64; ++i) \{}
\DoxyCodeLine{1454       \textcolor{keywordtype}{int} uvti, yti = (YQT[i]*quality+50)/100;}
\DoxyCodeLine{1455       YTable[stbiw\_\_jpg\_ZigZag[i]] = (\textcolor{keywordtype}{unsigned} char) (yti < 1 ? 1 : yti > 255 ? 255 : yti);}
\DoxyCodeLine{1456       uvti = (UVQT[i]*quality+50)/100;}
\DoxyCodeLine{1457       UVTable[stbiw\_\_jpg\_ZigZag[i]] = (\textcolor{keywordtype}{unsigned} char) (uvti < 1 ? 1 : uvti > 255 ? 255 : uvti);}
\DoxyCodeLine{1458    \}}
\DoxyCodeLine{1459 }
\DoxyCodeLine{1460    \textcolor{keywordflow}{for}(row = 0, k = 0; row < 8; ++row) \{}
\DoxyCodeLine{1461       \textcolor{keywordflow}{for}(col = 0; col < 8; ++col, ++k) \{}
\DoxyCodeLine{1462          fdtbl\_Y[k]  = 1 / (YTable [stbiw\_\_jpg\_ZigZag[k]] * aasf[row] * aasf[col]);}
\DoxyCodeLine{1463          fdtbl\_UV[k] = 1 / (UVTable[stbiw\_\_jpg\_ZigZag[k]] * aasf[row] * aasf[col]);}
\DoxyCodeLine{1464       \}}
\DoxyCodeLine{1465    \}}
\DoxyCodeLine{1466 }
\DoxyCodeLine{1467    \textcolor{comment}{// Write Headers}}
\DoxyCodeLine{1468    \{}
\DoxyCodeLine{1469       \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} head0[] = \{ 0xFF,0xD8,0xFF,0xE0,0,0x10,\textcolor{charliteral}{'J'},\textcolor{charliteral}{'F'},\textcolor{charliteral}{'I'},\textcolor{charliteral}{'F'},0,1,1,0,0,1,0,1,0,0,0xFF,0xDB,0,0x84,0 \};}
\DoxyCodeLine{1470       \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} head2[] = \{ 0xFF,0xDA,0,0xC,3,1,0,2,0x11,3,0x11,0,0x3F,0 \};}
\DoxyCodeLine{1471       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} head1[] = \{ 0xFF,0xC0,0,0x11,8,(\textcolor{keywordtype}{unsigned} char)(height>>8),STBIW\_UCHAR(height),(\textcolor{keywordtype}{unsigned} char)(width>>8),STBIW\_UCHAR(width),}
\DoxyCodeLine{1472                                       3,1,(\textcolor{keywordtype}{unsigned} char)(subsample?0x22:0x11),0,2,0x11,1,3,0x11,1,0xFF,0xC4,0x01,0xA2,0 \};}
\DoxyCodeLine{1473       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)head0, \textcolor{keyword}{sizeof}(head0));}
\DoxyCodeLine{1474       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)YTable, \textcolor{keyword}{sizeof}(YTable));}
\DoxyCodeLine{1475       stbiw\_\_putc(s, 1);}
\DoxyCodeLine{1476       s-\/>func(s-\/>context, UVTable, \textcolor{keyword}{sizeof}(UVTable));}
\DoxyCodeLine{1477       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)head1, \textcolor{keyword}{sizeof}(head1));}
\DoxyCodeLine{1478       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)(std\_dc\_luminance\_nrcodes+1), \textcolor{keyword}{sizeof}(std\_dc\_luminance\_nrcodes)-\/1);}
\DoxyCodeLine{1479       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)std\_dc\_luminance\_values, \textcolor{keyword}{sizeof}(std\_dc\_luminance\_values));}
\DoxyCodeLine{1480       stbiw\_\_putc(s, 0x10); \textcolor{comment}{// HTYACinfo}}
\DoxyCodeLine{1481       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)(std\_ac\_luminance\_nrcodes+1), \textcolor{keyword}{sizeof}(std\_ac\_luminance\_nrcodes)-\/1);}
\DoxyCodeLine{1482       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)std\_ac\_luminance\_values, \textcolor{keyword}{sizeof}(std\_ac\_luminance\_values));}
\DoxyCodeLine{1483       stbiw\_\_putc(s, 1); \textcolor{comment}{// HTUDCinfo}}
\DoxyCodeLine{1484       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)(std\_dc\_chrominance\_nrcodes+1), \textcolor{keyword}{sizeof}(std\_dc\_chrominance\_nrcodes)-\/1);}
\DoxyCodeLine{1485       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)std\_dc\_chrominance\_values, \textcolor{keyword}{sizeof}(std\_dc\_chrominance\_values));}
\DoxyCodeLine{1486       stbiw\_\_putc(s, 0x11); \textcolor{comment}{// HTUACinfo}}
\DoxyCodeLine{1487       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)(std\_ac\_chrominance\_nrcodes+1), \textcolor{keyword}{sizeof}(std\_ac\_chrominance\_nrcodes)-\/1);}
\DoxyCodeLine{1488       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)std\_ac\_chrominance\_values, \textcolor{keyword}{sizeof}(std\_ac\_chrominance\_values));}
\DoxyCodeLine{1489       s-\/>func(s-\/>context, (\textcolor{keywordtype}{void}*)head2, \textcolor{keyword}{sizeof}(head2));}
\DoxyCodeLine{1490    \}}
\DoxyCodeLine{1491 }
\DoxyCodeLine{1492    \textcolor{comment}{// Encode 8x8 macroblocks}}
\DoxyCodeLine{1493    \{}
\DoxyCodeLine{1494       \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} fillBits[] = \{0x7F, 7\};}
\DoxyCodeLine{1495       \textcolor{keywordtype}{int} DCY=0, DCU=0, DCV=0;}
\DoxyCodeLine{1496       \textcolor{keywordtype}{int} bitBuf=0, bitCnt=0;}
\DoxyCodeLine{1497       \textcolor{comment}{// comp == 2 is grey+alpha (alpha is ignored)}}
\DoxyCodeLine{1498       \textcolor{keywordtype}{int} ofsG = comp > 2 ? 1 : 0, ofsB = comp > 2 ? 2 : 0;}
\DoxyCodeLine{1499       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *dataR = (\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)data;}
\DoxyCodeLine{1500       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *dataG = dataR + ofsG;}
\DoxyCodeLine{1501       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *dataB = dataR + ofsB;}
\DoxyCodeLine{1502       \textcolor{keywordtype}{int} x, y, pos;}
\DoxyCodeLine{1503       \textcolor{keywordflow}{if}(subsample) \{}
\DoxyCodeLine{1504          \textcolor{keywordflow}{for}(y = 0; y < height; y += 16) \{}
\DoxyCodeLine{1505             \textcolor{keywordflow}{for}(x = 0; x < width; x += 16) \{}
\DoxyCodeLine{1506                \textcolor{keywordtype}{float} Y[256], U[256], V[256];}
\DoxyCodeLine{1507                \textcolor{keywordflow}{for}(row = y, pos = 0; row < y+16; ++row) \{}
\DoxyCodeLine{1508                   \textcolor{comment}{// row >= height => use last input row}}
\DoxyCodeLine{1509                   \textcolor{keywordtype}{int} clamped\_row = (row < height) ? row : height -\/ 1;}
\DoxyCodeLine{1510                   \textcolor{keywordtype}{int} base\_p = (stbi\_\_flip\_vertically\_on\_write ? (height-\/1-\/clamped\_row) : clamped\_row)*width*comp;}
\DoxyCodeLine{1511                   \textcolor{keywordflow}{for}(col = x; col < x+16; ++col, ++pos) \{}
\DoxyCodeLine{1512                      \textcolor{comment}{// if col >= width => use pixel from last input column}}
\DoxyCodeLine{1513                      \textcolor{keywordtype}{int} p = base\_p + ((col < width) ? col : (width-\/1))*comp;}
\DoxyCodeLine{1514                      \textcolor{keywordtype}{float} r = dataR[p], g = dataG[p], b = dataB[p];}
\DoxyCodeLine{1515                      Y[pos]= +0.29900f*r + 0.58700f*g + 0.11400f*b -\/ 128;}
\DoxyCodeLine{1516                      U[pos]= -\/0.16874f*r -\/ 0.33126f*g + 0.50000f*b;}
\DoxyCodeLine{1517                      V[pos]= +0.50000f*r -\/ 0.41869f*g -\/ 0.08131f*b;}
\DoxyCodeLine{1518                   \}}
\DoxyCodeLine{1519                \}}
\DoxyCodeLine{1520                DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y+0,   16, fdtbl\_Y, DCY, YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1521                DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y+8,   16, fdtbl\_Y, DCY, YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1522                DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y+128, 16, fdtbl\_Y, DCY, YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1523                DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y+136, 16, fdtbl\_Y, DCY, YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1524 }
\DoxyCodeLine{1525                \textcolor{comment}{// subsample U,V}}
\DoxyCodeLine{1526                \{}
\DoxyCodeLine{1527                   \textcolor{keywordtype}{float} subU[64], subV[64];}
\DoxyCodeLine{1528                   \textcolor{keywordtype}{int} yy, xx;}
\DoxyCodeLine{1529                   \textcolor{keywordflow}{for}(yy = 0, pos = 0; yy < 8; ++yy) \{}
\DoxyCodeLine{1530                      \textcolor{keywordflow}{for}(xx = 0; xx < 8; ++xx, ++pos) \{}
\DoxyCodeLine{1531                         \textcolor{keywordtype}{int} j = yy*32+xx*2;}
\DoxyCodeLine{1532                         subU[pos] = (U[j+0] + U[j+1] + U[j+16] + U[j+17]) * 0.25f;}
\DoxyCodeLine{1533                         subV[pos] = (V[j+0] + V[j+1] + V[j+16] + V[j+17]) * 0.25f;}
\DoxyCodeLine{1534                      \}}
\DoxyCodeLine{1535                   \}}
\DoxyCodeLine{1536                   DCU = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, subU, 8, fdtbl\_UV, DCU, UVDC\_HT, UVAC\_HT);}
\DoxyCodeLine{1537                   DCV = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, subV, 8, fdtbl\_UV, DCV, UVDC\_HT, UVAC\_HT);}
\DoxyCodeLine{1538                \}}
\DoxyCodeLine{1539             \}}
\DoxyCodeLine{1540          \}}
\DoxyCodeLine{1541       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1542          \textcolor{keywordflow}{for}(y = 0; y < height; y += 8) \{}
\DoxyCodeLine{1543             \textcolor{keywordflow}{for}(x = 0; x < width; x += 8) \{}
\DoxyCodeLine{1544                \textcolor{keywordtype}{float} Y[64], U[64], V[64];}
\DoxyCodeLine{1545                \textcolor{keywordflow}{for}(row = y, pos = 0; row < y+8; ++row) \{}
\DoxyCodeLine{1546                   \textcolor{comment}{// row >= height => use last input row}}
\DoxyCodeLine{1547                   \textcolor{keywordtype}{int} clamped\_row = (row < height) ? row : height -\/ 1;}
\DoxyCodeLine{1548                   \textcolor{keywordtype}{int} base\_p = (stbi\_\_flip\_vertically\_on\_write ? (height-\/1-\/clamped\_row) : clamped\_row)*width*comp;}
\DoxyCodeLine{1549                   \textcolor{keywordflow}{for}(col = x; col < x+8; ++col, ++pos) \{}
\DoxyCodeLine{1550                      \textcolor{comment}{// if col >= width => use pixel from last input column}}
\DoxyCodeLine{1551                      \textcolor{keywordtype}{int} p = base\_p + ((col < width) ? col : (width-\/1))*comp;}
\DoxyCodeLine{1552                      \textcolor{keywordtype}{float} r = dataR[p], g = dataG[p], b = dataB[p];}
\DoxyCodeLine{1553                      Y[pos]= +0.29900f*r + 0.58700f*g + 0.11400f*b -\/ 128;}
\DoxyCodeLine{1554                      U[pos]= -\/0.16874f*r -\/ 0.33126f*g + 0.50000f*b;}
\DoxyCodeLine{1555                      V[pos]= +0.50000f*r -\/ 0.41869f*g -\/ 0.08131f*b;}
\DoxyCodeLine{1556                   \}}
\DoxyCodeLine{1557                \}}
\DoxyCodeLine{1558 }
\DoxyCodeLine{1559                DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y, 8, fdtbl\_Y,  DCY, YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1560                DCU = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, U, 8, fdtbl\_UV, DCU, UVDC\_HT, UVAC\_HT);}
\DoxyCodeLine{1561                DCV = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, V, 8, fdtbl\_UV, DCV, UVDC\_HT, UVAC\_HT);}
\DoxyCodeLine{1562             \}}
\DoxyCodeLine{1563          \}}
\DoxyCodeLine{1564       \}}
\DoxyCodeLine{1565 }
\DoxyCodeLine{1566       \textcolor{comment}{// Do the bit alignment of the EOI marker}}
\DoxyCodeLine{1567       stbiw\_\_jpg\_writeBits(s, \&bitBuf, \&bitCnt, fillBits);}
\DoxyCodeLine{1568    \}}
\DoxyCodeLine{1569 }
\DoxyCodeLine{1570    \textcolor{comment}{// EOI}}
\DoxyCodeLine{1571    stbiw\_\_putc(s, 0xFF);}
\DoxyCodeLine{1572    stbiw\_\_putc(s, 0xD9);}
\DoxyCodeLine{1573 }
\DoxyCodeLine{1574    \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{1575 \}}
\DoxyCodeLine{1576 }
\DoxyCodeLine{1577 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_jpg\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} quality)}
\DoxyCodeLine{1578 \{}
\DoxyCodeLine{1579    stbi\_\_write\_context s = \{ 0 \};}
\DoxyCodeLine{1580    stbi\_\_start\_write\_callbacks(\&s, func, context);}
\DoxyCodeLine{1581    \textcolor{keywordflow}{return} stbi\_write\_jpg\_core(\&s, x, y, comp, (\textcolor{keywordtype}{void} *) data, quality);}
\DoxyCodeLine{1582 \}}
\DoxyCodeLine{1583 }
\DoxyCodeLine{1584 }
\DoxyCodeLine{1585 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{1586 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_jpg(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} quality)}
\DoxyCodeLine{1587 \{}
\DoxyCodeLine{1588    stbi\_\_write\_context s = \{ 0 \};}
\DoxyCodeLine{1589    \textcolor{keywordflow}{if} (stbi\_\_start\_write\_file(\&s,filename)) \{}
\DoxyCodeLine{1590       \textcolor{keywordtype}{int} r = stbi\_write\_jpg\_core(\&s, x, y, comp, data, quality);}
\DoxyCodeLine{1591       stbi\_\_end\_write\_file(\&s);}
\DoxyCodeLine{1592       \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{1593    \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1594       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1595 \}}
\DoxyCodeLine{1596 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1597 }
\DoxyCodeLine{1598 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STB\_IMAGE\_WRITE\_IMPLEMENTATION}}
\DoxyCodeLine{1599 }
\DoxyCodeLine{1600 \textcolor{comment}{/* Revision history}}
\DoxyCodeLine{1601 \textcolor{comment}{      1.14  (2020-\/02-\/02) updated JPEG writer to downsample chroma channels}}
\DoxyCodeLine{1602 \textcolor{comment}{      1.13}}
\DoxyCodeLine{1603 \textcolor{comment}{      1.12}}
\DoxyCodeLine{1604 \textcolor{comment}{      1.11  (2019-\/08-\/11)}}
\DoxyCodeLine{1605 \textcolor{comment}{}}
\DoxyCodeLine{1606 \textcolor{comment}{      1.10  (2019-\/02-\/07)}}
\DoxyCodeLine{1607 \textcolor{comment}{             support utf8 filenames in Windows; fix warnings and platform ifdefs}}
\DoxyCodeLine{1608 \textcolor{comment}{      1.09  (2018-\/02-\/11)}}
\DoxyCodeLine{1609 \textcolor{comment}{             fix typo in zlib quality API, improve STB\_I\_W\_STATIC in C++}}
\DoxyCodeLine{1610 \textcolor{comment}{      1.08  (2018-\/01-\/29)}}
\DoxyCodeLine{1611 \textcolor{comment}{             add stbi\_\_flip\_vertically\_on\_write, external zlib, zlib quality, choose PNG filter}}
\DoxyCodeLine{1612 \textcolor{comment}{      1.07  (2017-\/07-\/24)}}
\DoxyCodeLine{1613 \textcolor{comment}{             doc fix}}
\DoxyCodeLine{1614 \textcolor{comment}{      1.06 (2017-\/07-\/23)}}
\DoxyCodeLine{1615 \textcolor{comment}{             writing JPEG (using Jon Olick's code)}}
\DoxyCodeLine{1616 \textcolor{comment}{      1.05   ???}}
\DoxyCodeLine{1617 \textcolor{comment}{      1.04 (2017-\/03-\/03)}}
\DoxyCodeLine{1618 \textcolor{comment}{             monochrome BMP expansion}}
\DoxyCodeLine{1619 \textcolor{comment}{      1.03   ???}}
\DoxyCodeLine{1620 \textcolor{comment}{      1.02 (2016-\/04-\/02)}}
\DoxyCodeLine{1621 \textcolor{comment}{             avoid allocating large structures on the stack}}
\DoxyCodeLine{1622 \textcolor{comment}{      1.01 (2016-\/01-\/16)}}
\DoxyCodeLine{1623 \textcolor{comment}{             STBIW\_REALLOC\_SIZED: support allocators with no realloc support}}
\DoxyCodeLine{1624 \textcolor{comment}{             avoid race-\/condition in crc initialization}}
\DoxyCodeLine{1625 \textcolor{comment}{             minor compile issues}}
\DoxyCodeLine{1626 \textcolor{comment}{      1.00 (2015-\/09-\/14)}}
\DoxyCodeLine{1627 \textcolor{comment}{             installable file IO function}}
\DoxyCodeLine{1628 \textcolor{comment}{      0.99 (2015-\/09-\/13)}}
\DoxyCodeLine{1629 \textcolor{comment}{             warning fixes; TGA rle support}}
\DoxyCodeLine{1630 \textcolor{comment}{      0.98 (2015-\/04-\/08)}}
\DoxyCodeLine{1631 \textcolor{comment}{             added STBIW\_MALLOC, STBIW\_ASSERT etc}}
\DoxyCodeLine{1632 \textcolor{comment}{      0.97 (2015-\/01-\/18)}}
\DoxyCodeLine{1633 \textcolor{comment}{             fixed HDR asserts, rewrote HDR rle logic}}
\DoxyCodeLine{1634 \textcolor{comment}{      0.96 (2015-\/01-\/17)}}
\DoxyCodeLine{1635 \textcolor{comment}{             add HDR output}}
\DoxyCodeLine{1636 \textcolor{comment}{             fix monochrome BMP}}
\DoxyCodeLine{1637 \textcolor{comment}{      0.95 (2014-\/08-\/17)}}
\DoxyCodeLine{1638 \textcolor{comment}{               add monochrome TGA output}}
\DoxyCodeLine{1639 \textcolor{comment}{      0.94 (2014-\/05-\/31)}}
\DoxyCodeLine{1640 \textcolor{comment}{             rename private functions to avoid conflicts with stb\_image.h}}
\DoxyCodeLine{1641 \textcolor{comment}{      0.93 (2014-\/05-\/27)}}
\DoxyCodeLine{1642 \textcolor{comment}{             warning fixes}}
\DoxyCodeLine{1643 \textcolor{comment}{      0.92 (2010-\/08-\/01)}}
\DoxyCodeLine{1644 \textcolor{comment}{             casts to unsigned char to fix warnings}}
\DoxyCodeLine{1645 \textcolor{comment}{      0.91 (2010-\/07-\/17)}}
\DoxyCodeLine{1646 \textcolor{comment}{             first public release}}
\DoxyCodeLine{1647 \textcolor{comment}{      0.90   first internal release}}
\DoxyCodeLine{1648 \textcolor{comment}{*/}}
\DoxyCodeLine{1649 }
\DoxyCodeLine{1650 \textcolor{comment}{/*}}
\DoxyCodeLine{1651 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1652 \textcolor{comment}{This software is available under 2 licenses -\/-\/ choose whichever you prefer.}}
\DoxyCodeLine{1653 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1654 \textcolor{comment}{ALTERNATIVE A -\/ MIT License}}
\DoxyCodeLine{1655 \textcolor{comment}{Copyright (c) 2017 Sean Barrett}}
\DoxyCodeLine{1656 \textcolor{comment}{Permission is hereby granted, free of charge, to any person obtaining a copy of}}
\DoxyCodeLine{1657 \textcolor{comment}{this software and associated documentation files (the "{}Software"{}), to deal in}}
\DoxyCodeLine{1658 \textcolor{comment}{the Software without restriction, including without limitation the rights to}}
\DoxyCodeLine{1659 \textcolor{comment}{use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies}}
\DoxyCodeLine{1660 \textcolor{comment}{of the Software, and to permit persons to whom the Software is furnished to do}}
\DoxyCodeLine{1661 \textcolor{comment}{so, subject to the following conditions:}}
\DoxyCodeLine{1662 \textcolor{comment}{The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{1663 \textcolor{comment}{copies or substantial portions of the Software.}}
\DoxyCodeLine{1664 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{1665 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{1666 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{1667 \textcolor{comment}{AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{1668 \textcolor{comment}{LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{1669 \textcolor{comment}{OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{1670 \textcolor{comment}{SOFTWARE.}}
\DoxyCodeLine{1671 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1672 \textcolor{comment}{ALTERNATIVE B -\/ Public Domain (www.unlicense.org)}}
\DoxyCodeLine{1673 \textcolor{comment}{This is free and unencumbered software released into the public domain.}}
\DoxyCodeLine{1674 \textcolor{comment}{Anyone is free to copy, modify, publish, use, compile, sell, or distribute this}}
\DoxyCodeLine{1675 \textcolor{comment}{software, either in source code form or as a compiled binary, for any purpose,}}
\DoxyCodeLine{1676 \textcolor{comment}{commercial or non-\/commercial, and by any means.}}
\DoxyCodeLine{1677 \textcolor{comment}{In jurisdictions that recognize copyright laws, the author or authors of this}}
\DoxyCodeLine{1678 \textcolor{comment}{software dedicate any and all copyright interest in the software to the public}}
\DoxyCodeLine{1679 \textcolor{comment}{domain. We make this dedication for the benefit of the public at large and to}}
\DoxyCodeLine{1680 \textcolor{comment}{the detriment of our heirs and successors. We intend this dedication to be an}}
\DoxyCodeLine{1681 \textcolor{comment}{overt act of relinquishment in perpetuity of all present and future rights to}}
\DoxyCodeLine{1682 \textcolor{comment}{this software under copyright law.}}
\DoxyCodeLine{1683 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{1684 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{1685 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{1686 \textcolor{comment}{AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN}}
\DoxyCodeLine{1687 \textcolor{comment}{ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION}}
\DoxyCodeLine{1688 \textcolor{comment}{WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{1689 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1690 \textcolor{comment}{*/}}

\end{DoxyCode}
