\hypertarget{stb__image__resize_8h_source}{}\doxysection{stb\+\_\+image\+\_\+resize.\+h}
\label{stb__image__resize_8h_source}\index{C:/Users/wcjb/Documents/CodeSpace/YFlow/img/stb\_image\_resize.h@{C:/Users/wcjb/Documents/CodeSpace/YFlow/img/stb\_image\_resize.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/* stb\_image\_resize -\/ v0.96 -\/ public domain image resizing}}
\DoxyCodeLine{2 \textcolor{comment}{   by Jorge L Rodriguez (@VinoBS) -\/ 2014}}
\DoxyCodeLine{3 \textcolor{comment}{   http://github.com/nothings/stb}}
\DoxyCodeLine{4 \textcolor{comment}{}}
\DoxyCodeLine{5 \textcolor{comment}{   Written with emphasis on usability, portability, and efficiency. (No}}
\DoxyCodeLine{6 \textcolor{comment}{   SIMD or threads, so it be easily outperformed by libs that use those.)}}
\DoxyCodeLine{7 \textcolor{comment}{   Only scaling and translation is supported, no rotations or shears.}}
\DoxyCodeLine{8 \textcolor{comment}{   Easy API downsamples w/Mitchell filter, upsamples w/cubic interpolation.}}
\DoxyCodeLine{9 \textcolor{comment}{}}
\DoxyCodeLine{10 \textcolor{comment}{   COMPILING \& LINKING}}
\DoxyCodeLine{11 \textcolor{comment}{      In one C/C++ file that \#includes this file, do this:}}
\DoxyCodeLine{12 \textcolor{comment}{         \#define STB\_IMAGE\_RESIZE\_IMPLEMENTATION}}
\DoxyCodeLine{13 \textcolor{comment}{      before the \#include. That will create the implementation in that file.}}
\DoxyCodeLine{14 \textcolor{comment}{}}
\DoxyCodeLine{15 \textcolor{comment}{   QUICKSTART}}
\DoxyCodeLine{16 \textcolor{comment}{      stbir\_resize\_uint8(      input\_pixels , in\_w , in\_h , 0,}}
\DoxyCodeLine{17 \textcolor{comment}{                               output\_pixels, out\_w, out\_h, 0, num\_channels)}}
\DoxyCodeLine{18 \textcolor{comment}{      stbir\_resize\_float(...)}}
\DoxyCodeLine{19 \textcolor{comment}{      stbir\_resize\_uint8\_srgb( input\_pixels , in\_w , in\_h , 0,}}
\DoxyCodeLine{20 \textcolor{comment}{                               output\_pixels, out\_w, out\_h, 0,}}
\DoxyCodeLine{21 \textcolor{comment}{                               num\_channels , alpha\_chan  , 0)}}
\DoxyCodeLine{22 \textcolor{comment}{      stbir\_resize\_uint8\_srgb\_edgemode(}}
\DoxyCodeLine{23 \textcolor{comment}{                               input\_pixels , in\_w , in\_h , 0,}}
\DoxyCodeLine{24 \textcolor{comment}{                               output\_pixels, out\_w, out\_h, 0,}}
\DoxyCodeLine{25 \textcolor{comment}{                               num\_channels , alpha\_chan  , 0, STBIR\_EDGE\_CLAMP)}}
\DoxyCodeLine{26 \textcolor{comment}{                                                            // WRAP/REFLECT/ZERO}}
\DoxyCodeLine{27 \textcolor{comment}{}}
\DoxyCodeLine{28 \textcolor{comment}{   FULL API}}
\DoxyCodeLine{29 \textcolor{comment}{      See the "{}header file"{} section of the source for API documentation.}}
\DoxyCodeLine{30 \textcolor{comment}{}}
\DoxyCodeLine{31 \textcolor{comment}{   ADDITIONAL DOCUMENTATION}}
\DoxyCodeLine{32 \textcolor{comment}{}}
\DoxyCodeLine{33 \textcolor{comment}{      SRGB \& FLOATING POINT REPRESENTATION}}
\DoxyCodeLine{34 \textcolor{comment}{         The sRGB functions presume IEEE floating point. If you do not have}}
\DoxyCodeLine{35 \textcolor{comment}{         IEEE floating point, define STBIR\_NON\_IEEE\_FLOAT. This will use}}
\DoxyCodeLine{36 \textcolor{comment}{         a slower implementation.}}
\DoxyCodeLine{37 \textcolor{comment}{}}
\DoxyCodeLine{38 \textcolor{comment}{      MEMORY ALLOCATION}}
\DoxyCodeLine{39 \textcolor{comment}{         The resize functions here perform a single memory allocation using}}
\DoxyCodeLine{40 \textcolor{comment}{         malloc. To control the memory allocation, before the \#include that}}
\DoxyCodeLine{41 \textcolor{comment}{         triggers the implementation, do:}}
\DoxyCodeLine{42 \textcolor{comment}{}}
\DoxyCodeLine{43 \textcolor{comment}{            \#define STBIR\_MALLOC(size,context) ...}}
\DoxyCodeLine{44 \textcolor{comment}{            \#define STBIR\_FREE(ptr,context)   ...}}
\DoxyCodeLine{45 \textcolor{comment}{}}
\DoxyCodeLine{46 \textcolor{comment}{         Each resize function makes exactly one call to malloc/free, so to use}}
\DoxyCodeLine{47 \textcolor{comment}{         temp memory, store the temp memory in the context and return that.}}
\DoxyCodeLine{48 \textcolor{comment}{}}
\DoxyCodeLine{49 \textcolor{comment}{      ASSERT}}
\DoxyCodeLine{50 \textcolor{comment}{         Define STBIR\_ASSERT(boolval) to override assert() and not use assert.h}}
\DoxyCodeLine{51 \textcolor{comment}{}}
\DoxyCodeLine{52 \textcolor{comment}{      OPTIMIZATION}}
\DoxyCodeLine{53 \textcolor{comment}{         Define STBIR\_SATURATE\_INT to compute clamp values in-\/range using}}
\DoxyCodeLine{54 \textcolor{comment}{         integer operations instead of float operations. This may be faster}}
\DoxyCodeLine{55 \textcolor{comment}{         on some platforms.}}
\DoxyCodeLine{56 \textcolor{comment}{}}
\DoxyCodeLine{57 \textcolor{comment}{      DEFAULT FILTERS}}
\DoxyCodeLine{58 \textcolor{comment}{         For functions which don't provide explicit control over what filters}}
\DoxyCodeLine{59 \textcolor{comment}{         to use, you can change the compile-\/time defaults with}}
\DoxyCodeLine{60 \textcolor{comment}{}}
\DoxyCodeLine{61 \textcolor{comment}{            \#define STBIR\_DEFAULT\_FILTER\_UPSAMPLE     STBIR\_FILTER\_something}}
\DoxyCodeLine{62 \textcolor{comment}{            \#define STBIR\_DEFAULT\_FILTER\_DOWNSAMPLE   STBIR\_FILTER\_something}}
\DoxyCodeLine{63 \textcolor{comment}{}}
\DoxyCodeLine{64 \textcolor{comment}{         See stbir\_filter in the header-\/file section for the list of filters.}}
\DoxyCodeLine{65 \textcolor{comment}{}}
\DoxyCodeLine{66 \textcolor{comment}{      NEW FILTERS}}
\DoxyCodeLine{67 \textcolor{comment}{         A number of 1D filter kernels are used. For a list of}}
\DoxyCodeLine{68 \textcolor{comment}{         supported filters see the stbir\_filter enum. To add a new filter,}}
\DoxyCodeLine{69 \textcolor{comment}{         write a filter function and add it to stbir\_\_filter\_info\_table.}}
\DoxyCodeLine{70 \textcolor{comment}{}}
\DoxyCodeLine{71 \textcolor{comment}{      PROGRESS}}
\DoxyCodeLine{72 \textcolor{comment}{         For interactive use with slow resize operations, you can install}}
\DoxyCodeLine{73 \textcolor{comment}{         a progress-\/report callback:}}
\DoxyCodeLine{74 \textcolor{comment}{}}
\DoxyCodeLine{75 \textcolor{comment}{            \#define STBIR\_PROGRESS\_REPORT(val)   some\_func(val)}}
\DoxyCodeLine{76 \textcolor{comment}{}}
\DoxyCodeLine{77 \textcolor{comment}{         The parameter val is a float which goes from 0 to 1 as progress is made.}}
\DoxyCodeLine{78 \textcolor{comment}{}}
\DoxyCodeLine{79 \textcolor{comment}{         For example:}}
\DoxyCodeLine{80 \textcolor{comment}{}}
\DoxyCodeLine{81 \textcolor{comment}{            static void my\_progress\_report(float progress);}}
\DoxyCodeLine{82 \textcolor{comment}{            \#define STBIR\_PROGRESS\_REPORT(val) my\_progress\_report(val)}}
\DoxyCodeLine{83 \textcolor{comment}{}}
\DoxyCodeLine{84 \textcolor{comment}{            \#define STB\_IMAGE\_RESIZE\_IMPLEMENTATION}}
\DoxyCodeLine{85 \textcolor{comment}{            \#include "{}stb\_image\_resize.h"{}}}
\DoxyCodeLine{86 \textcolor{comment}{}}
\DoxyCodeLine{87 \textcolor{comment}{            static void my\_progress\_report(float progress)}}
\DoxyCodeLine{88 \textcolor{comment}{            \{}}
\DoxyCodeLine{89 \textcolor{comment}{               printf("{}Progress: \%f\%\%\(\backslash\)n"{}, progress*100);}}
\DoxyCodeLine{90 \textcolor{comment}{            \}}}
\DoxyCodeLine{91 \textcolor{comment}{}}
\DoxyCodeLine{92 \textcolor{comment}{      MAX CHANNELS}}
\DoxyCodeLine{93 \textcolor{comment}{         If your image has more than 64 channels, define STBIR\_MAX\_CHANNELS}}
\DoxyCodeLine{94 \textcolor{comment}{         to the max you'll have.}}
\DoxyCodeLine{95 \textcolor{comment}{}}
\DoxyCodeLine{96 \textcolor{comment}{      ALPHA CHANNEL}}
\DoxyCodeLine{97 \textcolor{comment}{         Most of the resizing functions provide the ability to control how}}
\DoxyCodeLine{98 \textcolor{comment}{         the alpha channel of an image is processed. The important things}}
\DoxyCodeLine{99 \textcolor{comment}{         to know about this:}}
\DoxyCodeLine{100 \textcolor{comment}{}}
\DoxyCodeLine{101 \textcolor{comment}{         1. The best mathematically-\/behaved version of alpha to use is}}
\DoxyCodeLine{102 \textcolor{comment}{         called "{}premultiplied alpha"{}, in which the other color channels}}
\DoxyCodeLine{103 \textcolor{comment}{         have had the alpha value multiplied in. If you use premultiplied}}
\DoxyCodeLine{104 \textcolor{comment}{         alpha, linear filtering (such as image resampling done by this}}
\DoxyCodeLine{105 \textcolor{comment}{         library, or performed in texture units on GPUs) does the "{}right}}
\DoxyCodeLine{106 \textcolor{comment}{         thing"{}. While premultiplied alpha is standard in the movie CGI}}
\DoxyCodeLine{107 \textcolor{comment}{         industry, it is still uncommon in the videogame/real-\/time world.}}
\DoxyCodeLine{108 \textcolor{comment}{}}
\DoxyCodeLine{109 \textcolor{comment}{         If you linearly filter non-\/premultiplied alpha, strange effects}}
\DoxyCodeLine{110 \textcolor{comment}{         occur. (For example, the 50/50 average of 99\% transparent bright green}}
\DoxyCodeLine{111 \textcolor{comment}{         and 1\% transparent black produces 50\% transparent dark green when}}
\DoxyCodeLine{112 \textcolor{comment}{         non-\/premultiplied, whereas premultiplied it produces 50\%}}
\DoxyCodeLine{113 \textcolor{comment}{         transparent near-\/black. The former introduces green energy}}
\DoxyCodeLine{114 \textcolor{comment}{         that doesn't exist in the source image.)}}
\DoxyCodeLine{115 \textcolor{comment}{}}
\DoxyCodeLine{116 \textcolor{comment}{         2. Artists should not edit premultiplied-\/alpha images; artists}}
\DoxyCodeLine{117 \textcolor{comment}{         want non-\/premultiplied alpha images. Thus, art tools generally output}}
\DoxyCodeLine{118 \textcolor{comment}{         non-\/premultiplied alpha images.}}
\DoxyCodeLine{119 \textcolor{comment}{}}
\DoxyCodeLine{120 \textcolor{comment}{         3. You will get best results in most cases by converting images}}
\DoxyCodeLine{121 \textcolor{comment}{         to premultiplied alpha before processing them mathematically.}}
\DoxyCodeLine{122 \textcolor{comment}{}}
\DoxyCodeLine{123 \textcolor{comment}{         4. If you pass the flag STBIR\_FLAG\_ALPHA\_PREMULTIPLIED, the}}
\DoxyCodeLine{124 \textcolor{comment}{         resizer does not do anything special for the alpha channel;}}
\DoxyCodeLine{125 \textcolor{comment}{         it is resampled identically to other channels. This produces}}
\DoxyCodeLine{126 \textcolor{comment}{         the correct results for premultiplied-\/alpha images, but produces}}
\DoxyCodeLine{127 \textcolor{comment}{         less-\/than-\/ideal results for non-\/premultiplied-\/alpha images.}}
\DoxyCodeLine{128 \textcolor{comment}{}}
\DoxyCodeLine{129 \textcolor{comment}{         5. If you do not pass the flag STBIR\_FLAG\_ALPHA\_PREMULTIPLIED,}}
\DoxyCodeLine{130 \textcolor{comment}{         then the resizer weights the contribution of input pixels}}
\DoxyCodeLine{131 \textcolor{comment}{         based on their alpha values, or, equivalently, it multiplies}}
\DoxyCodeLine{132 \textcolor{comment}{         the alpha value into the color channels, resamples, then divides}}
\DoxyCodeLine{133 \textcolor{comment}{         by the resultant alpha value. Input pixels which have alpha=0 do}}
\DoxyCodeLine{134 \textcolor{comment}{         not contribute at all to output pixels unless \_all\_ of the input}}
\DoxyCodeLine{135 \textcolor{comment}{         pixels affecting that output pixel have alpha=0, in which case}}
\DoxyCodeLine{136 \textcolor{comment}{         the result for that pixel is the same as it would be without}}
\DoxyCodeLine{137 \textcolor{comment}{         STBIR\_FLAG\_ALPHA\_PREMULTIPLIED. However, this is only true for}}
\DoxyCodeLine{138 \textcolor{comment}{         input images in integer formats. For input images in float format,}}
\DoxyCodeLine{139 \textcolor{comment}{         input pixels with alpha=0 have no effect, and output pixels}}
\DoxyCodeLine{140 \textcolor{comment}{         which have alpha=0 will be 0 in all channels. (For float images,}}
\DoxyCodeLine{141 \textcolor{comment}{         you can manually achieve the same result by adding a tiny epsilon}}
\DoxyCodeLine{142 \textcolor{comment}{         value to the alpha channel of every image, and then subtracting}}
\DoxyCodeLine{143 \textcolor{comment}{         or clamping it at the end.)}}
\DoxyCodeLine{144 \textcolor{comment}{}}
\DoxyCodeLine{145 \textcolor{comment}{         6. You can suppress the behavior described in \#5 and make}}
\DoxyCodeLine{146 \textcolor{comment}{         all-\/0-\/alpha pixels have 0 in all channels by \#defining}}
\DoxyCodeLine{147 \textcolor{comment}{         STBIR\_NO\_ALPHA\_EPSILON.}}
\DoxyCodeLine{148 \textcolor{comment}{}}
\DoxyCodeLine{149 \textcolor{comment}{         7. You can separately control whether the alpha channel is}}
\DoxyCodeLine{150 \textcolor{comment}{         interpreted as linear or affected by the colorspace. By default}}
\DoxyCodeLine{151 \textcolor{comment}{         it is linear; you almost never want to apply the colorspace.}}
\DoxyCodeLine{152 \textcolor{comment}{         (For example, graphics hardware does not apply sRGB conversion}}
\DoxyCodeLine{153 \textcolor{comment}{         to the alpha channel.)}}
\DoxyCodeLine{154 \textcolor{comment}{}}
\DoxyCodeLine{155 \textcolor{comment}{   CONTRIBUTORS}}
\DoxyCodeLine{156 \textcolor{comment}{      Jorge L Rodriguez: Implementation}}
\DoxyCodeLine{157 \textcolor{comment}{      Sean Barrett: API design, optimizations}}
\DoxyCodeLine{158 \textcolor{comment}{      Aras Pranckevicius: bugfix}}
\DoxyCodeLine{159 \textcolor{comment}{      Nathan Reed: warning fixes}}
\DoxyCodeLine{160 \textcolor{comment}{}}
\DoxyCodeLine{161 \textcolor{comment}{   REVISIONS}}
\DoxyCodeLine{162 \textcolor{comment}{      0.97 (2020-\/02-\/02) fixed warning}}
\DoxyCodeLine{163 \textcolor{comment}{      0.96 (2019-\/03-\/04) fixed warnings}}
\DoxyCodeLine{164 \textcolor{comment}{      0.95 (2017-\/07-\/23) fixed warnings}}
\DoxyCodeLine{165 \textcolor{comment}{      0.94 (2017-\/03-\/18) fixed warnings}}
\DoxyCodeLine{166 \textcolor{comment}{      0.93 (2017-\/03-\/03) fixed bug with certain combinations of heights}}
\DoxyCodeLine{167 \textcolor{comment}{      0.92 (2017-\/01-\/02) fix integer overflow on large (>2GB) images}}
\DoxyCodeLine{168 \textcolor{comment}{      0.91 (2016-\/04-\/02) fix warnings; fix handling of subpixel regions}}
\DoxyCodeLine{169 \textcolor{comment}{      0.90 (2014-\/09-\/17) first released version}}
\DoxyCodeLine{170 \textcolor{comment}{}}
\DoxyCodeLine{171 \textcolor{comment}{   LICENSE}}
\DoxyCodeLine{172 \textcolor{comment}{     See end of file for license information.}}
\DoxyCodeLine{173 \textcolor{comment}{}}
\DoxyCodeLine{174 \textcolor{comment}{   TODO}}
\DoxyCodeLine{175 \textcolor{comment}{      Don't decode all of the image data when only processing a partial tile}}
\DoxyCodeLine{176 \textcolor{comment}{      Don't use full-\/width decode buffers when only processing a partial tile}}
\DoxyCodeLine{177 \textcolor{comment}{      When processing wide images, break processing into tiles so data fits in L1 cache}}
\DoxyCodeLine{178 \textcolor{comment}{      Installable filters?}}
\DoxyCodeLine{179 \textcolor{comment}{      Resize that respects alpha test coverage}}
\DoxyCodeLine{180 \textcolor{comment}{         (Reference code: FloatImage::alphaTestCoverage and FloatImage::scaleAlphaToCoverage:}}
\DoxyCodeLine{181 \textcolor{comment}{         https://code.google.com/p/nvidia-\/texture-\/tools/source/browse/trunk/src/nvimage/FloatImage.cpp )}}
\DoxyCodeLine{182 \textcolor{comment}{*/}}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{preprocessor}{\#ifndef STBIR\_INCLUDE\_STB\_IMAGE\_RESIZE\_H}}
\DoxyCodeLine{185 \textcolor{preprocessor}{\#define STBIR\_INCLUDE\_STB\_IMAGE\_RESIZE\_H}}
\DoxyCodeLine{186 }
\DoxyCodeLine{187 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{188 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}  stbir\_uint8;}
\DoxyCodeLine{189 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} stbir\_uint16;}
\DoxyCodeLine{190 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}   stbir\_uint32;}
\DoxyCodeLine{191 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{192 \textcolor{preprocessor}{\#include <stdint.h>}}
\DoxyCodeLine{193 \textcolor{keyword}{typedef} uint8\_t  stbir\_uint8;}
\DoxyCodeLine{194 \textcolor{keyword}{typedef} uint16\_t stbir\_uint16;}
\DoxyCodeLine{195 \textcolor{keyword}{typedef} uint32\_t stbir\_uint32;}
\DoxyCodeLine{196 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{197 }
\DoxyCodeLine{198 \textcolor{preprocessor}{\#ifndef STBIRDEF}}
\DoxyCodeLine{199 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_RESIZE\_STATIC}}
\DoxyCodeLine{200 \textcolor{preprocessor}{\#define STBIRDEF static}}
\DoxyCodeLine{201 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{202 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{203 \textcolor{preprocessor}{\#define STBIRDEF extern "{}C"{}}}
\DoxyCodeLine{204 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{205 \textcolor{preprocessor}{\#define STBIRDEF extern}}
\DoxyCodeLine{206 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{207 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{208 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{209 }
\DoxyCodeLine{211 \textcolor{comment}{//}}
\DoxyCodeLine{212 \textcolor{comment}{// Easy-\/to-\/use API:}}
\DoxyCodeLine{213 \textcolor{comment}{//}}
\DoxyCodeLine{214 \textcolor{comment}{//     * "{}input pixels"{} points to an array of image data with 'num\_channels' channels (e.g. RGB=3, RGBA=4)}}
\DoxyCodeLine{215 \textcolor{comment}{//     * input\_w is input image width (x-\/axis), input\_h is input image height (y-\/axis)}}
\DoxyCodeLine{216 \textcolor{comment}{//     * stride is the offset between successive rows of image data in memory, in bytes. you can}}
\DoxyCodeLine{217 \textcolor{comment}{//       specify 0 to mean packed continuously in memory}}
\DoxyCodeLine{218 \textcolor{comment}{//     * alpha channel is treated identically to other channels.}}
\DoxyCodeLine{219 \textcolor{comment}{//     * colorspace is linear or sRGB as specified by function name}}
\DoxyCodeLine{220 \textcolor{comment}{//     * returned result is 1 for success or 0 in case of an error.}}
\DoxyCodeLine{221 \textcolor{comment}{//       \#define STBIR\_ASSERT() to trigger an assert on parameter validation errors.}}
\DoxyCodeLine{222 \textcolor{comment}{//     * Memory required grows approximately linearly with input and output size, but with}}
\DoxyCodeLine{223 \textcolor{comment}{//       discontinuities at input\_w == output\_w and input\_h == output\_h.}}
\DoxyCodeLine{224 \textcolor{comment}{//     * These functions use a "{}default"{} resampling filter defined at compile time. To change the filter,}}
\DoxyCodeLine{225 \textcolor{comment}{//       you can change the compile-\/time defaults by \#defining STBIR\_DEFAULT\_FILTER\_UPSAMPLE}}
\DoxyCodeLine{226 \textcolor{comment}{//       and STBIR\_DEFAULT\_FILTER\_DOWNSAMPLE, or you can use the medium-\/complexity API.}}
\DoxyCodeLine{227 }
\DoxyCodeLine{228 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint8(     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{229                                            \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{230                                      \textcolor{keywordtype}{int} num\_channels);}
\DoxyCodeLine{231 }
\DoxyCodeLine{232 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_float(     \textcolor{keyword}{const} \textcolor{keywordtype}{float} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{233                                            \textcolor{keywordtype}{float} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{234                                      \textcolor{keywordtype}{int} num\_channels);}
\DoxyCodeLine{235 }
\DoxyCodeLine{236 }
\DoxyCodeLine{237 \textcolor{comment}{// The following functions interpret image data as gamma-\/corrected sRGB.}}
\DoxyCodeLine{238 \textcolor{comment}{// Specify STBIR\_ALPHA\_CHANNEL\_NONE if you have no alpha channel,}}
\DoxyCodeLine{239 \textcolor{comment}{// or otherwise provide the index of the alpha channel. Flags value}}
\DoxyCodeLine{240 \textcolor{comment}{// of 0 will probably do the right thing if you're not sure what}}
\DoxyCodeLine{241 \textcolor{comment}{// the flags mean.}}
\DoxyCodeLine{242 }
\DoxyCodeLine{243 \textcolor{preprocessor}{\#define STBIR\_ALPHA\_CHANNEL\_NONE       -\/1}}
\DoxyCodeLine{244 }
\DoxyCodeLine{245 \textcolor{comment}{// Set this flag if your texture has premultiplied alpha. Otherwise, stbir will}}
\DoxyCodeLine{246 \textcolor{comment}{// use alpha-\/weighted resampling (effectively premultiplying, resampling,}}
\DoxyCodeLine{247 \textcolor{comment}{// then unpremultiplying).}}
\DoxyCodeLine{248 \textcolor{preprocessor}{\#define STBIR\_FLAG\_ALPHA\_PREMULTIPLIED    (1 << 0)}}
\DoxyCodeLine{249 \textcolor{comment}{// The specified alpha channel should be handled as gamma-\/corrected value even}}
\DoxyCodeLine{250 \textcolor{comment}{// when doing sRGB operations.}}
\DoxyCodeLine{251 \textcolor{preprocessor}{\#define STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE  (1 << 1)}}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint8\_srgb(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{254                                            \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{255                                      \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags);}
\DoxyCodeLine{256 }
\DoxyCodeLine{257 }
\DoxyCodeLine{258 \textcolor{keyword}{typedef} \textcolor{keyword}{enum}}
\DoxyCodeLine{259 \{}
\DoxyCodeLine{260     STBIR\_EDGE\_CLAMP   = 1,}
\DoxyCodeLine{261     STBIR\_EDGE\_REFLECT = 2,}
\DoxyCodeLine{262     STBIR\_EDGE\_WRAP    = 3,}
\DoxyCodeLine{263     STBIR\_EDGE\_ZERO    = 4,}
\DoxyCodeLine{264 \} stbir\_edge;}
\DoxyCodeLine{265 }
\DoxyCodeLine{266 \textcolor{comment}{// This function adds the ability to specify how requests to sample off the edge of the image are handled.}}
\DoxyCodeLine{267 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint8\_srgb\_edgemode(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{268                                                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{269                                               \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{270                                               stbir\_edge edge\_wrap\_mode);}
\DoxyCodeLine{271 }
\DoxyCodeLine{273 \textcolor{comment}{//}}
\DoxyCodeLine{274 \textcolor{comment}{// Medium-\/complexity API}}
\DoxyCodeLine{275 \textcolor{comment}{//}}
\DoxyCodeLine{276 \textcolor{comment}{// This extends the easy-\/to-\/use API as follows:}}
\DoxyCodeLine{277 \textcolor{comment}{//}}
\DoxyCodeLine{278 \textcolor{comment}{//     * Alpha-\/channel can be processed separately}}
\DoxyCodeLine{279 \textcolor{comment}{//       * If alpha\_channel is not STBIR\_ALPHA\_CHANNEL\_NONE}}
\DoxyCodeLine{280 \textcolor{comment}{//         * Alpha channel will not be gamma corrected (unless flags\&STBIR\_FLAG\_GAMMA\_CORRECT)}}
\DoxyCodeLine{281 \textcolor{comment}{//         * Filters will be weighted by alpha channel (unless flags\&STBIR\_FLAG\_ALPHA\_PREMULTIPLIED)}}
\DoxyCodeLine{282 \textcolor{comment}{//     * Filter can be selected explicitly}}
\DoxyCodeLine{283 \textcolor{comment}{//     * uint16 image type}}
\DoxyCodeLine{284 \textcolor{comment}{//     * sRGB colorspace available for all types}}
\DoxyCodeLine{285 \textcolor{comment}{//     * context parameter for passing to STBIR\_MALLOC}}
\DoxyCodeLine{286 }
\DoxyCodeLine{287 \textcolor{keyword}{typedef} \textcolor{keyword}{enum}}
\DoxyCodeLine{288 \{}
\DoxyCodeLine{289     STBIR\_FILTER\_DEFAULT      = 0,  \textcolor{comment}{// use same filter type that easy-\/to-\/use API chooses}}
\DoxyCodeLine{290     STBIR\_FILTER\_BOX          = 1,  \textcolor{comment}{// A trapezoid w/1-\/pixel wide ramps, same result as box for integer scale ratios}}
\DoxyCodeLine{291     STBIR\_FILTER\_TRIANGLE     = 2,  \textcolor{comment}{// On upsampling, produces same results as bilinear texture filtering}}
\DoxyCodeLine{292     STBIR\_FILTER\_CUBICBSPLINE = 3,  \textcolor{comment}{// The cubic b-\/spline (aka Mitchell-\/Netrevalli with B=1,C=0), gaussian-\/esque}}
\DoxyCodeLine{293     STBIR\_FILTER\_CATMULLROM   = 4,  \textcolor{comment}{// An interpolating cubic spline}}
\DoxyCodeLine{294     STBIR\_FILTER\_MITCHELL     = 5,  \textcolor{comment}{// Mitchell-\/Netrevalli filter with B=1/3, C=1/3}}
\DoxyCodeLine{295 \} stbir\_filter;}
\DoxyCodeLine{296 }
\DoxyCodeLine{297 \textcolor{keyword}{typedef} \textcolor{keyword}{enum}}
\DoxyCodeLine{298 \{}
\DoxyCodeLine{299     STBIR\_COLORSPACE\_LINEAR,}
\DoxyCodeLine{300     STBIR\_COLORSPACE\_SRGB,}
\DoxyCodeLine{301 }
\DoxyCodeLine{302     STBIR\_MAX\_COLORSPACES,}
\DoxyCodeLine{303 \} stbir\_colorspace;}
\DoxyCodeLine{304 }
\DoxyCodeLine{305 \textcolor{comment}{// The following functions are all identical except for the type of the image data}}
\DoxyCodeLine{306 }
\DoxyCodeLine{307 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint8\_generic( \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{308                                                \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{309                                          \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{310                                          stbir\_edge edge\_wrap\_mode, stbir\_filter filter, stbir\_colorspace space,}
\DoxyCodeLine{311                                          \textcolor{keywordtype}{void} *alloc\_context);}
\DoxyCodeLine{312 }
\DoxyCodeLine{313 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint16\_generic(\textcolor{keyword}{const} stbir\_uint16 *input\_pixels  , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{314                                                stbir\_uint16 *output\_pixels , \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{315                                          \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{316                                          stbir\_edge edge\_wrap\_mode, stbir\_filter filter, stbir\_colorspace space,}
\DoxyCodeLine{317                                          \textcolor{keywordtype}{void} *alloc\_context);}
\DoxyCodeLine{318 }
\DoxyCodeLine{319 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_float\_generic( \textcolor{keyword}{const} \textcolor{keywordtype}{float} *input\_pixels         , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{320                                                \textcolor{keywordtype}{float} *output\_pixels        , \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{321                                          \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{322                                          stbir\_edge edge\_wrap\_mode, stbir\_filter filter, stbir\_colorspace space,}
\DoxyCodeLine{323                                          \textcolor{keywordtype}{void} *alloc\_context);}
\DoxyCodeLine{324 }
\DoxyCodeLine{325 }
\DoxyCodeLine{326 }
\DoxyCodeLine{328 \textcolor{comment}{//}}
\DoxyCodeLine{329 \textcolor{comment}{// Full-\/complexity API}}
\DoxyCodeLine{330 \textcolor{comment}{//}}
\DoxyCodeLine{331 \textcolor{comment}{// This extends the medium API as follows:}}
\DoxyCodeLine{332 \textcolor{comment}{//}}
\DoxyCodeLine{333 \textcolor{comment}{//       * uint32 image type}}
\DoxyCodeLine{334 \textcolor{comment}{//     * not typesafe}}
\DoxyCodeLine{335 \textcolor{comment}{//     * separate filter types for each axis}}
\DoxyCodeLine{336 \textcolor{comment}{//     * separate edge modes for each axis}}
\DoxyCodeLine{337 \textcolor{comment}{//     * can specify scale explicitly for subpixel correctness}}
\DoxyCodeLine{338 \textcolor{comment}{//     * can specify image source tile using texture coordinates}}
\DoxyCodeLine{339 }
\DoxyCodeLine{340 \textcolor{keyword}{typedef} \textcolor{keyword}{enum}}
\DoxyCodeLine{341 \{}
\DoxyCodeLine{342     STBIR\_TYPE\_UINT8 ,}
\DoxyCodeLine{343     STBIR\_TYPE\_UINT16,}
\DoxyCodeLine{344     STBIR\_TYPE\_UINT32,}
\DoxyCodeLine{345     STBIR\_TYPE\_FLOAT ,}
\DoxyCodeLine{346 }
\DoxyCodeLine{347     STBIR\_MAX\_TYPES}
\DoxyCodeLine{348 \} stbir\_datatype;}
\DoxyCodeLine{349 }
\DoxyCodeLine{350 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize(         \textcolor{keyword}{const} \textcolor{keywordtype}{void} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{351                                          \textcolor{keywordtype}{void} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{352                                    stbir\_datatype datatype,}
\DoxyCodeLine{353                                    \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{354                                    stbir\_edge edge\_mode\_horizontal, stbir\_edge edge\_mode\_vertical,}
\DoxyCodeLine{355                                    stbir\_filter filter\_horizontal,  stbir\_filter filter\_vertical,}
\DoxyCodeLine{356                                    stbir\_colorspace space, \textcolor{keywordtype}{void} *alloc\_context);}
\DoxyCodeLine{357 }
\DoxyCodeLine{358 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_subpixel(\textcolor{keyword}{const} \textcolor{keywordtype}{void} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{359                                          \textcolor{keywordtype}{void} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{360                                    stbir\_datatype datatype,}
\DoxyCodeLine{361                                    \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{362                                    stbir\_edge edge\_mode\_horizontal, stbir\_edge edge\_mode\_vertical,}
\DoxyCodeLine{363                                    stbir\_filter filter\_horizontal,  stbir\_filter filter\_vertical,}
\DoxyCodeLine{364                                    stbir\_colorspace space, \textcolor{keywordtype}{void} *alloc\_context,}
\DoxyCodeLine{365                                    \textcolor{keywordtype}{float} x\_scale, \textcolor{keywordtype}{float} y\_scale,}
\DoxyCodeLine{366                                    \textcolor{keywordtype}{float} x\_offset, \textcolor{keywordtype}{float} y\_offset);}
\DoxyCodeLine{367 }
\DoxyCodeLine{368 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_region(  \textcolor{keyword}{const} \textcolor{keywordtype}{void} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{369                                          \textcolor{keywordtype}{void} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{370                                    stbir\_datatype datatype,}
\DoxyCodeLine{371                                    \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{372                                    stbir\_edge edge\_mode\_horizontal, stbir\_edge edge\_mode\_vertical,}
\DoxyCodeLine{373                                    stbir\_filter filter\_horizontal,  stbir\_filter filter\_vertical,}
\DoxyCodeLine{374                                    stbir\_colorspace space, \textcolor{keywordtype}{void} *alloc\_context,}
\DoxyCodeLine{375                                    \textcolor{keywordtype}{float} s0, \textcolor{keywordtype}{float} t0, \textcolor{keywordtype}{float} s1, \textcolor{keywordtype}{float} t1);}
\DoxyCodeLine{376 \textcolor{comment}{// (s0, t0) \& (s1, t1) are the top-\/left and bottom right corner (uv addressing style: [0, 1]x[0, 1]) of a region of the input image to use.}}
\DoxyCodeLine{377 }
\DoxyCodeLine{378 \textcolor{comment}{//}}
\DoxyCodeLine{379 \textcolor{comment}{//}}
\DoxyCodeLine{381 \textcolor{comment}{}\textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBIR\_INCLUDE\_STB\_IMAGE\_RESIZE\_H}}
\DoxyCodeLine{382 }
\DoxyCodeLine{383 }
\DoxyCodeLine{384 }
\DoxyCodeLine{385 }
\DoxyCodeLine{386 }
\DoxyCodeLine{387 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_RESIZE\_IMPLEMENTATION}}
\DoxyCodeLine{388 }
\DoxyCodeLine{389 \textcolor{preprocessor}{\#ifndef STBIR\_ASSERT}}
\DoxyCodeLine{390 \textcolor{preprocessor}{\#include <assert.h>}}
\DoxyCodeLine{391 \textcolor{preprocessor}{\#define STBIR\_ASSERT(x) assert(x)}}
\DoxyCodeLine{392 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{393 }
\DoxyCodeLine{394 \textcolor{comment}{// For memset}}
\DoxyCodeLine{395 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{396 }
\DoxyCodeLine{397 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{398 }
\DoxyCodeLine{399 \textcolor{preprocessor}{\#ifndef STBIR\_MALLOC}}
\DoxyCodeLine{400 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{401 \textcolor{comment}{// use comma operator to evaluate c, to avoid "{}unused parameter"{} warnings}}
\DoxyCodeLine{402 \textcolor{preprocessor}{\#define STBIR\_MALLOC(size,c) ((void)(c), malloc(size))}}
\DoxyCodeLine{403 \textcolor{preprocessor}{\#define STBIR\_FREE(ptr,c)    ((void)(c), free(ptr))}}
\DoxyCodeLine{404 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{405 }
\DoxyCodeLine{406 \textcolor{preprocessor}{\#ifndef \_MSC\_VER}}
\DoxyCodeLine{407 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{408 \textcolor{preprocessor}{\#define stbir\_\_inline inline}}
\DoxyCodeLine{409 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{410 \textcolor{preprocessor}{\#define stbir\_\_inline}}
\DoxyCodeLine{411 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{412 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{413 \textcolor{preprocessor}{\#define stbir\_\_inline \_\_forceinline}}
\DoxyCodeLine{414 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{415 }
\DoxyCodeLine{416 }
\DoxyCodeLine{417 \textcolor{comment}{// should produce compiler error if size is wrong}}
\DoxyCodeLine{418 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} stbir\_\_validate\_uint32[\textcolor{keyword}{sizeof}(stbir\_uint32) == 4 ? 1 : -\/1];}
\DoxyCodeLine{419 }
\DoxyCodeLine{420 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{421 \textcolor{preprocessor}{\#define STBIR\_\_NOTUSED(v)  (void)(v)}}
\DoxyCodeLine{422 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{423 \textcolor{preprocessor}{\#define STBIR\_\_NOTUSED(v)  (void)sizeof(v)}}
\DoxyCodeLine{424 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{425 }
\DoxyCodeLine{426 \textcolor{preprocessor}{\#define STBIR\_\_ARRAY\_SIZE(a) (sizeof((a))/sizeof((a)[0]))}}
\DoxyCodeLine{427 }
\DoxyCodeLine{428 \textcolor{preprocessor}{\#ifndef STBIR\_DEFAULT\_FILTER\_UPSAMPLE}}
\DoxyCodeLine{429 \textcolor{preprocessor}{\#define STBIR\_DEFAULT\_FILTER\_UPSAMPLE    STBIR\_FILTER\_CATMULLROM}}
\DoxyCodeLine{430 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{431 }
\DoxyCodeLine{432 \textcolor{preprocessor}{\#ifndef STBIR\_DEFAULT\_FILTER\_DOWNSAMPLE}}
\DoxyCodeLine{433 \textcolor{preprocessor}{\#define STBIR\_DEFAULT\_FILTER\_DOWNSAMPLE  STBIR\_FILTER\_MITCHELL}}
\DoxyCodeLine{434 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{435 }
\DoxyCodeLine{436 \textcolor{preprocessor}{\#ifndef STBIR\_PROGRESS\_REPORT}}
\DoxyCodeLine{437 \textcolor{preprocessor}{\#define STBIR\_PROGRESS\_REPORT(float\_0\_to\_1)}}
\DoxyCodeLine{438 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{439 }
\DoxyCodeLine{440 \textcolor{preprocessor}{\#ifndef STBIR\_MAX\_CHANNELS}}
\DoxyCodeLine{441 \textcolor{preprocessor}{\#define STBIR\_MAX\_CHANNELS 64}}
\DoxyCodeLine{442 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{443 }
\DoxyCodeLine{444 \textcolor{preprocessor}{\#if STBIR\_MAX\_CHANNELS > 65536}}
\DoxyCodeLine{445 \textcolor{preprocessor}{\#error "{}Too many channels; STBIR\_MAX\_CHANNELS must be no more than 65536."{}}}
\DoxyCodeLine{446 \textcolor{comment}{// because we store the indices in 16-\/bit variables}}
\DoxyCodeLine{447 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{448 }
\DoxyCodeLine{449 \textcolor{comment}{// This value is added to alpha just before premultiplication to avoid}}
\DoxyCodeLine{450 \textcolor{comment}{// zeroing out color values. It is equivalent to 2\string^-\/80. If you don't want}}
\DoxyCodeLine{451 \textcolor{comment}{// that behavior (it may interfere if you have floating point images with}}
\DoxyCodeLine{452 \textcolor{comment}{// very small alpha values) then you can define STBIR\_NO\_ALPHA\_EPSILON to}}
\DoxyCodeLine{453 \textcolor{comment}{// disable it.}}
\DoxyCodeLine{454 \textcolor{preprocessor}{\#ifndef STBIR\_ALPHA\_EPSILON}}
\DoxyCodeLine{455 \textcolor{preprocessor}{\#define STBIR\_ALPHA\_EPSILON ((float)1 / (1 << 20) / (1 << 20) / (1 << 20) / (1 << 20))}}
\DoxyCodeLine{456 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{457 }
\DoxyCodeLine{458 }
\DoxyCodeLine{459 }
\DoxyCodeLine{460 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{461 \textcolor{preprocessor}{\#define STBIR\_\_UNUSED\_PARAM(v)  (void)(v)}}
\DoxyCodeLine{462 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{463 \textcolor{preprocessor}{\#define STBIR\_\_UNUSED\_PARAM(v)  (void)sizeof(v)}}
\DoxyCodeLine{464 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{465 }
\DoxyCodeLine{466 \textcolor{comment}{// must match stbir\_datatype}}
\DoxyCodeLine{467 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} stbir\_\_type\_size[] = \{}
\DoxyCodeLine{468     1, \textcolor{comment}{// STBIR\_TYPE\_UINT8}}
\DoxyCodeLine{469     2, \textcolor{comment}{// STBIR\_TYPE\_UINT16}}
\DoxyCodeLine{470     4, \textcolor{comment}{// STBIR\_TYPE\_UINT32}}
\DoxyCodeLine{471     4, \textcolor{comment}{// STBIR\_TYPE\_FLOAT}}
\DoxyCodeLine{472 \};}
\DoxyCodeLine{473 }
\DoxyCodeLine{474 \textcolor{comment}{// Kernel function centered at 0}}
\DoxyCodeLine{475 \textcolor{keyword}{typedef} float (stbir\_\_kernel\_fn)(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} scale);}
\DoxyCodeLine{476 \textcolor{keyword}{typedef} float (stbir\_\_support\_fn)(\textcolor{keywordtype}{float} scale);}
\DoxyCodeLine{477 }
\DoxyCodeLine{478 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{479 \{}
\DoxyCodeLine{480     stbir\_\_kernel\_fn* kernel;}
\DoxyCodeLine{481     stbir\_\_support\_fn* support;}
\DoxyCodeLine{482 \} stbir\_\_filter\_info;}
\DoxyCodeLine{483 }
\DoxyCodeLine{484 \textcolor{comment}{// When upsampling, the contributors are which source pixels contribute.}}
\DoxyCodeLine{485 \textcolor{comment}{// When downsampling, the contributors are which destination pixels are contributed to.}}
\DoxyCodeLine{486 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{487 \{}
\DoxyCodeLine{488     \textcolor{keywordtype}{int} n0; \textcolor{comment}{// First contributing pixel}}
\DoxyCodeLine{489     \textcolor{keywordtype}{int} n1; \textcolor{comment}{// Last contributing pixel}}
\DoxyCodeLine{490 \} stbir\_\_contributors;}
\DoxyCodeLine{491 }
\DoxyCodeLine{492 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{493 \{}
\DoxyCodeLine{494     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* input\_data;}
\DoxyCodeLine{495     \textcolor{keywordtype}{int} input\_w;}
\DoxyCodeLine{496     \textcolor{keywordtype}{int} input\_h;}
\DoxyCodeLine{497     \textcolor{keywordtype}{int} input\_stride\_bytes;}
\DoxyCodeLine{498 }
\DoxyCodeLine{499     \textcolor{keywordtype}{void}* output\_data;}
\DoxyCodeLine{500     \textcolor{keywordtype}{int} output\_w;}
\DoxyCodeLine{501     \textcolor{keywordtype}{int} output\_h;}
\DoxyCodeLine{502     \textcolor{keywordtype}{int} output\_stride\_bytes;}
\DoxyCodeLine{503 }
\DoxyCodeLine{504     \textcolor{keywordtype}{float} s0, t0, s1, t1;}
\DoxyCodeLine{505 }
\DoxyCodeLine{506     \textcolor{keywordtype}{float} horizontal\_shift; \textcolor{comment}{// Units: output pixels}}
\DoxyCodeLine{507     \textcolor{keywordtype}{float} vertical\_shift;   \textcolor{comment}{// Units: output pixels}}
\DoxyCodeLine{508     \textcolor{keywordtype}{float} horizontal\_scale;}
\DoxyCodeLine{509     \textcolor{keywordtype}{float} vertical\_scale;}
\DoxyCodeLine{510 }
\DoxyCodeLine{511     \textcolor{keywordtype}{int} channels;}
\DoxyCodeLine{512     \textcolor{keywordtype}{int} alpha\_channel;}
\DoxyCodeLine{513     stbir\_uint32 flags;}
\DoxyCodeLine{514     stbir\_datatype type;}
\DoxyCodeLine{515     stbir\_filter horizontal\_filter;}
\DoxyCodeLine{516     stbir\_filter vertical\_filter;}
\DoxyCodeLine{517     stbir\_edge edge\_horizontal;}
\DoxyCodeLine{518     stbir\_edge edge\_vertical;}
\DoxyCodeLine{519     stbir\_colorspace colorspace;}
\DoxyCodeLine{520 }
\DoxyCodeLine{521     stbir\_\_contributors* horizontal\_contributors;}
\DoxyCodeLine{522     \textcolor{keywordtype}{float}* horizontal\_coefficients;}
\DoxyCodeLine{523 }
\DoxyCodeLine{524     stbir\_\_contributors* vertical\_contributors;}
\DoxyCodeLine{525     \textcolor{keywordtype}{float}* vertical\_coefficients;}
\DoxyCodeLine{526 }
\DoxyCodeLine{527     \textcolor{keywordtype}{int} decode\_buffer\_pixels;}
\DoxyCodeLine{528     \textcolor{keywordtype}{float}* decode\_buffer;}
\DoxyCodeLine{529 }
\DoxyCodeLine{530     \textcolor{keywordtype}{float}* horizontal\_buffer;}
\DoxyCodeLine{531 }
\DoxyCodeLine{532     \textcolor{comment}{// cache these because ceil/floor are inexplicably showing up in profile}}
\DoxyCodeLine{533     \textcolor{keywordtype}{int} horizontal\_coefficient\_width;}
\DoxyCodeLine{534     \textcolor{keywordtype}{int} vertical\_coefficient\_width;}
\DoxyCodeLine{535     \textcolor{keywordtype}{int} horizontal\_filter\_pixel\_width;}
\DoxyCodeLine{536     \textcolor{keywordtype}{int} vertical\_filter\_pixel\_width;}
\DoxyCodeLine{537     \textcolor{keywordtype}{int} horizontal\_filter\_pixel\_margin;}
\DoxyCodeLine{538     \textcolor{keywordtype}{int} vertical\_filter\_pixel\_margin;}
\DoxyCodeLine{539     \textcolor{keywordtype}{int} horizontal\_num\_contributors;}
\DoxyCodeLine{540     \textcolor{keywordtype}{int} vertical\_num\_contributors;}
\DoxyCodeLine{541 }
\DoxyCodeLine{542     \textcolor{keywordtype}{int} ring\_buffer\_length\_bytes;   \textcolor{comment}{// The length of an individual entry in the ring buffer. The total number of ring buffers is stbir\_\_get\_filter\_pixel\_width(filter)}}
\DoxyCodeLine{543     \textcolor{keywordtype}{int} ring\_buffer\_num\_entries;    \textcolor{comment}{// Total number of entries in the ring buffer.}}
\DoxyCodeLine{544     \textcolor{keywordtype}{int} ring\_buffer\_first\_scanline;}
\DoxyCodeLine{545     \textcolor{keywordtype}{int} ring\_buffer\_last\_scanline;}
\DoxyCodeLine{546     \textcolor{keywordtype}{int} ring\_buffer\_begin\_index;    \textcolor{comment}{// first\_scanline is at this index in the ring buffer}}
\DoxyCodeLine{547     \textcolor{keywordtype}{float}* ring\_buffer;}
\DoxyCodeLine{548 }
\DoxyCodeLine{549     \textcolor{keywordtype}{float}* encode\_buffer; \textcolor{comment}{// A temporary buffer to store floats so we don't lose precision while we do multiply-\/adds.}}
\DoxyCodeLine{550 }
\DoxyCodeLine{551     \textcolor{keywordtype}{int} horizontal\_contributors\_size;}
\DoxyCodeLine{552     \textcolor{keywordtype}{int} horizontal\_coefficients\_size;}
\DoxyCodeLine{553     \textcolor{keywordtype}{int} vertical\_contributors\_size;}
\DoxyCodeLine{554     \textcolor{keywordtype}{int} vertical\_coefficients\_size;}
\DoxyCodeLine{555     \textcolor{keywordtype}{int} decode\_buffer\_size;}
\DoxyCodeLine{556     \textcolor{keywordtype}{int} horizontal\_buffer\_size;}
\DoxyCodeLine{557     \textcolor{keywordtype}{int} ring\_buffer\_size;}
\DoxyCodeLine{558     \textcolor{keywordtype}{int} encode\_buffer\_size;}
\DoxyCodeLine{559 \} stbir\_\_info;}
\DoxyCodeLine{560 }
\DoxyCodeLine{561 }
\DoxyCodeLine{562 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} stbir\_\_max\_uint8\_as\_float  = 255.0f;}
\DoxyCodeLine{563 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} stbir\_\_max\_uint16\_as\_float = 65535.0f;}
\DoxyCodeLine{564 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} stbir\_\_max\_uint32\_as\_float = 4294967295.0;}
\DoxyCodeLine{565 }
\DoxyCodeLine{566 }
\DoxyCodeLine{567 \textcolor{keyword}{static} stbir\_\_inline \textcolor{keywordtype}{int} stbir\_\_min(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b)}
\DoxyCodeLine{568 \{}
\DoxyCodeLine{569     \textcolor{keywordflow}{return} a < b ? a : b;}
\DoxyCodeLine{570 \}}
\DoxyCodeLine{571 }
\DoxyCodeLine{572 \textcolor{keyword}{static} stbir\_\_inline \textcolor{keywordtype}{float} stbir\_\_saturate(\textcolor{keywordtype}{float} x)}
\DoxyCodeLine{573 \{}
\DoxyCodeLine{574     \textcolor{keywordflow}{if} (x < 0)}
\DoxyCodeLine{575         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{576 }
\DoxyCodeLine{577     \textcolor{keywordflow}{if} (x > 1)}
\DoxyCodeLine{578         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{579 }
\DoxyCodeLine{580     \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{581 \}}
\DoxyCodeLine{582 }
\DoxyCodeLine{583 \textcolor{preprocessor}{\#ifdef STBIR\_SATURATE\_INT}}
\DoxyCodeLine{584 \textcolor{keyword}{static} stbir\_\_inline stbir\_uint8 stbir\_\_saturate8(\textcolor{keywordtype}{int} x)}
\DoxyCodeLine{585 \{}
\DoxyCodeLine{586     \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}) x <= 255)}
\DoxyCodeLine{587         \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{588 }
\DoxyCodeLine{589     \textcolor{keywordflow}{if} (x < 0)}
\DoxyCodeLine{590         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{591 }
\DoxyCodeLine{592     \textcolor{keywordflow}{return} 255;}
\DoxyCodeLine{593 \}}
\DoxyCodeLine{594 }
\DoxyCodeLine{595 \textcolor{keyword}{static} stbir\_\_inline stbir\_uint16 stbir\_\_saturate16(\textcolor{keywordtype}{int} x)}
\DoxyCodeLine{596 \{}
\DoxyCodeLine{597     \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}) x <= 65535)}
\DoxyCodeLine{598         \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{599 }
\DoxyCodeLine{600     \textcolor{keywordflow}{if} (x < 0)}
\DoxyCodeLine{601         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{602 }
\DoxyCodeLine{603     \textcolor{keywordflow}{return} 65535;}
\DoxyCodeLine{604 \}}
\DoxyCodeLine{605 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{606 }
\DoxyCodeLine{607 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_srgb\_uchar\_to\_linear\_float[256] = \{}
\DoxyCodeLine{608     0.000000f, 0.000304f, 0.000607f, 0.000911f, 0.001214f, 0.001518f, 0.001821f, 0.002125f, 0.002428f, 0.002732f, 0.003035f,}
\DoxyCodeLine{609     0.003347f, 0.003677f, 0.004025f, 0.004391f, 0.004777f, 0.005182f, 0.005605f, 0.006049f, 0.006512f, 0.006995f, 0.007499f,}
\DoxyCodeLine{610     0.008023f, 0.008568f, 0.009134f, 0.009721f, 0.010330f, 0.010960f, 0.011612f, 0.012286f, 0.012983f, 0.013702f, 0.014444f,}
\DoxyCodeLine{611     0.015209f, 0.015996f, 0.016807f, 0.017642f, 0.018500f, 0.019382f, 0.020289f, 0.021219f, 0.022174f, 0.023153f, 0.024158f,}
\DoxyCodeLine{612     0.025187f, 0.026241f, 0.027321f, 0.028426f, 0.029557f, 0.030713f, 0.031896f, 0.033105f, 0.034340f, 0.035601f, 0.036889f,}
\DoxyCodeLine{613     0.038204f, 0.039546f, 0.040915f, 0.042311f, 0.043735f, 0.045186f, 0.046665f, 0.048172f, 0.049707f, 0.051269f, 0.052861f,}
\DoxyCodeLine{614     0.054480f, 0.056128f, 0.057805f, 0.059511f, 0.061246f, 0.063010f, 0.064803f, 0.066626f, 0.068478f, 0.070360f, 0.072272f,}
\DoxyCodeLine{615     0.074214f, 0.076185f, 0.078187f, 0.080220f, 0.082283f, 0.084376f, 0.086500f, 0.088656f, 0.090842f, 0.093059f, 0.095307f,}
\DoxyCodeLine{616     0.097587f, 0.099899f, 0.102242f, 0.104616f, 0.107023f, 0.109462f, 0.111932f, 0.114435f, 0.116971f, 0.119538f, 0.122139f,}
\DoxyCodeLine{617     0.124772f, 0.127438f, 0.130136f, 0.132868f, 0.135633f, 0.138432f, 0.141263f, 0.144128f, 0.147027f, 0.149960f, 0.152926f,}
\DoxyCodeLine{618     0.155926f, 0.158961f, 0.162029f, 0.165132f, 0.168269f, 0.171441f, 0.174647f, 0.177888f, 0.181164f, 0.184475f, 0.187821f,}
\DoxyCodeLine{619     0.191202f, 0.194618f, 0.198069f, 0.201556f, 0.205079f, 0.208637f, 0.212231f, 0.215861f, 0.219526f, 0.223228f, 0.226966f,}
\DoxyCodeLine{620     0.230740f, 0.234551f, 0.238398f, 0.242281f, 0.246201f, 0.250158f, 0.254152f, 0.258183f, 0.262251f, 0.266356f, 0.270498f,}
\DoxyCodeLine{621     0.274677f, 0.278894f, 0.283149f, 0.287441f, 0.291771f, 0.296138f, 0.300544f, 0.304987f, 0.309469f, 0.313989f, 0.318547f,}
\DoxyCodeLine{622     0.323143f, 0.327778f, 0.332452f, 0.337164f, 0.341914f, 0.346704f, 0.351533f, 0.356400f, 0.361307f, 0.366253f, 0.371238f,}
\DoxyCodeLine{623     0.376262f, 0.381326f, 0.386430f, 0.391573f, 0.396755f, 0.401978f, 0.407240f, 0.412543f, 0.417885f, 0.423268f, 0.428691f,}
\DoxyCodeLine{624     0.434154f, 0.439657f, 0.445201f, 0.450786f, 0.456411f, 0.462077f, 0.467784f, 0.473532f, 0.479320f, 0.485150f, 0.491021f,}
\DoxyCodeLine{625     0.496933f, 0.502887f, 0.508881f, 0.514918f, 0.520996f, 0.527115f, 0.533276f, 0.539480f, 0.545725f, 0.552011f, 0.558340f,}
\DoxyCodeLine{626     0.564712f, 0.571125f, 0.577581f, 0.584078f, 0.590619f, 0.597202f, 0.603827f, 0.610496f, 0.617207f, 0.623960f, 0.630757f,}
\DoxyCodeLine{627     0.637597f, 0.644480f, 0.651406f, 0.658375f, 0.665387f, 0.672443f, 0.679543f, 0.686685f, 0.693872f, 0.701102f, 0.708376f,}
\DoxyCodeLine{628     0.715694f, 0.723055f, 0.730461f, 0.737911f, 0.745404f, 0.752942f, 0.760525f, 0.768151f, 0.775822f, 0.783538f, 0.791298f,}
\DoxyCodeLine{629     0.799103f, 0.806952f, 0.814847f, 0.822786f, 0.830770f, 0.838799f, 0.846873f, 0.854993f, 0.863157f, 0.871367f, 0.879622f,}
\DoxyCodeLine{630     0.887923f, 0.896269f, 0.904661f, 0.913099f, 0.921582f, 0.930111f, 0.938686f, 0.947307f, 0.955974f, 0.964686f, 0.973445f,}
\DoxyCodeLine{631     0.982251f, 0.991102f, 1.0f}
\DoxyCodeLine{632 \};}
\DoxyCodeLine{633 }
\DoxyCodeLine{634 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_srgb\_to\_linear(\textcolor{keywordtype}{float} f)}
\DoxyCodeLine{635 \{}
\DoxyCodeLine{636     \textcolor{keywordflow}{if} (f <= 0.04045f)}
\DoxyCodeLine{637         \textcolor{keywordflow}{return} f / 12.92f;}
\DoxyCodeLine{638     \textcolor{keywordflow}{else}}
\DoxyCodeLine{639         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{float})pow((f + 0.055f) / 1.055f, 2.4f);}
\DoxyCodeLine{640 \}}
\DoxyCodeLine{641 }
\DoxyCodeLine{642 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_linear\_to\_srgb(\textcolor{keywordtype}{float} f)}
\DoxyCodeLine{643 \{}
\DoxyCodeLine{644     \textcolor{keywordflow}{if} (f <= 0.0031308f)}
\DoxyCodeLine{645         \textcolor{keywordflow}{return} f * 12.92f;}
\DoxyCodeLine{646     \textcolor{keywordflow}{else}}
\DoxyCodeLine{647         \textcolor{keywordflow}{return} 1.055f * (float)pow(f, 1 / 2.4f) -\/ 0.055f;}
\DoxyCodeLine{648 \}}
\DoxyCodeLine{649 }
\DoxyCodeLine{650 \textcolor{preprocessor}{\#ifndef STBIR\_NON\_IEEE\_FLOAT}}
\DoxyCodeLine{651 \textcolor{comment}{// From https://gist.github.com/rygorous/2203834}}
\DoxyCodeLine{652 }
\DoxyCodeLine{653 \textcolor{keyword}{typedef} \textcolor{keyword}{union}}
\DoxyCodeLine{654 \{}
\DoxyCodeLine{655     stbir\_uint32 u;}
\DoxyCodeLine{656     \textcolor{keywordtype}{float} f;}
\DoxyCodeLine{657 \} stbir\_\_FP32;}
\DoxyCodeLine{658 }
\DoxyCodeLine{659 \textcolor{keyword}{static} \textcolor{keyword}{const} stbir\_uint32 fp32\_to\_srgb8\_tab4[104] = \{}
\DoxyCodeLine{660     0x0073000d, 0x007a000d, 0x0080000d, 0x0087000d, 0x008d000d, 0x0094000d, 0x009a000d, 0x00a1000d,}
\DoxyCodeLine{661     0x00a7001a, 0x00b4001a, 0x00c1001a, 0x00ce001a, 0x00da001a, 0x00e7001a, 0x00f4001a, 0x0101001a,}
\DoxyCodeLine{662     0x010e0033, 0x01280033, 0x01410033, 0x015b0033, 0x01750033, 0x018f0033, 0x01a80033, 0x01c20033,}
\DoxyCodeLine{663     0x01dc0067, 0x020f0067, 0x02430067, 0x02760067, 0x02aa0067, 0x02dd0067, 0x03110067, 0x03440067,}
\DoxyCodeLine{664     0x037800ce, 0x03df00ce, 0x044600ce, 0x04ad00ce, 0x051400ce, 0x057b00c5, 0x05dd00bc, 0x063b00b5,}
\DoxyCodeLine{665     0x06970158, 0x07420142, 0x07e30130, 0x087b0120, 0x090b0112, 0x09940106, 0x0a1700fc, 0x0a9500f2,}
\DoxyCodeLine{666     0x0b0f01cb, 0x0bf401ae, 0x0ccb0195, 0x0d950180, 0x0e56016e, 0x0f0d015e, 0x0fbc0150, 0x10630143,}
\DoxyCodeLine{667     0x11070264, 0x1238023e, 0x1357021d, 0x14660201, 0x156601e9, 0x165a01d3, 0x174401c0, 0x182401af,}
\DoxyCodeLine{668     0x18fe0331, 0x1a9602fe, 0x1c1502d2, 0x1d7e02ad, 0x1ed4028d, 0x201a0270, 0x21520256, 0x227d0240,}
\DoxyCodeLine{669     0x239f0443, 0x25c003fe, 0x27bf03c4, 0x29a10392, 0x2b6a0367, 0x2d1d0341, 0x2ebe031f, 0x304d0300,}
\DoxyCodeLine{670     0x31d105b0, 0x34a80555, 0x37520507, 0x39d504c5, 0x3c37048b, 0x3e7c0458, 0x40a8042a, 0x42bd0401,}
\DoxyCodeLine{671     0x44c20798, 0x488e071e, 0x4c1c06b6, 0x4f76065d, 0x52a50610, 0x55ac05cc, 0x5892058f, 0x5b590559,}
\DoxyCodeLine{672     0x5e0c0a23, 0x631c0980, 0x67db08f6, 0x6c55087f, 0x70940818, 0x74a007bd, 0x787d076c, 0x7c330723,}
\DoxyCodeLine{673 \};}
\DoxyCodeLine{674 }
\DoxyCodeLine{675 \textcolor{keyword}{static} stbir\_uint8 stbir\_\_linear\_to\_srgb\_uchar(\textcolor{keywordtype}{float} in)}
\DoxyCodeLine{676 \{}
\DoxyCodeLine{677     \textcolor{keyword}{static} \textcolor{keyword}{const} stbir\_\_FP32 almostone = \{ 0x3f7fffff \}; \textcolor{comment}{// 1-\/eps}}
\DoxyCodeLine{678     \textcolor{keyword}{static} \textcolor{keyword}{const} stbir\_\_FP32 minval = \{ (127-\/13) << 23 \};}
\DoxyCodeLine{679     stbir\_uint32 tab,bias,scale,t;}
\DoxyCodeLine{680     stbir\_\_FP32 f;}
\DoxyCodeLine{681 }
\DoxyCodeLine{682     \textcolor{comment}{// Clamp to [2\string^(-\/13), 1-\/eps]; these two values map to 0 and 1, respectively.}}
\DoxyCodeLine{683     \textcolor{comment}{// The tests are carefully written so that NaNs map to 0, same as in the reference}}
\DoxyCodeLine{684     \textcolor{comment}{// implementation.}}
\DoxyCodeLine{685     \textcolor{keywordflow}{if} (!(in > minval.f)) \textcolor{comment}{// written this way to catch NaNs}}
\DoxyCodeLine{686         in = minval.f;}
\DoxyCodeLine{687     if (in > almostone.f)}
\DoxyCodeLine{688         in = almostone.f;}
\DoxyCodeLine{689 }
\DoxyCodeLine{690     \textcolor{comment}{// Do the table lookup and unpack bias, scale}}
\DoxyCodeLine{691     f.f = in;}
\DoxyCodeLine{692     tab = fp32\_to\_srgb8\_tab4[(f.u -\/ minval.u) >> 20];}
\DoxyCodeLine{693     bias = (tab >> 16) << 9;}
\DoxyCodeLine{694     scale = tab \& 0xffff;}
\DoxyCodeLine{695 }
\DoxyCodeLine{696     \textcolor{comment}{// Grab next-\/highest mantissa bits and perform linear interpolation}}
\DoxyCodeLine{697     t = (f.u >> 12) \& 0xff;}
\DoxyCodeLine{698     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}) ((bias + scale*t) >> 16);}
\DoxyCodeLine{699 \}}
\DoxyCodeLine{700 }
\DoxyCodeLine{701 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{702 \textcolor{comment}{// sRGB transition values, scaled by 1<<28}}
\DoxyCodeLine{703 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_srgb\_offset\_to\_linear\_scaled[256] =}
\DoxyCodeLine{704 \{}
\DoxyCodeLine{705             0,     40738,    122216,    203693,    285170,    366648,    448125,    529603,}
\DoxyCodeLine{706        611080,    692557,    774035,    855852,    942009,   1033024,   1128971,   1229926,}
\DoxyCodeLine{707       1335959,   1447142,   1563542,   1685229,   1812268,   1944725,   2082664,   2226148,}
\DoxyCodeLine{708       2375238,   2529996,   2690481,   2856753,   3028870,   3206888,   3390865,   3580856,}
\DoxyCodeLine{709       3776916,   3979100,   4187460,   4402049,   4622919,   4850123,   5083710,   5323731,}
\DoxyCodeLine{710       5570236,   5823273,   6082892,   6349140,   6622065,   6901714,   7188133,   7481369,}
\DoxyCodeLine{711       7781466,   8088471,   8402427,   8723380,   9051372,   9386448,   9728650,  10078021,}
\DoxyCodeLine{712      10434603,  10798439,  11169569,  11548036,  11933879,  12327139,  12727857,  13136073,}
\DoxyCodeLine{713      13551826,  13975156,  14406100,  14844697,  15290987,  15745007,  16206795,  16676389,}
\DoxyCodeLine{714      17153826,  17639142,  18132374,  18633560,  19142734,  19659934,  20185196,  20718552,}
\DoxyCodeLine{715      21260042,  21809696,  22367554,  22933648,  23508010,  24090680,  24681686,  25281066,}
\DoxyCodeLine{716      25888850,  26505076,  27129772,  27762974,  28404716,  29055026,  29713942,  30381490,}
\DoxyCodeLine{717      31057708,  31742624,  32436272,  33138682,  33849884,  34569912,  35298800,  36036568,}
\DoxyCodeLine{718      36783260,  37538896,  38303512,  39077136,  39859796,  40651528,  41452360,  42262316,}
\DoxyCodeLine{719      43081432,  43909732,  44747252,  45594016,  46450052,  47315392,  48190064,  49074096,}
\DoxyCodeLine{720      49967516,  50870356,  51782636,  52704392,  53635648,  54576432,  55526772,  56486700,}
\DoxyCodeLine{721      57456236,  58435408,  59424248,  60422780,  61431036,  62449032,  63476804,  64514376,}
\DoxyCodeLine{722      65561776,  66619028,  67686160,  68763192,  69850160,  70947088,  72053992,  73170912,}
\DoxyCodeLine{723      74297864,  75434880,  76581976,  77739184,  78906536,  80084040,  81271736,  82469648,}
\DoxyCodeLine{724      83677792,  84896192,  86124888,  87363888,  88613232,  89872928,  91143016,  92423512,}
\DoxyCodeLine{725      93714432,  95015816,  96327688,  97650056,  98982952, 100326408, 101680440, 103045072,}
\DoxyCodeLine{726     104420320, 105806224, 107202800, 108610064, 110028048, 111456776, 112896264, 114346544,}
\DoxyCodeLine{727     115807632, 117279552, 118762328, 120255976, 121760536, 123276016, 124802440, 126339832,}
\DoxyCodeLine{728     127888216, 129447616, 131018048, 132599544, 134192112, 135795792, 137410592, 139036528,}
\DoxyCodeLine{729     140673648, 142321952, 143981456, 145652208, 147334208, 149027488, 150732064, 152447968,}
\DoxyCodeLine{730     154175200, 155913792, 157663776, 159425168, 161197984, 162982240, 164777968, 166585184,}
\DoxyCodeLine{731     168403904, 170234160, 172075968, 173929344, 175794320, 177670896, 179559120, 181458992,}
\DoxyCodeLine{732     183370528, 185293776, 187228736, 189175424, 191133888, 193104112, 195086128, 197079968,}
\DoxyCodeLine{733     199085648, 201103184, 203132592, 205173888, 207227120, 209292272, 211369392, 213458480,}
\DoxyCodeLine{734     215559568, 217672656, 219797792, 221934976, 224084240, 226245600, 228419056, 230604656,}
\DoxyCodeLine{735     232802400, 235012320, 237234432, 239468736, 241715280, 243974080, 246245120, 248528464,}
\DoxyCodeLine{736     250824112, 253132064, 255452368, 257785040, 260130080, 262487520, 264857376, 267239664,}
\DoxyCodeLine{737 \};}
\DoxyCodeLine{738 }
\DoxyCodeLine{739 \textcolor{keyword}{static} stbir\_uint8 stbir\_\_linear\_to\_srgb\_uchar(\textcolor{keywordtype}{float} f)}
\DoxyCodeLine{740 \{}
\DoxyCodeLine{741     \textcolor{keywordtype}{int} x = (int) (f * (1 << 28)); \textcolor{comment}{// has headroom so you don't need to clamp}}
\DoxyCodeLine{742     \textcolor{keywordtype}{int} v = 0;}
\DoxyCodeLine{743     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{744 }
\DoxyCodeLine{745     \textcolor{comment}{// Refine the guess with a short binary search.}}
\DoxyCodeLine{746     i = v + 128; \textcolor{keywordflow}{if} (x >= stbir\_\_srgb\_offset\_to\_linear\_scaled[i]) v = i;}
\DoxyCodeLine{747     i = v +  64; \textcolor{keywordflow}{if} (x >= stbir\_\_srgb\_offset\_to\_linear\_scaled[i]) v = i;}
\DoxyCodeLine{748     i = v +  32; \textcolor{keywordflow}{if} (x >= stbir\_\_srgb\_offset\_to\_linear\_scaled[i]) v = i;}
\DoxyCodeLine{749     i = v +  16; \textcolor{keywordflow}{if} (x >= stbir\_\_srgb\_offset\_to\_linear\_scaled[i]) v = i;}
\DoxyCodeLine{750     i = v +   8; \textcolor{keywordflow}{if} (x >= stbir\_\_srgb\_offset\_to\_linear\_scaled[i]) v = i;}
\DoxyCodeLine{751     i = v +   4; \textcolor{keywordflow}{if} (x >= stbir\_\_srgb\_offset\_to\_linear\_scaled[i]) v = i;}
\DoxyCodeLine{752     i = v +   2; \textcolor{keywordflow}{if} (x >= stbir\_\_srgb\_offset\_to\_linear\_scaled[i]) v = i;}
\DoxyCodeLine{753     i = v +   1; \textcolor{keywordflow}{if} (x >= stbir\_\_srgb\_offset\_to\_linear\_scaled[i]) v = i;}
\DoxyCodeLine{754 }
\DoxyCodeLine{755     \textcolor{keywordflow}{return} (stbir\_uint8) v;}
\DoxyCodeLine{756 \}}
\DoxyCodeLine{757 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{758 }
\DoxyCodeLine{759 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_filter\_trapezoid(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{760 \{}
\DoxyCodeLine{761     \textcolor{keywordtype}{float} halfscale = scale / 2;}
\DoxyCodeLine{762     \textcolor{keywordtype}{float} t = 0.5f + halfscale;}
\DoxyCodeLine{763     STBIR\_ASSERT(scale <= 1);}
\DoxyCodeLine{764 }
\DoxyCodeLine{765     x = (float)fabs(x);}
\DoxyCodeLine{766 }
\DoxyCodeLine{767     \textcolor{keywordflow}{if} (x >= t)}
\DoxyCodeLine{768         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{769     \textcolor{keywordflow}{else}}
\DoxyCodeLine{770     \{}
\DoxyCodeLine{771         \textcolor{keywordtype}{float} r = 0.5f -\/ halfscale;}
\DoxyCodeLine{772         \textcolor{keywordflow}{if} (x <= r)}
\DoxyCodeLine{773             \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{774         \textcolor{keywordflow}{else}}
\DoxyCodeLine{775             \textcolor{keywordflow}{return} (t -\/ x) / scale;}
\DoxyCodeLine{776     \}}
\DoxyCodeLine{777 \}}
\DoxyCodeLine{778 }
\DoxyCodeLine{779 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_support\_trapezoid(\textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{780 \{}
\DoxyCodeLine{781     STBIR\_ASSERT(scale <= 1);}
\DoxyCodeLine{782     \textcolor{keywordflow}{return} 0.5f + scale / 2;}
\DoxyCodeLine{783 \}}
\DoxyCodeLine{784 }
\DoxyCodeLine{785 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_filter\_triangle(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} s)}
\DoxyCodeLine{786 \{}
\DoxyCodeLine{787     STBIR\_\_UNUSED\_PARAM(s);}
\DoxyCodeLine{788 }
\DoxyCodeLine{789     x = (float)fabs(x);}
\DoxyCodeLine{790 }
\DoxyCodeLine{791     \textcolor{keywordflow}{if} (x <= 1.0f)}
\DoxyCodeLine{792         \textcolor{keywordflow}{return} 1 -\/ x;}
\DoxyCodeLine{793     \textcolor{keywordflow}{else}}
\DoxyCodeLine{794         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{795 \}}
\DoxyCodeLine{796 }
\DoxyCodeLine{797 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_filter\_cubic(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} s)}
\DoxyCodeLine{798 \{}
\DoxyCodeLine{799     STBIR\_\_UNUSED\_PARAM(s);}
\DoxyCodeLine{800 }
\DoxyCodeLine{801     x = (float)fabs(x);}
\DoxyCodeLine{802 }
\DoxyCodeLine{803     \textcolor{keywordflow}{if} (x < 1.0f)}
\DoxyCodeLine{804         \textcolor{keywordflow}{return} (4 + x*x*(3*x -\/ 6))/6;}
\DoxyCodeLine{805     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x < 2.0f)}
\DoxyCodeLine{806         \textcolor{keywordflow}{return} (8 + x*(-\/12 + x*(6 -\/ x)))/6;}
\DoxyCodeLine{807 }
\DoxyCodeLine{808     \textcolor{keywordflow}{return} (0.0f);}
\DoxyCodeLine{809 \}}
\DoxyCodeLine{810 }
\DoxyCodeLine{811 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_filter\_catmullrom(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} s)}
\DoxyCodeLine{812 \{}
\DoxyCodeLine{813     STBIR\_\_UNUSED\_PARAM(s);}
\DoxyCodeLine{814 }
\DoxyCodeLine{815     x = (float)fabs(x);}
\DoxyCodeLine{816 }
\DoxyCodeLine{817     \textcolor{keywordflow}{if} (x < 1.0f)}
\DoxyCodeLine{818         \textcolor{keywordflow}{return} 1 -\/ x*x*(2.5f -\/ 1.5f*x);}
\DoxyCodeLine{819     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x < 2.0f)}
\DoxyCodeLine{820         \textcolor{keywordflow}{return} 2 -\/ x*(4 + x*(0.5f*x -\/ 2.5f));}
\DoxyCodeLine{821 }
\DoxyCodeLine{822     \textcolor{keywordflow}{return} (0.0f);}
\DoxyCodeLine{823 \}}
\DoxyCodeLine{824 }
\DoxyCodeLine{825 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_filter\_mitchell(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} s)}
\DoxyCodeLine{826 \{}
\DoxyCodeLine{827     STBIR\_\_UNUSED\_PARAM(s);}
\DoxyCodeLine{828 }
\DoxyCodeLine{829     x = (float)fabs(x);}
\DoxyCodeLine{830 }
\DoxyCodeLine{831     \textcolor{keywordflow}{if} (x < 1.0f)}
\DoxyCodeLine{832         \textcolor{keywordflow}{return} (16 + x*x*(21 * x -\/ 36))/18;}
\DoxyCodeLine{833     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x < 2.0f)}
\DoxyCodeLine{834         \textcolor{keywordflow}{return} (32 + x*(-\/60 + x*(36 -\/ 7*x)))/18;}
\DoxyCodeLine{835 }
\DoxyCodeLine{836     \textcolor{keywordflow}{return} (0.0f);}
\DoxyCodeLine{837 \}}
\DoxyCodeLine{838 }
\DoxyCodeLine{839 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_support\_zero(\textcolor{keywordtype}{float} s)}
\DoxyCodeLine{840 \{}
\DoxyCodeLine{841     STBIR\_\_UNUSED\_PARAM(s);}
\DoxyCodeLine{842     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{843 \}}
\DoxyCodeLine{844 }
\DoxyCodeLine{845 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_support\_one(\textcolor{keywordtype}{float} s)}
\DoxyCodeLine{846 \{}
\DoxyCodeLine{847     STBIR\_\_UNUSED\_PARAM(s);}
\DoxyCodeLine{848     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{849 \}}
\DoxyCodeLine{850 }
\DoxyCodeLine{851 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbir\_\_support\_two(\textcolor{keywordtype}{float} s)}
\DoxyCodeLine{852 \{}
\DoxyCodeLine{853     STBIR\_\_UNUSED\_PARAM(s);}
\DoxyCodeLine{854     \textcolor{keywordflow}{return} 2;}
\DoxyCodeLine{855 \}}
\DoxyCodeLine{856 }
\DoxyCodeLine{857 \textcolor{keyword}{static} stbir\_\_filter\_info stbir\_\_filter\_info\_table[] = \{}
\DoxyCodeLine{858         \{ NULL,                     stbir\_\_support\_zero \},}
\DoxyCodeLine{859         \{ stbir\_\_filter\_trapezoid,  stbir\_\_support\_trapezoid \},}
\DoxyCodeLine{860         \{ stbir\_\_filter\_triangle,   stbir\_\_support\_one \},}
\DoxyCodeLine{861         \{ stbir\_\_filter\_cubic,      stbir\_\_support\_two \},}
\DoxyCodeLine{862         \{ stbir\_\_filter\_catmullrom, stbir\_\_support\_two \},}
\DoxyCodeLine{863         \{ stbir\_\_filter\_mitchell,   stbir\_\_support\_two \},}
\DoxyCodeLine{864 \};}
\DoxyCodeLine{865 }
\DoxyCodeLine{866 stbir\_\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_use\_upsampling(\textcolor{keywordtype}{float} ratio)}
\DoxyCodeLine{867 \{}
\DoxyCodeLine{868     \textcolor{keywordflow}{return} ratio > 1;}
\DoxyCodeLine{869 \}}
\DoxyCodeLine{870 }
\DoxyCodeLine{871 stbir\_\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_use\_width\_upsampling(stbir\_\_info* stbir\_info)}
\DoxyCodeLine{872 \{}
\DoxyCodeLine{873     \textcolor{keywordflow}{return} stbir\_\_use\_upsampling(stbir\_info-\/>horizontal\_scale);}
\DoxyCodeLine{874 \}}
\DoxyCodeLine{875 }
\DoxyCodeLine{876 stbir\_\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_use\_height\_upsampling(stbir\_\_info* stbir\_info)}
\DoxyCodeLine{877 \{}
\DoxyCodeLine{878     \textcolor{keywordflow}{return} stbir\_\_use\_upsampling(stbir\_info-\/>vertical\_scale);}
\DoxyCodeLine{879 \}}
\DoxyCodeLine{880 }
\DoxyCodeLine{881 \textcolor{comment}{// This is the maximum number of input samples that can affect an output sample}}
\DoxyCodeLine{882 \textcolor{comment}{// with the given filter}}
\DoxyCodeLine{883 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_get\_filter\_pixel\_width(stbir\_filter filter, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{884 \{}
\DoxyCodeLine{885     STBIR\_ASSERT(filter != 0);}
\DoxyCodeLine{886     STBIR\_ASSERT(filter < STBIR\_\_ARRAY\_SIZE(stbir\_\_filter\_info\_table));}
\DoxyCodeLine{887 }
\DoxyCodeLine{888     \textcolor{keywordflow}{if} (stbir\_\_use\_upsampling(scale))}
\DoxyCodeLine{889         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})ceil(stbir\_\_filter\_info\_table[filter].support(1/scale) * 2);}
\DoxyCodeLine{890     \textcolor{keywordflow}{else}}
\DoxyCodeLine{891         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})ceil(stbir\_\_filter\_info\_table[filter].support(scale) * 2 / scale);}
\DoxyCodeLine{892 \}}
\DoxyCodeLine{893 }
\DoxyCodeLine{894 \textcolor{comment}{// This is how much to expand buffers to account for filters seeking outside}}
\DoxyCodeLine{895 \textcolor{comment}{// the image boundaries.}}
\DoxyCodeLine{896 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_get\_filter\_pixel\_margin(stbir\_filter filter, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{897 \{}
\DoxyCodeLine{898     \textcolor{keywordflow}{return} stbir\_\_get\_filter\_pixel\_width(filter, scale) / 2;}
\DoxyCodeLine{899 \}}
\DoxyCodeLine{900 }
\DoxyCodeLine{901 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_get\_coefficient\_width(stbir\_filter filter, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{902 \{}
\DoxyCodeLine{903     \textcolor{keywordflow}{if} (stbir\_\_use\_upsampling(scale))}
\DoxyCodeLine{904         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})ceil(stbir\_\_filter\_info\_table[filter].support(1 / scale) * 2);}
\DoxyCodeLine{905     \textcolor{keywordflow}{else}}
\DoxyCodeLine{906         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})ceil(stbir\_\_filter\_info\_table[filter].support(scale) * 2);}
\DoxyCodeLine{907 \}}
\DoxyCodeLine{908 }
\DoxyCodeLine{909 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_get\_contributors(\textcolor{keywordtype}{float} scale, stbir\_filter filter, \textcolor{keywordtype}{int} input\_size, \textcolor{keywordtype}{int} output\_size)}
\DoxyCodeLine{910 \{}
\DoxyCodeLine{911     \textcolor{keywordflow}{if} (stbir\_\_use\_upsampling(scale))}
\DoxyCodeLine{912         \textcolor{keywordflow}{return} output\_size;}
\DoxyCodeLine{913     \textcolor{keywordflow}{else}}
\DoxyCodeLine{914         \textcolor{keywordflow}{return} (input\_size + stbir\_\_get\_filter\_pixel\_margin(filter, scale) * 2);}
\DoxyCodeLine{915 \}}
\DoxyCodeLine{916 }
\DoxyCodeLine{917 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_get\_total\_horizontal\_coefficients(stbir\_\_info* info)}
\DoxyCodeLine{918 \{}
\DoxyCodeLine{919     \textcolor{keywordflow}{return} info-\/>horizontal\_num\_contributors}
\DoxyCodeLine{920          * stbir\_\_get\_coefficient\_width      (info-\/>horizontal\_filter, info-\/>horizontal\_scale);}
\DoxyCodeLine{921 \}}
\DoxyCodeLine{922 }
\DoxyCodeLine{923 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_get\_total\_vertical\_coefficients(stbir\_\_info* info)}
\DoxyCodeLine{924 \{}
\DoxyCodeLine{925     \textcolor{keywordflow}{return} info-\/>vertical\_num\_contributors}
\DoxyCodeLine{926          * stbir\_\_get\_coefficient\_width      (info-\/>vertical\_filter, info-\/>vertical\_scale);}
\DoxyCodeLine{927 \}}
\DoxyCodeLine{928 }
\DoxyCodeLine{929 \textcolor{keyword}{static} stbir\_\_contributors* stbir\_\_get\_contributor(stbir\_\_contributors* contributors, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{930 \{}
\DoxyCodeLine{931     \textcolor{keywordflow}{return} \&contributors[n];}
\DoxyCodeLine{932 \}}
\DoxyCodeLine{933 }
\DoxyCodeLine{934 \textcolor{comment}{// For perf reasons this code is duplicated in stbir\_\_resample\_horizontal\_upsample/downsample,}}
\DoxyCodeLine{935 \textcolor{comment}{// if you change it here change it there too.}}
\DoxyCodeLine{936 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbir\_\_get\_coefficient(\textcolor{keywordtype}{float}* coefficients, stbir\_filter filter, \textcolor{keywordtype}{float} scale, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} c)}
\DoxyCodeLine{937 \{}
\DoxyCodeLine{938     \textcolor{keywordtype}{int} width = stbir\_\_get\_coefficient\_width(filter, scale);}
\DoxyCodeLine{939     \textcolor{keywordflow}{return} \&coefficients[width*n + c];}
\DoxyCodeLine{940 \}}
\DoxyCodeLine{941 }
\DoxyCodeLine{942 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_edge\_wrap\_slow(stbir\_edge edge, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} max)}
\DoxyCodeLine{943 \{}
\DoxyCodeLine{944     \textcolor{keywordflow}{switch} (edge)}
\DoxyCodeLine{945     \{}
\DoxyCodeLine{946     \textcolor{keywordflow}{case} STBIR\_EDGE\_ZERO:}
\DoxyCodeLine{947         \textcolor{keywordflow}{return} 0; \textcolor{comment}{// we'll decode the wrong pixel here, and then overwrite with 0s later}}
\DoxyCodeLine{948 }
\DoxyCodeLine{949     \textcolor{keywordflow}{case} STBIR\_EDGE\_CLAMP:}
\DoxyCodeLine{950         \textcolor{keywordflow}{if} (n < 0)}
\DoxyCodeLine{951             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{952 }
\DoxyCodeLine{953         \textcolor{keywordflow}{if} (n >= max)}
\DoxyCodeLine{954             \textcolor{keywordflow}{return} max -\/ 1;}
\DoxyCodeLine{955 }
\DoxyCodeLine{956         \textcolor{keywordflow}{return} n; \textcolor{comment}{// NOTREACHED}}
\DoxyCodeLine{957 }
\DoxyCodeLine{958     \textcolor{keywordflow}{case} STBIR\_EDGE\_REFLECT:}
\DoxyCodeLine{959     \{}
\DoxyCodeLine{960         \textcolor{keywordflow}{if} (n < 0)}
\DoxyCodeLine{961         \{}
\DoxyCodeLine{962             \textcolor{keywordflow}{if} (n < max)}
\DoxyCodeLine{963                 \textcolor{keywordflow}{return} -\/n;}
\DoxyCodeLine{964             \textcolor{keywordflow}{else}}
\DoxyCodeLine{965                 \textcolor{keywordflow}{return} max -\/ 1;}
\DoxyCodeLine{966         \}}
\DoxyCodeLine{967 }
\DoxyCodeLine{968         \textcolor{keywordflow}{if} (n >= max)}
\DoxyCodeLine{969         \{}
\DoxyCodeLine{970             \textcolor{keywordtype}{int} max2 = max * 2;}
\DoxyCodeLine{971             \textcolor{keywordflow}{if} (n >= max2)}
\DoxyCodeLine{972                 \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{973             \textcolor{keywordflow}{else}}
\DoxyCodeLine{974                 \textcolor{keywordflow}{return} max2 -\/ n -\/ 1;}
\DoxyCodeLine{975         \}}
\DoxyCodeLine{976 }
\DoxyCodeLine{977         \textcolor{keywordflow}{return} n; \textcolor{comment}{// NOTREACHED}}
\DoxyCodeLine{978     \}}
\DoxyCodeLine{979 }
\DoxyCodeLine{980     \textcolor{keywordflow}{case} STBIR\_EDGE\_WRAP:}
\DoxyCodeLine{981         \textcolor{keywordflow}{if} (n >= 0)}
\DoxyCodeLine{982             \textcolor{keywordflow}{return} (n \% max);}
\DoxyCodeLine{983         \textcolor{keywordflow}{else}}
\DoxyCodeLine{984         \{}
\DoxyCodeLine{985             \textcolor{keywordtype}{int} m = (-\/n) \% max;}
\DoxyCodeLine{986 }
\DoxyCodeLine{987             \textcolor{keywordflow}{if} (m != 0)}
\DoxyCodeLine{988                 m = max -\/ m;}
\DoxyCodeLine{989 }
\DoxyCodeLine{990             \textcolor{keywordflow}{return} (m);}
\DoxyCodeLine{991         \}}
\DoxyCodeLine{992         \textcolor{comment}{// NOTREACHED}}
\DoxyCodeLine{993 }
\DoxyCodeLine{994     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{995         STBIR\_ASSERT(!\textcolor{stringliteral}{"{}Unimplemented edge type"{}});}
\DoxyCodeLine{996         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{997     \}}
\DoxyCodeLine{998 \}}
\DoxyCodeLine{999 }
\DoxyCodeLine{1000 stbir\_\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_edge\_wrap(stbir\_edge edge, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} max)}
\DoxyCodeLine{1001 \{}
\DoxyCodeLine{1002     \textcolor{comment}{// avoid per-\/pixel switch}}
\DoxyCodeLine{1003     \textcolor{keywordflow}{if} (n >= 0 \&\& n < max)}
\DoxyCodeLine{1004         \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{1005     \textcolor{keywordflow}{return} stbir\_\_edge\_wrap\_slow(edge, n, max);}
\DoxyCodeLine{1006 \}}
\DoxyCodeLine{1007 }
\DoxyCodeLine{1008 \textcolor{comment}{// What input pixels contribute to this output pixel?}}
\DoxyCodeLine{1009 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_calculate\_sample\_range\_upsample(\textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} out\_filter\_radius, \textcolor{keywordtype}{float} scale\_ratio, \textcolor{keywordtype}{float} out\_shift, \textcolor{keywordtype}{int}* in\_first\_pixel, \textcolor{keywordtype}{int}* in\_last\_pixel, \textcolor{keywordtype}{float}* in\_center\_of\_out)}
\DoxyCodeLine{1010 \{}
\DoxyCodeLine{1011     \textcolor{keywordtype}{float} out\_pixel\_center = (float)n + 0.5f;}
\DoxyCodeLine{1012     \textcolor{keywordtype}{float} out\_pixel\_influence\_lowerbound = out\_pixel\_center -\/ out\_filter\_radius;}
\DoxyCodeLine{1013     \textcolor{keywordtype}{float} out\_pixel\_influence\_upperbound = out\_pixel\_center + out\_filter\_radius;}
\DoxyCodeLine{1014 }
\DoxyCodeLine{1015     \textcolor{keywordtype}{float} in\_pixel\_influence\_lowerbound = (out\_pixel\_influence\_lowerbound + out\_shift) / scale\_ratio;}
\DoxyCodeLine{1016     \textcolor{keywordtype}{float} in\_pixel\_influence\_upperbound = (out\_pixel\_influence\_upperbound + out\_shift) / scale\_ratio;}
\DoxyCodeLine{1017 }
\DoxyCodeLine{1018     *in\_center\_of\_out = (out\_pixel\_center + out\_shift) / scale\_ratio;}
\DoxyCodeLine{1019     *in\_first\_pixel = (int)(floor(in\_pixel\_influence\_lowerbound + 0.5));}
\DoxyCodeLine{1020     *in\_last\_pixel = (int)(floor(in\_pixel\_influence\_upperbound -\/ 0.5));}
\DoxyCodeLine{1021 \}}
\DoxyCodeLine{1022 }
\DoxyCodeLine{1023 \textcolor{comment}{// What output pixels does this input pixel contribute to?}}
\DoxyCodeLine{1024 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_calculate\_sample\_range\_downsample(\textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} in\_pixels\_radius, \textcolor{keywordtype}{float} scale\_ratio, \textcolor{keywordtype}{float} out\_shift, \textcolor{keywordtype}{int}* out\_first\_pixel, \textcolor{keywordtype}{int}* out\_last\_pixel, \textcolor{keywordtype}{float}* out\_center\_of\_in)}
\DoxyCodeLine{1025 \{}
\DoxyCodeLine{1026     \textcolor{keywordtype}{float} in\_pixel\_center = (float)n + 0.5f;}
\DoxyCodeLine{1027     \textcolor{keywordtype}{float} in\_pixel\_influence\_lowerbound = in\_pixel\_center -\/ in\_pixels\_radius;}
\DoxyCodeLine{1028     \textcolor{keywordtype}{float} in\_pixel\_influence\_upperbound = in\_pixel\_center + in\_pixels\_radius;}
\DoxyCodeLine{1029 }
\DoxyCodeLine{1030     \textcolor{keywordtype}{float} out\_pixel\_influence\_lowerbound = in\_pixel\_influence\_lowerbound * scale\_ratio -\/ out\_shift;}
\DoxyCodeLine{1031     \textcolor{keywordtype}{float} out\_pixel\_influence\_upperbound = in\_pixel\_influence\_upperbound * scale\_ratio -\/ out\_shift;}
\DoxyCodeLine{1032 }
\DoxyCodeLine{1033     *out\_center\_of\_in = in\_pixel\_center * scale\_ratio -\/ out\_shift;}
\DoxyCodeLine{1034     *out\_first\_pixel = (int)(floor(out\_pixel\_influence\_lowerbound + 0.5));}
\DoxyCodeLine{1035     *out\_last\_pixel = (int)(floor(out\_pixel\_influence\_upperbound -\/ 0.5));}
\DoxyCodeLine{1036 \}}
\DoxyCodeLine{1037 }
\DoxyCodeLine{1038 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_calculate\_coefficients\_upsample(stbir\_filter filter, \textcolor{keywordtype}{float} scale, \textcolor{keywordtype}{int} in\_first\_pixel, \textcolor{keywordtype}{int} in\_last\_pixel, \textcolor{keywordtype}{float} in\_center\_of\_out, stbir\_\_contributors* contributor, \textcolor{keywordtype}{float}* coefficient\_group)}
\DoxyCodeLine{1039 \{}
\DoxyCodeLine{1040     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1041     \textcolor{keywordtype}{float} total\_filter = 0;}
\DoxyCodeLine{1042     \textcolor{keywordtype}{float} filter\_scale;}
\DoxyCodeLine{1043 }
\DoxyCodeLine{1044     STBIR\_ASSERT(in\_last\_pixel -\/ in\_first\_pixel <= (\textcolor{keywordtype}{int})ceil(stbir\_\_filter\_info\_table[filter].support(1/scale) * 2)); \textcolor{comment}{// Taken directly from stbir\_\_get\_coefficient\_width() which we can't call because we don't know if we're horizontal or vertical.}}
\DoxyCodeLine{1045 }
\DoxyCodeLine{1046     contributor-\/>n0 = in\_first\_pixel;}
\DoxyCodeLine{1047     contributor-\/>n1 = in\_last\_pixel;}
\DoxyCodeLine{1048 }
\DoxyCodeLine{1049     STBIR\_ASSERT(contributor-\/>n1 >= contributor-\/>n0);}
\DoxyCodeLine{1050 }
\DoxyCodeLine{1051     \textcolor{keywordflow}{for} (i = 0; i <= in\_last\_pixel -\/ in\_first\_pixel; i++)}
\DoxyCodeLine{1052     \{}
\DoxyCodeLine{1053         \textcolor{keywordtype}{float} in\_pixel\_center = (float)(i + in\_first\_pixel) + 0.5f;}
\DoxyCodeLine{1054         coefficient\_group[i] = stbir\_\_filter\_info\_table[filter].kernel(in\_center\_of\_out -\/ in\_pixel\_center, 1 / scale);}
\DoxyCodeLine{1055 }
\DoxyCodeLine{1056         \textcolor{comment}{// If the coefficient is zero, skip it. (Don't do the <0 check here, we want the influence of those outside pixels.)}}
\DoxyCodeLine{1057         \textcolor{keywordflow}{if} (i == 0 \&\& !coefficient\_group[i])}
\DoxyCodeLine{1058         \{}
\DoxyCodeLine{1059             contributor-\/>n0 = ++in\_first\_pixel;}
\DoxyCodeLine{1060             i-\/-\/;}
\DoxyCodeLine{1061             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1062         \}}
\DoxyCodeLine{1063 }
\DoxyCodeLine{1064         total\_filter += coefficient\_group[i];}
\DoxyCodeLine{1065     \}}
\DoxyCodeLine{1066 }
\DoxyCodeLine{1067     STBIR\_ASSERT(stbir\_\_filter\_info\_table[filter].kernel((\textcolor{keywordtype}{float})(in\_last\_pixel + 1) + 0.5f -\/ in\_center\_of\_out, 1/scale) == 0);}
\DoxyCodeLine{1068 }
\DoxyCodeLine{1069     STBIR\_ASSERT(total\_filter > 0.9);}
\DoxyCodeLine{1070     STBIR\_ASSERT(total\_filter < 1.1f); \textcolor{comment}{// Make sure it's not way off.}}
\DoxyCodeLine{1071 }
\DoxyCodeLine{1072     \textcolor{comment}{// Make sure the sum of all coefficients is 1.}}
\DoxyCodeLine{1073     filter\_scale = 1 / total\_filter;}
\DoxyCodeLine{1074 }
\DoxyCodeLine{1075     \textcolor{keywordflow}{for} (i = 0; i <= in\_last\_pixel -\/ in\_first\_pixel; i++)}
\DoxyCodeLine{1076         coefficient\_group[i] *= filter\_scale;}
\DoxyCodeLine{1077 }
\DoxyCodeLine{1078     \textcolor{keywordflow}{for} (i = in\_last\_pixel -\/ in\_first\_pixel; i >= 0; i-\/-\/)}
\DoxyCodeLine{1079     \{}
\DoxyCodeLine{1080         \textcolor{keywordflow}{if} (coefficient\_group[i])}
\DoxyCodeLine{1081             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1082 }
\DoxyCodeLine{1083         \textcolor{comment}{// This line has no weight. We can skip it.}}
\DoxyCodeLine{1084         contributor-\/>n1 = contributor-\/>n0 + i -\/ 1;}
\DoxyCodeLine{1085     \}}
\DoxyCodeLine{1086 \}}
\DoxyCodeLine{1087 }
\DoxyCodeLine{1088 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_calculate\_coefficients\_downsample(stbir\_filter filter, \textcolor{keywordtype}{float} scale\_ratio, \textcolor{keywordtype}{int} out\_first\_pixel, \textcolor{keywordtype}{int} out\_last\_pixel, \textcolor{keywordtype}{float} out\_center\_of\_in, stbir\_\_contributors* contributor, \textcolor{keywordtype}{float}* coefficient\_group)}
\DoxyCodeLine{1089 \{}
\DoxyCodeLine{1090     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1091 }
\DoxyCodeLine{1092      STBIR\_ASSERT(out\_last\_pixel -\/ out\_first\_pixel <= (\textcolor{keywordtype}{int})ceil(stbir\_\_filter\_info\_table[filter].support(scale\_ratio) * 2)); \textcolor{comment}{// Taken directly from stbir\_\_get\_coefficient\_width() which we can't call because we don't know if we're horizontal or vertical.}}
\DoxyCodeLine{1093 }
\DoxyCodeLine{1094     contributor-\/>n0 = out\_first\_pixel;}
\DoxyCodeLine{1095     contributor-\/>n1 = out\_last\_pixel;}
\DoxyCodeLine{1096 }
\DoxyCodeLine{1097     STBIR\_ASSERT(contributor-\/>n1 >= contributor-\/>n0);}
\DoxyCodeLine{1098 }
\DoxyCodeLine{1099     \textcolor{keywordflow}{for} (i = 0; i <= out\_last\_pixel -\/ out\_first\_pixel; i++)}
\DoxyCodeLine{1100     \{}
\DoxyCodeLine{1101         \textcolor{keywordtype}{float} out\_pixel\_center = (float)(i + out\_first\_pixel) + 0.5f;}
\DoxyCodeLine{1102         \textcolor{keywordtype}{float} x = out\_pixel\_center -\/ out\_center\_of\_in;}
\DoxyCodeLine{1103         coefficient\_group[i] = stbir\_\_filter\_info\_table[filter].kernel(x, scale\_ratio) * scale\_ratio;}
\DoxyCodeLine{1104     \}}
\DoxyCodeLine{1105 }
\DoxyCodeLine{1106     STBIR\_ASSERT(stbir\_\_filter\_info\_table[filter].kernel((\textcolor{keywordtype}{float})(out\_last\_pixel + 1) + 0.5f -\/ out\_center\_of\_in, scale\_ratio) == 0);}
\DoxyCodeLine{1107 }
\DoxyCodeLine{1108     \textcolor{keywordflow}{for} (i = out\_last\_pixel -\/ out\_first\_pixel; i >= 0; i-\/-\/)}
\DoxyCodeLine{1109     \{}
\DoxyCodeLine{1110         \textcolor{keywordflow}{if} (coefficient\_group[i])}
\DoxyCodeLine{1111             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1112 }
\DoxyCodeLine{1113         \textcolor{comment}{// This line has no weight. We can skip it.}}
\DoxyCodeLine{1114         contributor-\/>n1 = contributor-\/>n0 + i -\/ 1;}
\DoxyCodeLine{1115     \}}
\DoxyCodeLine{1116 \}}
\DoxyCodeLine{1117 }
\DoxyCodeLine{1118 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_normalize\_downsample\_coefficients(stbir\_\_contributors* contributors, \textcolor{keywordtype}{float}* coefficients, stbir\_filter filter, \textcolor{keywordtype}{float} scale\_ratio, \textcolor{keywordtype}{int} input\_size, \textcolor{keywordtype}{int} output\_size)}
\DoxyCodeLine{1119 \{}
\DoxyCodeLine{1120     \textcolor{keywordtype}{int} num\_contributors = stbir\_\_get\_contributors(scale\_ratio, filter, input\_size, output\_size);}
\DoxyCodeLine{1121     \textcolor{keywordtype}{int} num\_coefficients = stbir\_\_get\_coefficient\_width(filter, scale\_ratio);}
\DoxyCodeLine{1122     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{1123     \textcolor{keywordtype}{int} skip;}
\DoxyCodeLine{1124 }
\DoxyCodeLine{1125     \textcolor{keywordflow}{for} (i = 0; i < output\_size; i++)}
\DoxyCodeLine{1126     \{}
\DoxyCodeLine{1127         \textcolor{keywordtype}{float} scale;}
\DoxyCodeLine{1128         \textcolor{keywordtype}{float} total = 0;}
\DoxyCodeLine{1129 }
\DoxyCodeLine{1130         \textcolor{keywordflow}{for} (j = 0; j < num\_contributors; j++)}
\DoxyCodeLine{1131         \{}
\DoxyCodeLine{1132             \textcolor{keywordflow}{if} (i >= contributors[j].n0 \&\& i <= contributors[j].n1)}
\DoxyCodeLine{1133             \{}
\DoxyCodeLine{1134                 \textcolor{keywordtype}{float} coefficient = *stbir\_\_get\_coefficient(coefficients, filter, scale\_ratio, j, i -\/ contributors[j].n0);}
\DoxyCodeLine{1135                 total += coefficient;}
\DoxyCodeLine{1136             \}}
\DoxyCodeLine{1137             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i < contributors[j].n0)}
\DoxyCodeLine{1138                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1139         \}}
\DoxyCodeLine{1140 }
\DoxyCodeLine{1141         STBIR\_ASSERT(total > 0.9f);}
\DoxyCodeLine{1142         STBIR\_ASSERT(total < 1.1f);}
\DoxyCodeLine{1143 }
\DoxyCodeLine{1144         scale = 1 / total;}
\DoxyCodeLine{1145 }
\DoxyCodeLine{1146         \textcolor{keywordflow}{for} (j = 0; j < num\_contributors; j++)}
\DoxyCodeLine{1147         \{}
\DoxyCodeLine{1148             \textcolor{keywordflow}{if} (i >= contributors[j].n0 \&\& i <= contributors[j].n1)}
\DoxyCodeLine{1149                 *stbir\_\_get\_coefficient(coefficients, filter, scale\_ratio, j, i -\/ contributors[j].n0) *= scale;}
\DoxyCodeLine{1150             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i < contributors[j].n0)}
\DoxyCodeLine{1151                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1152         \}}
\DoxyCodeLine{1153     \}}
\DoxyCodeLine{1154 }
\DoxyCodeLine{1155     \textcolor{comment}{// Optimize: Skip zero coefficients and contributions outside of image bounds.}}
\DoxyCodeLine{1156     \textcolor{comment}{// Do this after normalizing because normalization depends on the n0/n1 values.}}
\DoxyCodeLine{1157     \textcolor{keywordflow}{for} (j = 0; j < num\_contributors; j++)}
\DoxyCodeLine{1158     \{}
\DoxyCodeLine{1159         \textcolor{keywordtype}{int} range, max, width;}
\DoxyCodeLine{1160 }
\DoxyCodeLine{1161         skip = 0;}
\DoxyCodeLine{1162         \textcolor{keywordflow}{while} (*stbir\_\_get\_coefficient(coefficients, filter, scale\_ratio, j, skip) == 0)}
\DoxyCodeLine{1163             skip++;}
\DoxyCodeLine{1164 }
\DoxyCodeLine{1165         contributors[j].n0 += skip;}
\DoxyCodeLine{1166 }
\DoxyCodeLine{1167         \textcolor{keywordflow}{while} (contributors[j].n0 < 0)}
\DoxyCodeLine{1168         \{}
\DoxyCodeLine{1169             contributors[j].n0++;}
\DoxyCodeLine{1170             skip++;}
\DoxyCodeLine{1171         \}}
\DoxyCodeLine{1172 }
\DoxyCodeLine{1173         range = contributors[j].n1 -\/ contributors[j].n0 + 1;}
\DoxyCodeLine{1174         max = stbir\_\_min(num\_coefficients, range);}
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176         width = stbir\_\_get\_coefficient\_width(filter, scale\_ratio);}
\DoxyCodeLine{1177         \textcolor{keywordflow}{for} (i = 0; i < max; i++)}
\DoxyCodeLine{1178         \{}
\DoxyCodeLine{1179             \textcolor{keywordflow}{if} (i + skip >= width)}
\DoxyCodeLine{1180                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1181 }
\DoxyCodeLine{1182             *stbir\_\_get\_coefficient(coefficients, filter, scale\_ratio, j, i) = *stbir\_\_get\_coefficient(coefficients, filter, scale\_ratio, j, i + skip);}
\DoxyCodeLine{1183         \}}
\DoxyCodeLine{1184 }
\DoxyCodeLine{1185         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1186     \}}
\DoxyCodeLine{1187 }
\DoxyCodeLine{1188     \textcolor{comment}{// Using min to avoid writing into invalid pixels.}}
\DoxyCodeLine{1189     \textcolor{keywordflow}{for} (i = 0; i < num\_contributors; i++)}
\DoxyCodeLine{1190         contributors[i].n1 = stbir\_\_min(contributors[i].n1, output\_size -\/ 1);}
\DoxyCodeLine{1191 \}}
\DoxyCodeLine{1192 }
\DoxyCodeLine{1193 \textcolor{comment}{// Each scan line uses the same kernel values so we should calculate the kernel}}
\DoxyCodeLine{1194 \textcolor{comment}{// values once and then we can use them for every scan line.}}
\DoxyCodeLine{1195 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_calculate\_filters(stbir\_\_contributors* contributors, \textcolor{keywordtype}{float}* coefficients, stbir\_filter filter, \textcolor{keywordtype}{float} scale\_ratio, \textcolor{keywordtype}{float} shift, \textcolor{keywordtype}{int} input\_size, \textcolor{keywordtype}{int} output\_size)}
\DoxyCodeLine{1196 \{}
\DoxyCodeLine{1197     \textcolor{keywordtype}{int} n;}
\DoxyCodeLine{1198     \textcolor{keywordtype}{int} total\_contributors = stbir\_\_get\_contributors(scale\_ratio, filter, input\_size, output\_size);}
\DoxyCodeLine{1199 }
\DoxyCodeLine{1200     \textcolor{keywordflow}{if} (stbir\_\_use\_upsampling(scale\_ratio))}
\DoxyCodeLine{1201     \{}
\DoxyCodeLine{1202         \textcolor{keywordtype}{float} out\_pixels\_radius = stbir\_\_filter\_info\_table[filter].support(1 / scale\_ratio) * scale\_ratio;}
\DoxyCodeLine{1203 }
\DoxyCodeLine{1204         \textcolor{comment}{// Looping through out pixels}}
\DoxyCodeLine{1205         \textcolor{keywordflow}{for} (n = 0; n < total\_contributors; n++)}
\DoxyCodeLine{1206         \{}
\DoxyCodeLine{1207             \textcolor{keywordtype}{float} in\_center\_of\_out; \textcolor{comment}{// Center of the current out pixel in the in pixel space}}
\DoxyCodeLine{1208             \textcolor{keywordtype}{int} in\_first\_pixel, in\_last\_pixel;}
\DoxyCodeLine{1209 }
\DoxyCodeLine{1210             stbir\_\_calculate\_sample\_range\_upsample(n, out\_pixels\_radius, scale\_ratio, shift, \&in\_first\_pixel, \&in\_last\_pixel, \&in\_center\_of\_out);}
\DoxyCodeLine{1211 }
\DoxyCodeLine{1212             stbir\_\_calculate\_coefficients\_upsample(filter, scale\_ratio, in\_first\_pixel, in\_last\_pixel, in\_center\_of\_out, stbir\_\_get\_contributor(contributors, n), stbir\_\_get\_coefficient(coefficients, filter, scale\_ratio, n, 0));}
\DoxyCodeLine{1213         \}}
\DoxyCodeLine{1214     \}}
\DoxyCodeLine{1215     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1216     \{}
\DoxyCodeLine{1217         \textcolor{keywordtype}{float} in\_pixels\_radius = stbir\_\_filter\_info\_table[filter].support(scale\_ratio) / scale\_ratio;}
\DoxyCodeLine{1218 }
\DoxyCodeLine{1219         \textcolor{comment}{// Looping through in pixels}}
\DoxyCodeLine{1220         \textcolor{keywordflow}{for} (n = 0; n < total\_contributors; n++)}
\DoxyCodeLine{1221         \{}
\DoxyCodeLine{1222             \textcolor{keywordtype}{float} out\_center\_of\_in; \textcolor{comment}{// Center of the current out pixel in the in pixel space}}
\DoxyCodeLine{1223             \textcolor{keywordtype}{int} out\_first\_pixel, out\_last\_pixel;}
\DoxyCodeLine{1224             \textcolor{keywordtype}{int} n\_adjusted = n -\/ stbir\_\_get\_filter\_pixel\_margin(filter, scale\_ratio);}
\DoxyCodeLine{1225 }
\DoxyCodeLine{1226             stbir\_\_calculate\_sample\_range\_downsample(n\_adjusted, in\_pixels\_radius, scale\_ratio, shift, \&out\_first\_pixel, \&out\_last\_pixel, \&out\_center\_of\_in);}
\DoxyCodeLine{1227 }
\DoxyCodeLine{1228             stbir\_\_calculate\_coefficients\_downsample(filter, scale\_ratio, out\_first\_pixel, out\_last\_pixel, out\_center\_of\_in, stbir\_\_get\_contributor(contributors, n), stbir\_\_get\_coefficient(coefficients, filter, scale\_ratio, n, 0));}
\DoxyCodeLine{1229         \}}
\DoxyCodeLine{1230 }
\DoxyCodeLine{1231         stbir\_\_normalize\_downsample\_coefficients(contributors, coefficients, filter, scale\_ratio, input\_size, output\_size);}
\DoxyCodeLine{1232     \}}
\DoxyCodeLine{1233 \}}
\DoxyCodeLine{1234 }
\DoxyCodeLine{1235 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbir\_\_get\_decode\_buffer(stbir\_\_info* stbir\_info)}
\DoxyCodeLine{1236 \{}
\DoxyCodeLine{1237     \textcolor{comment}{// The 0 index of the decode buffer starts after the margin. This makes}}
\DoxyCodeLine{1238     \textcolor{comment}{// it okay to use negative indexes on the decode buffer.}}
\DoxyCodeLine{1239     \textcolor{keywordflow}{return} \&stbir\_info-\/>decode\_buffer[stbir\_info-\/>horizontal\_filter\_pixel\_margin * stbir\_info-\/>channels];}
\DoxyCodeLine{1240 \}}
\DoxyCodeLine{1241 }
\DoxyCodeLine{1242 \textcolor{preprocessor}{\#define STBIR\_\_DECODE(type, colorspace) ((int)(type) * (STBIR\_MAX\_COLORSPACES) + (int)(colorspace))}}
\DoxyCodeLine{1243 }
\DoxyCodeLine{1244 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_decode\_scanline(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1245 \{}
\DoxyCodeLine{1246     \textcolor{keywordtype}{int} c;}
\DoxyCodeLine{1247     \textcolor{keywordtype}{int} channels = stbir\_info-\/>channels;}
\DoxyCodeLine{1248     \textcolor{keywordtype}{int} alpha\_channel = stbir\_info-\/>alpha\_channel;}
\DoxyCodeLine{1249     \textcolor{keywordtype}{int} type = stbir\_info-\/>type;}
\DoxyCodeLine{1250     \textcolor{keywordtype}{int} colorspace = stbir\_info-\/>colorspace;}
\DoxyCodeLine{1251     \textcolor{keywordtype}{int} input\_w = stbir\_info-\/>input\_w;}
\DoxyCodeLine{1252     \textcolor{keywordtype}{size\_t} input\_stride\_bytes = stbir\_info-\/>input\_stride\_bytes;}
\DoxyCodeLine{1253     \textcolor{keywordtype}{float}* decode\_buffer = stbir\_\_get\_decode\_buffer(stbir\_info);}
\DoxyCodeLine{1254     stbir\_edge edge\_horizontal = stbir\_info-\/>edge\_horizontal;}
\DoxyCodeLine{1255     stbir\_edge edge\_vertical = stbir\_info-\/>edge\_vertical;}
\DoxyCodeLine{1256     \textcolor{keywordtype}{size\_t} in\_buffer\_row\_offset = stbir\_\_edge\_wrap(edge\_vertical, n, stbir\_info-\/>input\_h) * input\_stride\_bytes;}
\DoxyCodeLine{1257     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* input\_data = (\textcolor{keywordtype}{char} *) stbir\_info-\/>input\_data + in\_buffer\_row\_offset;}
\DoxyCodeLine{1258     \textcolor{keywordtype}{int} max\_x = input\_w + stbir\_info-\/>horizontal\_filter\_pixel\_margin;}
\DoxyCodeLine{1259     \textcolor{keywordtype}{int} decode = STBIR\_\_DECODE(type, colorspace);}
\DoxyCodeLine{1260 }
\DoxyCodeLine{1261     \textcolor{keywordtype}{int} x = -\/stbir\_info-\/>horizontal\_filter\_pixel\_margin;}
\DoxyCodeLine{1262 }
\DoxyCodeLine{1263     \textcolor{comment}{// special handling for STBIR\_EDGE\_ZERO because it needs to return an item that doesn't appear in the input,}}
\DoxyCodeLine{1264     \textcolor{comment}{// and we want to avoid paying overhead on every pixel if not STBIR\_EDGE\_ZERO}}
\DoxyCodeLine{1265     \textcolor{keywordflow}{if} (edge\_vertical == STBIR\_EDGE\_ZERO \&\& (n < 0 || n >= stbir\_info-\/>input\_h))}
\DoxyCodeLine{1266     \{}
\DoxyCodeLine{1267         \textcolor{keywordflow}{for} (; x < max\_x; x++)}
\DoxyCodeLine{1268             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1269                 decode\_buffer[x*channels + c] = 0;}
\DoxyCodeLine{1270         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1271     \}}
\DoxyCodeLine{1272 }
\DoxyCodeLine{1273     \textcolor{keywordflow}{switch} (decode)}
\DoxyCodeLine{1274     \{}
\DoxyCodeLine{1275     \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT8, STBIR\_COLORSPACE\_LINEAR):}
\DoxyCodeLine{1276         for (; x < max\_x; x++)}
\DoxyCodeLine{1277         \{}
\DoxyCodeLine{1278             \textcolor{keywordtype}{int} decode\_pixel\_index = x * channels;}
\DoxyCodeLine{1279             \textcolor{keywordtype}{int} input\_pixel\_index = stbir\_\_edge\_wrap(edge\_horizontal, x, input\_w) * channels;}
\DoxyCodeLine{1280             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1281                 decode\_buffer[decode\_pixel\_index + c] = ((\textcolor{keywordtype}{float})((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)input\_data)[input\_pixel\_index + c]) / stbir\_\_max\_uint8\_as\_float;}
\DoxyCodeLine{1282         \}}
\DoxyCodeLine{1283         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1284 }
\DoxyCodeLine{1285     \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT8, STBIR\_COLORSPACE\_SRGB):}
\DoxyCodeLine{1286         for (; x < max\_x; x++)}
\DoxyCodeLine{1287         \{}
\DoxyCodeLine{1288             \textcolor{keywordtype}{int} decode\_pixel\_index = x * channels;}
\DoxyCodeLine{1289             \textcolor{keywordtype}{int} input\_pixel\_index = stbir\_\_edge\_wrap(edge\_horizontal, x, input\_w) * channels;}
\DoxyCodeLine{1290             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1291                 decode\_buffer[decode\_pixel\_index + c] = stbir\_\_srgb\_uchar\_to\_linear\_float[((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)input\_data)[input\_pixel\_index + c]];}
\DoxyCodeLine{1292 }
\DoxyCodeLine{1293             \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags\&STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE))}
\DoxyCodeLine{1294                 decode\_buffer[decode\_pixel\_index + alpha\_channel] = ((float)((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)input\_data)[input\_pixel\_index + alpha\_channel]) / stbir\_\_max\_uint8\_as\_float;}
\DoxyCodeLine{1295         \}}
\DoxyCodeLine{1296         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1297 }
\DoxyCodeLine{1298     \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT16, STBIR\_COLORSPACE\_LINEAR):}
\DoxyCodeLine{1299         for (; x < max\_x; x++)}
\DoxyCodeLine{1300         \{}
\DoxyCodeLine{1301             \textcolor{keywordtype}{int} decode\_pixel\_index = x * channels;}
\DoxyCodeLine{1302             \textcolor{keywordtype}{int} input\_pixel\_index = stbir\_\_edge\_wrap(edge\_horizontal, x, input\_w) * channels;}
\DoxyCodeLine{1303             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1304                 decode\_buffer[decode\_pixel\_index + c] = ((\textcolor{keywordtype}{float})((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}*)input\_data)[input\_pixel\_index + c]) / stbir\_\_max\_uint16\_as\_float;}
\DoxyCodeLine{1305         \}}
\DoxyCodeLine{1306         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1307 }
\DoxyCodeLine{1308     \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT16, STBIR\_COLORSPACE\_SRGB):}
\DoxyCodeLine{1309         for (; x < max\_x; x++)}
\DoxyCodeLine{1310         \{}
\DoxyCodeLine{1311             \textcolor{keywordtype}{int} decode\_pixel\_index = x * channels;}
\DoxyCodeLine{1312             \textcolor{keywordtype}{int} input\_pixel\_index = stbir\_\_edge\_wrap(edge\_horizontal, x, input\_w) * channels;}
\DoxyCodeLine{1313             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1314                 decode\_buffer[decode\_pixel\_index + c] = stbir\_\_srgb\_to\_linear(((\textcolor{keywordtype}{float})((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}*)input\_data)[input\_pixel\_index + c]) / stbir\_\_max\_uint16\_as\_float);}
\DoxyCodeLine{1315 }
\DoxyCodeLine{1316             \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags\&STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE))}
\DoxyCodeLine{1317                 decode\_buffer[decode\_pixel\_index + alpha\_channel] = ((float)((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}*)input\_data)[input\_pixel\_index + alpha\_channel]) / stbir\_\_max\_uint16\_as\_float;}
\DoxyCodeLine{1318         \}}
\DoxyCodeLine{1319         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1320 }
\DoxyCodeLine{1321     \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT32, STBIR\_COLORSPACE\_LINEAR):}
\DoxyCodeLine{1322         for (; x < max\_x; x++)}
\DoxyCodeLine{1323         \{}
\DoxyCodeLine{1324             \textcolor{keywordtype}{int} decode\_pixel\_index = x * channels;}
\DoxyCodeLine{1325             \textcolor{keywordtype}{int} input\_pixel\_index = stbir\_\_edge\_wrap(edge\_horizontal, x, input\_w) * channels;}
\DoxyCodeLine{1326             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1327                 decode\_buffer[decode\_pixel\_index + c] = (\textcolor{keywordtype}{float})(((double)((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}*)input\_data)[input\_pixel\_index + c]) / stbir\_\_max\_uint32\_as\_float);}
\DoxyCodeLine{1328         \}}
\DoxyCodeLine{1329         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1330 }
\DoxyCodeLine{1331     \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT32, STBIR\_COLORSPACE\_SRGB):}
\DoxyCodeLine{1332         for (; x < max\_x; x++)}
\DoxyCodeLine{1333         \{}
\DoxyCodeLine{1334             \textcolor{keywordtype}{int} decode\_pixel\_index = x * channels;}
\DoxyCodeLine{1335             \textcolor{keywordtype}{int} input\_pixel\_index = stbir\_\_edge\_wrap(edge\_horizontal, x, input\_w) * channels;}
\DoxyCodeLine{1336             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1337                 decode\_buffer[decode\_pixel\_index + c] = stbir\_\_srgb\_to\_linear((\textcolor{keywordtype}{float})(((\textcolor{keywordtype}{double})((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}*)input\_data)[input\_pixel\_index + c]) / stbir\_\_max\_uint32\_as\_float));}
\DoxyCodeLine{1338 }
\DoxyCodeLine{1339             \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags\&STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE))}
\DoxyCodeLine{1340                 decode\_buffer[decode\_pixel\_index + alpha\_channel] = (float)(((\textcolor{keywordtype}{double})((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}*)input\_data)[input\_pixel\_index + alpha\_channel]) / stbir\_\_max\_uint32\_as\_float);}
\DoxyCodeLine{1341         \}}
\DoxyCodeLine{1342         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1343 }
\DoxyCodeLine{1344     \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_FLOAT, STBIR\_COLORSPACE\_LINEAR):}
\DoxyCodeLine{1345         for (; x < max\_x; x++)}
\DoxyCodeLine{1346         \{}
\DoxyCodeLine{1347             \textcolor{keywordtype}{int} decode\_pixel\_index = x * channels;}
\DoxyCodeLine{1348             \textcolor{keywordtype}{int} input\_pixel\_index = stbir\_\_edge\_wrap(edge\_horizontal, x, input\_w) * channels;}
\DoxyCodeLine{1349             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1350                 decode\_buffer[decode\_pixel\_index + c] = ((\textcolor{keyword}{const} \textcolor{keywordtype}{float}*)input\_data)[input\_pixel\_index + c];}
\DoxyCodeLine{1351         \}}
\DoxyCodeLine{1352         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1353 }
\DoxyCodeLine{1354     \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_FLOAT, STBIR\_COLORSPACE\_SRGB):}
\DoxyCodeLine{1355         for (; x < max\_x; x++)}
\DoxyCodeLine{1356         \{}
\DoxyCodeLine{1357             \textcolor{keywordtype}{int} decode\_pixel\_index = x * channels;}
\DoxyCodeLine{1358             \textcolor{keywordtype}{int} input\_pixel\_index = stbir\_\_edge\_wrap(edge\_horizontal, x, input\_w) * channels;}
\DoxyCodeLine{1359             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1360                 decode\_buffer[decode\_pixel\_index + c] = stbir\_\_srgb\_to\_linear(((\textcolor{keyword}{const} \textcolor{keywordtype}{float}*)input\_data)[input\_pixel\_index + c]);}
\DoxyCodeLine{1361 }
\DoxyCodeLine{1362             \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags\&STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE))}
\DoxyCodeLine{1363                 decode\_buffer[decode\_pixel\_index + alpha\_channel] = ((\textcolor{keyword}{const} \textcolor{keywordtype}{float}*)input\_data)[input\_pixel\_index + alpha\_channel];}
\DoxyCodeLine{1364         \}}
\DoxyCodeLine{1365 }
\DoxyCodeLine{1366         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1367 }
\DoxyCodeLine{1368     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{1369         STBIR\_ASSERT(!\textcolor{stringliteral}{"{}Unknown type/colorspace/channels combination."{}});}
\DoxyCodeLine{1370         \textcolor{keywordflow}{break};}
\DoxyCodeLine{1371     \}}
\DoxyCodeLine{1372 }
\DoxyCodeLine{1373     \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags \& STBIR\_FLAG\_ALPHA\_PREMULTIPLIED))}
\DoxyCodeLine{1374     \{}
\DoxyCodeLine{1375         \textcolor{keywordflow}{for} (x = -\/stbir\_info-\/>horizontal\_filter\_pixel\_margin; x < max\_x; x++)}
\DoxyCodeLine{1376         \{}
\DoxyCodeLine{1377             \textcolor{keywordtype}{int} decode\_pixel\_index = x * channels;}
\DoxyCodeLine{1378 }
\DoxyCodeLine{1379             \textcolor{comment}{// If the alpha value is 0 it will clobber the color values. Make sure it's not.}}
\DoxyCodeLine{1380             \textcolor{keywordtype}{float} alpha = decode\_buffer[decode\_pixel\_index + alpha\_channel];}
\DoxyCodeLine{1381 \textcolor{preprocessor}{\#ifndef STBIR\_NO\_ALPHA\_EPSILON}}
\DoxyCodeLine{1382             \textcolor{keywordflow}{if} (stbir\_info-\/>type != STBIR\_TYPE\_FLOAT) \{}
\DoxyCodeLine{1383                 alpha += STBIR\_ALPHA\_EPSILON;}
\DoxyCodeLine{1384                 decode\_buffer[decode\_pixel\_index + alpha\_channel] = alpha;}
\DoxyCodeLine{1385             \}}
\DoxyCodeLine{1386 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1387             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1388             \{}
\DoxyCodeLine{1389                 \textcolor{keywordflow}{if} (c == alpha\_channel)}
\DoxyCodeLine{1390                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1391 }
\DoxyCodeLine{1392                 decode\_buffer[decode\_pixel\_index + c] *= alpha;}
\DoxyCodeLine{1393             \}}
\DoxyCodeLine{1394         \}}
\DoxyCodeLine{1395     \}}
\DoxyCodeLine{1396 }
\DoxyCodeLine{1397     \textcolor{keywordflow}{if} (edge\_horizontal == STBIR\_EDGE\_ZERO)}
\DoxyCodeLine{1398     \{}
\DoxyCodeLine{1399         \textcolor{keywordflow}{for} (x = -\/stbir\_info-\/>horizontal\_filter\_pixel\_margin; x < 0; x++)}
\DoxyCodeLine{1400         \{}
\DoxyCodeLine{1401             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1402                 decode\_buffer[x*channels + c] = 0;}
\DoxyCodeLine{1403         \}}
\DoxyCodeLine{1404         \textcolor{keywordflow}{for} (x = input\_w; x < max\_x; x++)}
\DoxyCodeLine{1405         \{}
\DoxyCodeLine{1406             \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1407                 decode\_buffer[x*channels + c] = 0;}
\DoxyCodeLine{1408         \}}
\DoxyCodeLine{1409     \}}
\DoxyCodeLine{1410 \}}
\DoxyCodeLine{1411 }
\DoxyCodeLine{1412 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbir\_\_get\_ring\_buffer\_entry(\textcolor{keywordtype}{float}* ring\_buffer, \textcolor{keywordtype}{int} index, \textcolor{keywordtype}{int} ring\_buffer\_length)}
\DoxyCodeLine{1413 \{}
\DoxyCodeLine{1414     \textcolor{keywordflow}{return} \&ring\_buffer[index * ring\_buffer\_length];}
\DoxyCodeLine{1415 \}}
\DoxyCodeLine{1416 }
\DoxyCodeLine{1417 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbir\_\_add\_empty\_ring\_buffer\_entry(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1418 \{}
\DoxyCodeLine{1419     \textcolor{keywordtype}{int} ring\_buffer\_index;}
\DoxyCodeLine{1420     \textcolor{keywordtype}{float}* ring\_buffer;}
\DoxyCodeLine{1421 }
\DoxyCodeLine{1422     stbir\_info-\/>ring\_buffer\_last\_scanline = n;}
\DoxyCodeLine{1423 }
\DoxyCodeLine{1424     \textcolor{keywordflow}{if} (stbir\_info-\/>ring\_buffer\_begin\_index < 0)}
\DoxyCodeLine{1425     \{}
\DoxyCodeLine{1426         ring\_buffer\_index = stbir\_info-\/>ring\_buffer\_begin\_index = 0;}
\DoxyCodeLine{1427         stbir\_info-\/>ring\_buffer\_first\_scanline = n;}
\DoxyCodeLine{1428     \}}
\DoxyCodeLine{1429     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1430     \{}
\DoxyCodeLine{1431         ring\_buffer\_index = (stbir\_info-\/>ring\_buffer\_begin\_index + (stbir\_info-\/>ring\_buffer\_last\_scanline -\/ stbir\_info-\/>ring\_buffer\_first\_scanline)) \% stbir\_info-\/>ring\_buffer\_num\_entries;}
\DoxyCodeLine{1432         STBIR\_ASSERT(ring\_buffer\_index != stbir\_info-\/>ring\_buffer\_begin\_index);}
\DoxyCodeLine{1433     \}}
\DoxyCodeLine{1434 }
\DoxyCodeLine{1435     ring\_buffer = stbir\_\_get\_ring\_buffer\_entry(stbir\_info-\/>ring\_buffer, ring\_buffer\_index, stbir\_info-\/>ring\_buffer\_length\_bytes / \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{1436     memset(ring\_buffer, 0, stbir\_info-\/>ring\_buffer\_length\_bytes);}
\DoxyCodeLine{1437 }
\DoxyCodeLine{1438     \textcolor{keywordflow}{return} ring\_buffer;}
\DoxyCodeLine{1439 \}}
\DoxyCodeLine{1440 }
\DoxyCodeLine{1441 }
\DoxyCodeLine{1442 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_resample\_horizontal\_upsample(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{float}* output\_buffer)}
\DoxyCodeLine{1443 \{}
\DoxyCodeLine{1444     \textcolor{keywordtype}{int} x, k;}
\DoxyCodeLine{1445     \textcolor{keywordtype}{int} output\_w = stbir\_info-\/>output\_w;}
\DoxyCodeLine{1446     \textcolor{keywordtype}{int} channels = stbir\_info-\/>channels;}
\DoxyCodeLine{1447     \textcolor{keywordtype}{float}* decode\_buffer = stbir\_\_get\_decode\_buffer(stbir\_info);}
\DoxyCodeLine{1448     stbir\_\_contributors* horizontal\_contributors = stbir\_info-\/>horizontal\_contributors;}
\DoxyCodeLine{1449     \textcolor{keywordtype}{float}* horizontal\_coefficients = stbir\_info-\/>horizontal\_coefficients;}
\DoxyCodeLine{1450     \textcolor{keywordtype}{int} coefficient\_width = stbir\_info-\/>horizontal\_coefficient\_width;}
\DoxyCodeLine{1451 }
\DoxyCodeLine{1452     \textcolor{keywordflow}{for} (x = 0; x < output\_w; x++)}
\DoxyCodeLine{1453     \{}
\DoxyCodeLine{1454         \textcolor{keywordtype}{int} n0 = horizontal\_contributors[x].n0;}
\DoxyCodeLine{1455         \textcolor{keywordtype}{int} n1 = horizontal\_contributors[x].n1;}
\DoxyCodeLine{1456 }
\DoxyCodeLine{1457         \textcolor{keywordtype}{int} out\_pixel\_index = x * channels;}
\DoxyCodeLine{1458         \textcolor{keywordtype}{int} coefficient\_group = coefficient\_width * x;}
\DoxyCodeLine{1459         \textcolor{keywordtype}{int} coefficient\_counter = 0;}
\DoxyCodeLine{1460 }
\DoxyCodeLine{1461         STBIR\_ASSERT(n1 >= n0);}
\DoxyCodeLine{1462         STBIR\_ASSERT(n0 >= -\/stbir\_info-\/>horizontal\_filter\_pixel\_margin);}
\DoxyCodeLine{1463         STBIR\_ASSERT(n1 >= -\/stbir\_info-\/>horizontal\_filter\_pixel\_margin);}
\DoxyCodeLine{1464         STBIR\_ASSERT(n0 < stbir\_info-\/>input\_w + stbir\_info-\/>horizontal\_filter\_pixel\_margin);}
\DoxyCodeLine{1465         STBIR\_ASSERT(n1 < stbir\_info-\/>input\_w + stbir\_info-\/>horizontal\_filter\_pixel\_margin);}
\DoxyCodeLine{1466 }
\DoxyCodeLine{1467         \textcolor{keywordflow}{switch} (channels) \{}
\DoxyCodeLine{1468             \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{1469                 \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1470                 \{}
\DoxyCodeLine{1471                     \textcolor{keywordtype}{int} in\_pixel\_index = k * 1;}
\DoxyCodeLine{1472                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + coefficient\_counter++];}
\DoxyCodeLine{1473                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1474                     output\_buffer[out\_pixel\_index + 0] += decode\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1475                 \}}
\DoxyCodeLine{1476                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1477             \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{1478                 \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1479                 \{}
\DoxyCodeLine{1480                     \textcolor{keywordtype}{int} in\_pixel\_index = k * 2;}
\DoxyCodeLine{1481                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + coefficient\_counter++];}
\DoxyCodeLine{1482                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1483                     output\_buffer[out\_pixel\_index + 0] += decode\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1484                     output\_buffer[out\_pixel\_index + 1] += decode\_buffer[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{1485                 \}}
\DoxyCodeLine{1486                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1487             \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{1488                 \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1489                 \{}
\DoxyCodeLine{1490                     \textcolor{keywordtype}{int} in\_pixel\_index = k * 3;}
\DoxyCodeLine{1491                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + coefficient\_counter++];}
\DoxyCodeLine{1492                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1493                     output\_buffer[out\_pixel\_index + 0] += decode\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1494                     output\_buffer[out\_pixel\_index + 1] += decode\_buffer[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{1495                     output\_buffer[out\_pixel\_index + 2] += decode\_buffer[in\_pixel\_index + 2] * coefficient;}
\DoxyCodeLine{1496                 \}}
\DoxyCodeLine{1497                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1498             \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{1499                 \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1500                 \{}
\DoxyCodeLine{1501                     \textcolor{keywordtype}{int} in\_pixel\_index = k * 4;}
\DoxyCodeLine{1502                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + coefficient\_counter++];}
\DoxyCodeLine{1503                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1504                     output\_buffer[out\_pixel\_index + 0] += decode\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1505                     output\_buffer[out\_pixel\_index + 1] += decode\_buffer[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{1506                     output\_buffer[out\_pixel\_index + 2] += decode\_buffer[in\_pixel\_index + 2] * coefficient;}
\DoxyCodeLine{1507                     output\_buffer[out\_pixel\_index + 3] += decode\_buffer[in\_pixel\_index + 3] * coefficient;}
\DoxyCodeLine{1508                 \}}
\DoxyCodeLine{1509                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1510             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{1511                 \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1512                 \{}
\DoxyCodeLine{1513                     \textcolor{keywordtype}{int} in\_pixel\_index = k * channels;}
\DoxyCodeLine{1514                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + coefficient\_counter++];}
\DoxyCodeLine{1515                     \textcolor{keywordtype}{int} c;}
\DoxyCodeLine{1516                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1517                     \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1518                         output\_buffer[out\_pixel\_index + c] += decode\_buffer[in\_pixel\_index + c] * coefficient;}
\DoxyCodeLine{1519                 \}}
\DoxyCodeLine{1520                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1521         \}}
\DoxyCodeLine{1522     \}}
\DoxyCodeLine{1523 \}}
\DoxyCodeLine{1524 }
\DoxyCodeLine{1525 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_resample\_horizontal\_downsample(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{float}* output\_buffer)}
\DoxyCodeLine{1526 \{}
\DoxyCodeLine{1527     \textcolor{keywordtype}{int} x, k;}
\DoxyCodeLine{1528     \textcolor{keywordtype}{int} input\_w = stbir\_info-\/>input\_w;}
\DoxyCodeLine{1529     \textcolor{keywordtype}{int} channels = stbir\_info-\/>channels;}
\DoxyCodeLine{1530     \textcolor{keywordtype}{float}* decode\_buffer = stbir\_\_get\_decode\_buffer(stbir\_info);}
\DoxyCodeLine{1531     stbir\_\_contributors* horizontal\_contributors = stbir\_info-\/>horizontal\_contributors;}
\DoxyCodeLine{1532     \textcolor{keywordtype}{float}* horizontal\_coefficients = stbir\_info-\/>horizontal\_coefficients;}
\DoxyCodeLine{1533     \textcolor{keywordtype}{int} coefficient\_width = stbir\_info-\/>horizontal\_coefficient\_width;}
\DoxyCodeLine{1534     \textcolor{keywordtype}{int} filter\_pixel\_margin = stbir\_info-\/>horizontal\_filter\_pixel\_margin;}
\DoxyCodeLine{1535     \textcolor{keywordtype}{int} max\_x = input\_w + filter\_pixel\_margin * 2;}
\DoxyCodeLine{1536 }
\DoxyCodeLine{1537     STBIR\_ASSERT(!stbir\_\_use\_width\_upsampling(stbir\_info));}
\DoxyCodeLine{1538 }
\DoxyCodeLine{1539     \textcolor{keywordflow}{switch} (channels) \{}
\DoxyCodeLine{1540         \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{1541             \textcolor{keywordflow}{for} (x = 0; x < max\_x; x++)}
\DoxyCodeLine{1542             \{}
\DoxyCodeLine{1543                 \textcolor{keywordtype}{int} n0 = horizontal\_contributors[x].n0;}
\DoxyCodeLine{1544                 \textcolor{keywordtype}{int} n1 = horizontal\_contributors[x].n1;}
\DoxyCodeLine{1545 }
\DoxyCodeLine{1546                 \textcolor{keywordtype}{int} in\_x = x -\/ filter\_pixel\_margin;}
\DoxyCodeLine{1547                 \textcolor{keywordtype}{int} in\_pixel\_index = in\_x * 1;}
\DoxyCodeLine{1548                 \textcolor{keywordtype}{int} max\_n = n1;}
\DoxyCodeLine{1549                 \textcolor{keywordtype}{int} coefficient\_group = coefficient\_width * x;}
\DoxyCodeLine{1550 }
\DoxyCodeLine{1551                 \textcolor{keywordflow}{for} (k = n0; k <= max\_n; k++)}
\DoxyCodeLine{1552                 \{}
\DoxyCodeLine{1553                     \textcolor{keywordtype}{int} out\_pixel\_index = k * 1;}
\DoxyCodeLine{1554                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + k -\/ n0];}
\DoxyCodeLine{1555                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1556                     output\_buffer[out\_pixel\_index + 0] += decode\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1557                 \}}
\DoxyCodeLine{1558             \}}
\DoxyCodeLine{1559             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1560 }
\DoxyCodeLine{1561         \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{1562             \textcolor{keywordflow}{for} (x = 0; x < max\_x; x++)}
\DoxyCodeLine{1563             \{}
\DoxyCodeLine{1564                 \textcolor{keywordtype}{int} n0 = horizontal\_contributors[x].n0;}
\DoxyCodeLine{1565                 \textcolor{keywordtype}{int} n1 = horizontal\_contributors[x].n1;}
\DoxyCodeLine{1566 }
\DoxyCodeLine{1567                 \textcolor{keywordtype}{int} in\_x = x -\/ filter\_pixel\_margin;}
\DoxyCodeLine{1568                 \textcolor{keywordtype}{int} in\_pixel\_index = in\_x * 2;}
\DoxyCodeLine{1569                 \textcolor{keywordtype}{int} max\_n = n1;}
\DoxyCodeLine{1570                 \textcolor{keywordtype}{int} coefficient\_group = coefficient\_width * x;}
\DoxyCodeLine{1571 }
\DoxyCodeLine{1572                 \textcolor{keywordflow}{for} (k = n0; k <= max\_n; k++)}
\DoxyCodeLine{1573                 \{}
\DoxyCodeLine{1574                     \textcolor{keywordtype}{int} out\_pixel\_index = k * 2;}
\DoxyCodeLine{1575                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + k -\/ n0];}
\DoxyCodeLine{1576                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1577                     output\_buffer[out\_pixel\_index + 0] += decode\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1578                     output\_buffer[out\_pixel\_index + 1] += decode\_buffer[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{1579                 \}}
\DoxyCodeLine{1580             \}}
\DoxyCodeLine{1581             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1582 }
\DoxyCodeLine{1583         \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{1584             \textcolor{keywordflow}{for} (x = 0; x < max\_x; x++)}
\DoxyCodeLine{1585             \{}
\DoxyCodeLine{1586                 \textcolor{keywordtype}{int} n0 = horizontal\_contributors[x].n0;}
\DoxyCodeLine{1587                 \textcolor{keywordtype}{int} n1 = horizontal\_contributors[x].n1;}
\DoxyCodeLine{1588 }
\DoxyCodeLine{1589                 \textcolor{keywordtype}{int} in\_x = x -\/ filter\_pixel\_margin;}
\DoxyCodeLine{1590                 \textcolor{keywordtype}{int} in\_pixel\_index = in\_x * 3;}
\DoxyCodeLine{1591                 \textcolor{keywordtype}{int} max\_n = n1;}
\DoxyCodeLine{1592                 \textcolor{keywordtype}{int} coefficient\_group = coefficient\_width * x;}
\DoxyCodeLine{1593 }
\DoxyCodeLine{1594                 \textcolor{keywordflow}{for} (k = n0; k <= max\_n; k++)}
\DoxyCodeLine{1595                 \{}
\DoxyCodeLine{1596                     \textcolor{keywordtype}{int} out\_pixel\_index = k * 3;}
\DoxyCodeLine{1597                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + k -\/ n0];}
\DoxyCodeLine{1598                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1599                     output\_buffer[out\_pixel\_index + 0] += decode\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1600                     output\_buffer[out\_pixel\_index + 1] += decode\_buffer[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{1601                     output\_buffer[out\_pixel\_index + 2] += decode\_buffer[in\_pixel\_index + 2] * coefficient;}
\DoxyCodeLine{1602                 \}}
\DoxyCodeLine{1603             \}}
\DoxyCodeLine{1604             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1605 }
\DoxyCodeLine{1606         \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{1607             \textcolor{keywordflow}{for} (x = 0; x < max\_x; x++)}
\DoxyCodeLine{1608             \{}
\DoxyCodeLine{1609                 \textcolor{keywordtype}{int} n0 = horizontal\_contributors[x].n0;}
\DoxyCodeLine{1610                 \textcolor{keywordtype}{int} n1 = horizontal\_contributors[x].n1;}
\DoxyCodeLine{1611 }
\DoxyCodeLine{1612                 \textcolor{keywordtype}{int} in\_x = x -\/ filter\_pixel\_margin;}
\DoxyCodeLine{1613                 \textcolor{keywordtype}{int} in\_pixel\_index = in\_x * 4;}
\DoxyCodeLine{1614                 \textcolor{keywordtype}{int} max\_n = n1;}
\DoxyCodeLine{1615                 \textcolor{keywordtype}{int} coefficient\_group = coefficient\_width * x;}
\DoxyCodeLine{1616 }
\DoxyCodeLine{1617                 \textcolor{keywordflow}{for} (k = n0; k <= max\_n; k++)}
\DoxyCodeLine{1618                 \{}
\DoxyCodeLine{1619                     \textcolor{keywordtype}{int} out\_pixel\_index = k * 4;}
\DoxyCodeLine{1620                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + k -\/ n0];}
\DoxyCodeLine{1621                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1622                     output\_buffer[out\_pixel\_index + 0] += decode\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1623                     output\_buffer[out\_pixel\_index + 1] += decode\_buffer[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{1624                     output\_buffer[out\_pixel\_index + 2] += decode\_buffer[in\_pixel\_index + 2] * coefficient;}
\DoxyCodeLine{1625                     output\_buffer[out\_pixel\_index + 3] += decode\_buffer[in\_pixel\_index + 3] * coefficient;}
\DoxyCodeLine{1626                 \}}
\DoxyCodeLine{1627             \}}
\DoxyCodeLine{1628             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1629 }
\DoxyCodeLine{1630         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{1631             \textcolor{keywordflow}{for} (x = 0; x < max\_x; x++)}
\DoxyCodeLine{1632             \{}
\DoxyCodeLine{1633                 \textcolor{keywordtype}{int} n0 = horizontal\_contributors[x].n0;}
\DoxyCodeLine{1634                 \textcolor{keywordtype}{int} n1 = horizontal\_contributors[x].n1;}
\DoxyCodeLine{1635 }
\DoxyCodeLine{1636                 \textcolor{keywordtype}{int} in\_x = x -\/ filter\_pixel\_margin;}
\DoxyCodeLine{1637                 \textcolor{keywordtype}{int} in\_pixel\_index = in\_x * channels;}
\DoxyCodeLine{1638                 \textcolor{keywordtype}{int} max\_n = n1;}
\DoxyCodeLine{1639                 \textcolor{keywordtype}{int} coefficient\_group = coefficient\_width * x;}
\DoxyCodeLine{1640 }
\DoxyCodeLine{1641                 \textcolor{keywordflow}{for} (k = n0; k <= max\_n; k++)}
\DoxyCodeLine{1642                 \{}
\DoxyCodeLine{1643                     \textcolor{keywordtype}{int} c;}
\DoxyCodeLine{1644                     \textcolor{keywordtype}{int} out\_pixel\_index = k * channels;}
\DoxyCodeLine{1645                     \textcolor{keywordtype}{float} coefficient = horizontal\_coefficients[coefficient\_group + k -\/ n0];}
\DoxyCodeLine{1646                     STBIR\_ASSERT(coefficient != 0);}
\DoxyCodeLine{1647                     \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1648                         output\_buffer[out\_pixel\_index + c] += decode\_buffer[in\_pixel\_index + c] * coefficient;}
\DoxyCodeLine{1649                 \}}
\DoxyCodeLine{1650             \}}
\DoxyCodeLine{1651             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1652     \}}
\DoxyCodeLine{1653 \}}
\DoxyCodeLine{1654 }
\DoxyCodeLine{1655 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_decode\_and\_resample\_upsample(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1656 \{}
\DoxyCodeLine{1657     \textcolor{comment}{// Decode the nth scanline from the source image into the decode buffer.}}
\DoxyCodeLine{1658     stbir\_\_decode\_scanline(stbir\_info, n);}
\DoxyCodeLine{1659 }
\DoxyCodeLine{1660     \textcolor{comment}{// Now resample it into the ring buffer.}}
\DoxyCodeLine{1661     \textcolor{keywordflow}{if} (stbir\_\_use\_width\_upsampling(stbir\_info))}
\DoxyCodeLine{1662         stbir\_\_resample\_horizontal\_upsample(stbir\_info, stbir\_\_add\_empty\_ring\_buffer\_entry(stbir\_info, n));}
\DoxyCodeLine{1663     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1664         stbir\_\_resample\_horizontal\_downsample(stbir\_info, stbir\_\_add\_empty\_ring\_buffer\_entry(stbir\_info, n));}
\DoxyCodeLine{1665 }
\DoxyCodeLine{1666     \textcolor{comment}{// Now it's sitting in the ring buffer ready to be used as source for the vertical sampling.}}
\DoxyCodeLine{1667 \}}
\DoxyCodeLine{1668 }
\DoxyCodeLine{1669 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_decode\_and\_resample\_downsample(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1670 \{}
\DoxyCodeLine{1671     \textcolor{comment}{// Decode the nth scanline from the source image into the decode buffer.}}
\DoxyCodeLine{1672     stbir\_\_decode\_scanline(stbir\_info, n);}
\DoxyCodeLine{1673 }
\DoxyCodeLine{1674     memset(stbir\_info-\/>horizontal\_buffer, 0, stbir\_info-\/>output\_w * stbir\_info-\/>channels * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{1675 }
\DoxyCodeLine{1676     \textcolor{comment}{// Now resample it into the horizontal buffer.}}
\DoxyCodeLine{1677     \textcolor{keywordflow}{if} (stbir\_\_use\_width\_upsampling(stbir\_info))}
\DoxyCodeLine{1678         stbir\_\_resample\_horizontal\_upsample(stbir\_info, stbir\_info-\/>horizontal\_buffer);}
\DoxyCodeLine{1679     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1680         stbir\_\_resample\_horizontal\_downsample(stbir\_info, stbir\_info-\/>horizontal\_buffer);}
\DoxyCodeLine{1681 }
\DoxyCodeLine{1682     \textcolor{comment}{// Now it's sitting in the horizontal buffer ready to be distributed into the ring buffers.}}
\DoxyCodeLine{1683 \}}
\DoxyCodeLine{1684 }
\DoxyCodeLine{1685 \textcolor{comment}{// Get the specified scan line from the ring buffer.}}
\DoxyCodeLine{1686 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbir\_\_get\_ring\_buffer\_scanline(\textcolor{keywordtype}{int} get\_scanline, \textcolor{keywordtype}{float}* ring\_buffer, \textcolor{keywordtype}{int} begin\_index, \textcolor{keywordtype}{int} first\_scanline, \textcolor{keywordtype}{int} ring\_buffer\_num\_entries, \textcolor{keywordtype}{int} ring\_buffer\_length)}
\DoxyCodeLine{1687 \{}
\DoxyCodeLine{1688     \textcolor{keywordtype}{int} ring\_buffer\_index = (begin\_index + (get\_scanline -\/ first\_scanline)) \% ring\_buffer\_num\_entries;}
\DoxyCodeLine{1689     \textcolor{keywordflow}{return} stbir\_\_get\_ring\_buffer\_entry(ring\_buffer, ring\_buffer\_index, ring\_buffer\_length);}
\DoxyCodeLine{1690 \}}
\DoxyCodeLine{1691 }
\DoxyCodeLine{1692 }
\DoxyCodeLine{1693 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_encode\_scanline(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{int} num\_pixels, \textcolor{keywordtype}{void} *output\_buffer, \textcolor{keywordtype}{float} *encode\_buffer, \textcolor{keywordtype}{int} channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} decode)}
\DoxyCodeLine{1694 \{}
\DoxyCodeLine{1695     \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{1696     \textcolor{keywordtype}{int} n;}
\DoxyCodeLine{1697     \textcolor{keywordtype}{int} num\_nonalpha;}
\DoxyCodeLine{1698     stbir\_uint16 nonalpha[STBIR\_MAX\_CHANNELS];}
\DoxyCodeLine{1699 }
\DoxyCodeLine{1700     \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags\&STBIR\_FLAG\_ALPHA\_PREMULTIPLIED))}
\DoxyCodeLine{1701     \{}
\DoxyCodeLine{1702         \textcolor{keywordflow}{for} (x=0; x < num\_pixels; ++x)}
\DoxyCodeLine{1703         \{}
\DoxyCodeLine{1704             \textcolor{keywordtype}{int} pixel\_index = x*channels;}
\DoxyCodeLine{1705 }
\DoxyCodeLine{1706             \textcolor{keywordtype}{float} alpha = encode\_buffer[pixel\_index + alpha\_channel];}
\DoxyCodeLine{1707             \textcolor{keywordtype}{float} reciprocal\_alpha = alpha ? 1.0f / alpha : 0;}
\DoxyCodeLine{1708 }
\DoxyCodeLine{1709             \textcolor{comment}{// unrolling this produced a 1\% slowdown upscaling a large RGBA linear-\/space image on my machine -\/ stb}}
\DoxyCodeLine{1710             \textcolor{keywordflow}{for} (n = 0; n < channels; n++)}
\DoxyCodeLine{1711                 \textcolor{keywordflow}{if} (n != alpha\_channel)}
\DoxyCodeLine{1712                     encode\_buffer[pixel\_index + n] *= reciprocal\_alpha;}
\DoxyCodeLine{1713 }
\DoxyCodeLine{1714             \textcolor{comment}{// We added in a small epsilon to prevent the color channel from being deleted with zero alpha.}}
\DoxyCodeLine{1715             \textcolor{comment}{// Because we only add it for integer types, it will automatically be discarded on integer}}
\DoxyCodeLine{1716             \textcolor{comment}{// conversion, so we don't need to subtract it back out (which would be problematic for}}
\DoxyCodeLine{1717             \textcolor{comment}{// numeric precision reasons).}}
\DoxyCodeLine{1718         \}}
\DoxyCodeLine{1719     \}}
\DoxyCodeLine{1720 }
\DoxyCodeLine{1721     \textcolor{comment}{// build a table of all channels that need colorspace correction, so}}
\DoxyCodeLine{1722     \textcolor{comment}{// we don't perform colorspace correction on channels that don't need it.}}
\DoxyCodeLine{1723     \textcolor{keywordflow}{for} (x = 0, num\_nonalpha = 0; x < channels; ++x)}
\DoxyCodeLine{1724     \{}
\DoxyCodeLine{1725         \textcolor{keywordflow}{if} (x != alpha\_channel || (stbir\_info-\/>flags \& STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE))}
\DoxyCodeLine{1726         \{}
\DoxyCodeLine{1727             nonalpha[num\_nonalpha++] = (stbir\_uint16)x;}
\DoxyCodeLine{1728         \}}
\DoxyCodeLine{1729     \}}
\DoxyCodeLine{1730 }
\DoxyCodeLine{1731 \textcolor{preprocessor}{    \#define STBIR\_\_ROUND\_INT(f)    ((int)          ((f)+0.5))}}
\DoxyCodeLine{1732 \textcolor{preprocessor}{    \#define STBIR\_\_ROUND\_UINT(f)   ((stbir\_uint32) ((f)+0.5))}}
\DoxyCodeLine{1733 }
\DoxyCodeLine{1734 \textcolor{preprocessor}{    \#ifdef STBIR\_\_SATURATE\_INT}}
\DoxyCodeLine{1735 \textcolor{preprocessor}{    \#define STBIR\_\_ENCODE\_LINEAR8(f)   stbir\_\_saturate8 (STBIR\_\_ROUND\_INT((f) * stbir\_\_max\_uint8\_as\_float ))}}
\DoxyCodeLine{1736 \textcolor{preprocessor}{    \#define STBIR\_\_ENCODE\_LINEAR16(f)  stbir\_\_saturate16(STBIR\_\_ROUND\_INT((f) * stbir\_\_max\_uint16\_as\_float))}}
\DoxyCodeLine{1737 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1738 \textcolor{preprocessor}{    \#define STBIR\_\_ENCODE\_LINEAR8(f)   (unsigned char ) STBIR\_\_ROUND\_INT(stbir\_\_saturate(f) * stbir\_\_max\_uint8\_as\_float )}}
\DoxyCodeLine{1739 \textcolor{preprocessor}{    \#define STBIR\_\_ENCODE\_LINEAR16(f)  (unsigned short) STBIR\_\_ROUND\_INT(stbir\_\_saturate(f) * stbir\_\_max\_uint16\_as\_float)}}
\DoxyCodeLine{1740 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1741 }
\DoxyCodeLine{1742     \textcolor{keywordflow}{switch} (decode)}
\DoxyCodeLine{1743     \{}
\DoxyCodeLine{1744         \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT8, STBIR\_COLORSPACE\_LINEAR):}
\DoxyCodeLine{1745             for (x=0; x < num\_pixels; ++x)}
\DoxyCodeLine{1746             \{}
\DoxyCodeLine{1747                 \textcolor{keywordtype}{int} pixel\_index = x*channels;}
\DoxyCodeLine{1748 }
\DoxyCodeLine{1749                 \textcolor{keywordflow}{for} (n = 0; n < channels; n++)}
\DoxyCodeLine{1750                 \{}
\DoxyCodeLine{1751                     \textcolor{keywordtype}{int} index = pixel\_index + n;}
\DoxyCodeLine{1752                     ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)output\_buffer)[index] = STBIR\_\_ENCODE\_LINEAR8(encode\_buffer[index]);}
\DoxyCodeLine{1753                 \}}
\DoxyCodeLine{1754             \}}
\DoxyCodeLine{1755             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1756 }
\DoxyCodeLine{1757         \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT8, STBIR\_COLORSPACE\_SRGB):}
\DoxyCodeLine{1758             for (x=0; x < num\_pixels; ++x)}
\DoxyCodeLine{1759             \{}
\DoxyCodeLine{1760                 \textcolor{keywordtype}{int} pixel\_index = x*channels;}
\DoxyCodeLine{1761 }
\DoxyCodeLine{1762                 \textcolor{keywordflow}{for} (n = 0; n < num\_nonalpha; n++)}
\DoxyCodeLine{1763                 \{}
\DoxyCodeLine{1764                     \textcolor{keywordtype}{int} index = pixel\_index + nonalpha[n];}
\DoxyCodeLine{1765                     ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)output\_buffer)[index] = stbir\_\_linear\_to\_srgb\_uchar(encode\_buffer[index]);}
\DoxyCodeLine{1766                 \}}
\DoxyCodeLine{1767 }
\DoxyCodeLine{1768                 \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags \& STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE))}
\DoxyCodeLine{1769                     ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)output\_buffer)[pixel\_index + alpha\_channel] = STBIR\_\_ENCODE\_LINEAR8(encode\_buffer[pixel\_index+alpha\_channel]);}
\DoxyCodeLine{1770             \}}
\DoxyCodeLine{1771             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1772 }
\DoxyCodeLine{1773         \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT16, STBIR\_COLORSPACE\_LINEAR):}
\DoxyCodeLine{1774             for (x=0; x < num\_pixels; ++x)}
\DoxyCodeLine{1775             \{}
\DoxyCodeLine{1776                 \textcolor{keywordtype}{int} pixel\_index = x*channels;}
\DoxyCodeLine{1777 }
\DoxyCodeLine{1778                 \textcolor{keywordflow}{for} (n = 0; n < channels; n++)}
\DoxyCodeLine{1779                 \{}
\DoxyCodeLine{1780                     \textcolor{keywordtype}{int} index = pixel\_index + n;}
\DoxyCodeLine{1781                     ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}*)output\_buffer)[index] = STBIR\_\_ENCODE\_LINEAR16(encode\_buffer[index]);}
\DoxyCodeLine{1782                 \}}
\DoxyCodeLine{1783             \}}
\DoxyCodeLine{1784             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1785 }
\DoxyCodeLine{1786         \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT16, STBIR\_COLORSPACE\_SRGB):}
\DoxyCodeLine{1787             for (x=0; x < num\_pixels; ++x)}
\DoxyCodeLine{1788             \{}
\DoxyCodeLine{1789                 \textcolor{keywordtype}{int} pixel\_index = x*channels;}
\DoxyCodeLine{1790 }
\DoxyCodeLine{1791                 \textcolor{keywordflow}{for} (n = 0; n < num\_nonalpha; n++)}
\DoxyCodeLine{1792                 \{}
\DoxyCodeLine{1793                     \textcolor{keywordtype}{int} index = pixel\_index + nonalpha[n];}
\DoxyCodeLine{1794                     ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}*)output\_buffer)[index] = (\textcolor{keywordtype}{unsigned} short)STBIR\_\_ROUND\_INT(stbir\_\_linear\_to\_srgb(stbir\_\_saturate(encode\_buffer[index])) * stbir\_\_max\_uint16\_as\_float);}
\DoxyCodeLine{1795                 \}}
\DoxyCodeLine{1796 }
\DoxyCodeLine{1797                 \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags\&STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE))}
\DoxyCodeLine{1798                     ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}*)output\_buffer)[pixel\_index + alpha\_channel] = STBIR\_\_ENCODE\_LINEAR16(encode\_buffer[pixel\_index + alpha\_channel]);}
\DoxyCodeLine{1799             \}}
\DoxyCodeLine{1800 }
\DoxyCodeLine{1801             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1802 }
\DoxyCodeLine{1803         \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT32, STBIR\_COLORSPACE\_LINEAR):}
\DoxyCodeLine{1804             for (x=0; x < num\_pixels; ++x)}
\DoxyCodeLine{1805             \{}
\DoxyCodeLine{1806                 \textcolor{keywordtype}{int} pixel\_index = x*channels;}
\DoxyCodeLine{1807 }
\DoxyCodeLine{1808                 \textcolor{keywordflow}{for} (n = 0; n < channels; n++)}
\DoxyCodeLine{1809                 \{}
\DoxyCodeLine{1810                     \textcolor{keywordtype}{int} index = pixel\_index + n;}
\DoxyCodeLine{1811                     ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}*)output\_buffer)[index] = (\textcolor{keywordtype}{unsigned} int)STBIR\_\_ROUND\_UINT(((\textcolor{keywordtype}{double})stbir\_\_saturate(encode\_buffer[index])) * stbir\_\_max\_uint32\_as\_float);}
\DoxyCodeLine{1812                 \}}
\DoxyCodeLine{1813             \}}
\DoxyCodeLine{1814             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1815 }
\DoxyCodeLine{1816         \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_UINT32, STBIR\_COLORSPACE\_SRGB):}
\DoxyCodeLine{1817             for (x=0; x < num\_pixels; ++x)}
\DoxyCodeLine{1818             \{}
\DoxyCodeLine{1819                 \textcolor{keywordtype}{int} pixel\_index = x*channels;}
\DoxyCodeLine{1820 }
\DoxyCodeLine{1821                 \textcolor{keywordflow}{for} (n = 0; n < num\_nonalpha; n++)}
\DoxyCodeLine{1822                 \{}
\DoxyCodeLine{1823                     \textcolor{keywordtype}{int} index = pixel\_index + nonalpha[n];}
\DoxyCodeLine{1824                     ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}*)output\_buffer)[index] = (\textcolor{keywordtype}{unsigned} int)STBIR\_\_ROUND\_UINT(((\textcolor{keywordtype}{double})stbir\_\_linear\_to\_srgb(stbir\_\_saturate(encode\_buffer[index]))) * stbir\_\_max\_uint32\_as\_float);}
\DoxyCodeLine{1825                 \}}
\DoxyCodeLine{1826 }
\DoxyCodeLine{1827                 \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags\&STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE))}
\DoxyCodeLine{1828                     ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}*)output\_buffer)[pixel\_index + alpha\_channel] = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})STBIR\_\_ROUND\_INT(((\textcolor{keywordtype}{double})stbir\_\_saturate(encode\_buffer[pixel\_index + alpha\_channel])) * stbir\_\_max\_uint32\_as\_float);}
\DoxyCodeLine{1829             \}}
\DoxyCodeLine{1830             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1831 }
\DoxyCodeLine{1832         \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_FLOAT, STBIR\_COLORSPACE\_LINEAR):}
\DoxyCodeLine{1833             for (x=0; x < num\_pixels; ++x)}
\DoxyCodeLine{1834             \{}
\DoxyCodeLine{1835                 \textcolor{keywordtype}{int} pixel\_index = x*channels;}
\DoxyCodeLine{1836 }
\DoxyCodeLine{1837                 \textcolor{keywordflow}{for} (n = 0; n < channels; n++)}
\DoxyCodeLine{1838                 \{}
\DoxyCodeLine{1839                     \textcolor{keywordtype}{int} index = pixel\_index + n;}
\DoxyCodeLine{1840                     ((\textcolor{keywordtype}{float}*)output\_buffer)[index] = encode\_buffer[index];}
\DoxyCodeLine{1841                 \}}
\DoxyCodeLine{1842             \}}
\DoxyCodeLine{1843             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1844 }
\DoxyCodeLine{1845         \textcolor{keywordflow}{case} STBIR\_\_DECODE(STBIR\_TYPE\_FLOAT, STBIR\_COLORSPACE\_SRGB):}
\DoxyCodeLine{1846             for (x=0; x < num\_pixels; ++x)}
\DoxyCodeLine{1847             \{}
\DoxyCodeLine{1848                 \textcolor{keywordtype}{int} pixel\_index = x*channels;}
\DoxyCodeLine{1849 }
\DoxyCodeLine{1850                 \textcolor{keywordflow}{for} (n = 0; n < num\_nonalpha; n++)}
\DoxyCodeLine{1851                 \{}
\DoxyCodeLine{1852                     \textcolor{keywordtype}{int} index = pixel\_index + nonalpha[n];}
\DoxyCodeLine{1853                     ((\textcolor{keywordtype}{float}*)output\_buffer)[index] = stbir\_\_linear\_to\_srgb(encode\_buffer[index]);}
\DoxyCodeLine{1854                 \}}
\DoxyCodeLine{1855 }
\DoxyCodeLine{1856                 \textcolor{keywordflow}{if} (!(stbir\_info-\/>flags\&STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE))}
\DoxyCodeLine{1857                     ((\textcolor{keywordtype}{float}*)output\_buffer)[pixel\_index + alpha\_channel] = encode\_buffer[pixel\_index + alpha\_channel];}
\DoxyCodeLine{1858             \}}
\DoxyCodeLine{1859             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1860 }
\DoxyCodeLine{1861         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{1862             STBIR\_ASSERT(!\textcolor{stringliteral}{"{}Unknown type/colorspace/channels combination."{}});}
\DoxyCodeLine{1863             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1864     \}}
\DoxyCodeLine{1865 \}}
\DoxyCodeLine{1866 }
\DoxyCodeLine{1867 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_resample\_vertical\_upsample(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1868 \{}
\DoxyCodeLine{1869     \textcolor{keywordtype}{int} x, k;}
\DoxyCodeLine{1870     \textcolor{keywordtype}{int} output\_w = stbir\_info-\/>output\_w;}
\DoxyCodeLine{1871     stbir\_\_contributors* vertical\_contributors = stbir\_info-\/>vertical\_contributors;}
\DoxyCodeLine{1872     \textcolor{keywordtype}{float}* vertical\_coefficients = stbir\_info-\/>vertical\_coefficients;}
\DoxyCodeLine{1873     \textcolor{keywordtype}{int} channels = stbir\_info-\/>channels;}
\DoxyCodeLine{1874     \textcolor{keywordtype}{int} alpha\_channel = stbir\_info-\/>alpha\_channel;}
\DoxyCodeLine{1875     \textcolor{keywordtype}{int} type = stbir\_info-\/>type;}
\DoxyCodeLine{1876     \textcolor{keywordtype}{int} colorspace = stbir\_info-\/>colorspace;}
\DoxyCodeLine{1877     \textcolor{keywordtype}{int} ring\_buffer\_entries = stbir\_info-\/>ring\_buffer\_num\_entries;}
\DoxyCodeLine{1878     \textcolor{keywordtype}{void}* output\_data = stbir\_info-\/>output\_data;}
\DoxyCodeLine{1879     \textcolor{keywordtype}{float}* encode\_buffer = stbir\_info-\/>encode\_buffer;}
\DoxyCodeLine{1880     \textcolor{keywordtype}{int} decode = STBIR\_\_DECODE(type, colorspace);}
\DoxyCodeLine{1881     \textcolor{keywordtype}{int} coefficient\_width = stbir\_info-\/>vertical\_coefficient\_width;}
\DoxyCodeLine{1882     \textcolor{keywordtype}{int} coefficient\_counter;}
\DoxyCodeLine{1883     \textcolor{keywordtype}{int} contributor = n;}
\DoxyCodeLine{1884 }
\DoxyCodeLine{1885     \textcolor{keywordtype}{float}* ring\_buffer = stbir\_info-\/>ring\_buffer;}
\DoxyCodeLine{1886     \textcolor{keywordtype}{int} ring\_buffer\_begin\_index = stbir\_info-\/>ring\_buffer\_begin\_index;}
\DoxyCodeLine{1887     \textcolor{keywordtype}{int} ring\_buffer\_first\_scanline = stbir\_info-\/>ring\_buffer\_first\_scanline;}
\DoxyCodeLine{1888     \textcolor{keywordtype}{int} ring\_buffer\_length = stbir\_info-\/>ring\_buffer\_length\_bytes/\textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{1889 }
\DoxyCodeLine{1890     \textcolor{keywordtype}{int} n0,n1, output\_row\_start;}
\DoxyCodeLine{1891     \textcolor{keywordtype}{int} coefficient\_group = coefficient\_width * contributor;}
\DoxyCodeLine{1892 }
\DoxyCodeLine{1893     n0 = vertical\_contributors[contributor].n0;}
\DoxyCodeLine{1894     n1 = vertical\_contributors[contributor].n1;}
\DoxyCodeLine{1895 }
\DoxyCodeLine{1896     output\_row\_start = n * stbir\_info-\/>output\_stride\_bytes;}
\DoxyCodeLine{1897 }
\DoxyCodeLine{1898     STBIR\_ASSERT(stbir\_\_use\_height\_upsampling(stbir\_info));}
\DoxyCodeLine{1899 }
\DoxyCodeLine{1900     memset(encode\_buffer, 0, output\_w * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}) * channels);}
\DoxyCodeLine{1901 }
\DoxyCodeLine{1902     \textcolor{comment}{// I tried reblocking this for better cache usage of encode\_buffer}}
\DoxyCodeLine{1903     \textcolor{comment}{// (using x\_outer, k, x\_inner), but it lost speed. -\/-\/ stb}}
\DoxyCodeLine{1904 }
\DoxyCodeLine{1905     coefficient\_counter = 0;}
\DoxyCodeLine{1906     \textcolor{keywordflow}{switch} (channels) \{}
\DoxyCodeLine{1907         \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{1908             \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1909             \{}
\DoxyCodeLine{1910                 \textcolor{keywordtype}{int} coefficient\_index = coefficient\_counter++;}
\DoxyCodeLine{1911                 \textcolor{keywordtype}{float}* ring\_buffer\_entry = stbir\_\_get\_ring\_buffer\_scanline(k, ring\_buffer, ring\_buffer\_begin\_index, ring\_buffer\_first\_scanline, ring\_buffer\_entries, ring\_buffer\_length);}
\DoxyCodeLine{1912                 \textcolor{keywordtype}{float} coefficient = vertical\_coefficients[coefficient\_group + coefficient\_index];}
\DoxyCodeLine{1913                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; ++x)}
\DoxyCodeLine{1914                 \{}
\DoxyCodeLine{1915                     \textcolor{keywordtype}{int} in\_pixel\_index = x * 1;}
\DoxyCodeLine{1916                     encode\_buffer[in\_pixel\_index + 0] += ring\_buffer\_entry[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1917                 \}}
\DoxyCodeLine{1918             \}}
\DoxyCodeLine{1919             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1920         \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{1921             \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1922             \{}
\DoxyCodeLine{1923                 \textcolor{keywordtype}{int} coefficient\_index = coefficient\_counter++;}
\DoxyCodeLine{1924                 \textcolor{keywordtype}{float}* ring\_buffer\_entry = stbir\_\_get\_ring\_buffer\_scanline(k, ring\_buffer, ring\_buffer\_begin\_index, ring\_buffer\_first\_scanline, ring\_buffer\_entries, ring\_buffer\_length);}
\DoxyCodeLine{1925                 \textcolor{keywordtype}{float} coefficient = vertical\_coefficients[coefficient\_group + coefficient\_index];}
\DoxyCodeLine{1926                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; ++x)}
\DoxyCodeLine{1927                 \{}
\DoxyCodeLine{1928                     \textcolor{keywordtype}{int} in\_pixel\_index = x * 2;}
\DoxyCodeLine{1929                     encode\_buffer[in\_pixel\_index + 0] += ring\_buffer\_entry[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1930                     encode\_buffer[in\_pixel\_index + 1] += ring\_buffer\_entry[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{1931                 \}}
\DoxyCodeLine{1932             \}}
\DoxyCodeLine{1933             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1934         \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{1935             \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1936             \{}
\DoxyCodeLine{1937                 \textcolor{keywordtype}{int} coefficient\_index = coefficient\_counter++;}
\DoxyCodeLine{1938                 \textcolor{keywordtype}{float}* ring\_buffer\_entry = stbir\_\_get\_ring\_buffer\_scanline(k, ring\_buffer, ring\_buffer\_begin\_index, ring\_buffer\_first\_scanline, ring\_buffer\_entries, ring\_buffer\_length);}
\DoxyCodeLine{1939                 \textcolor{keywordtype}{float} coefficient = vertical\_coefficients[coefficient\_group + coefficient\_index];}
\DoxyCodeLine{1940                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; ++x)}
\DoxyCodeLine{1941                 \{}
\DoxyCodeLine{1942                     \textcolor{keywordtype}{int} in\_pixel\_index = x * 3;}
\DoxyCodeLine{1943                     encode\_buffer[in\_pixel\_index + 0] += ring\_buffer\_entry[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1944                     encode\_buffer[in\_pixel\_index + 1] += ring\_buffer\_entry[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{1945                     encode\_buffer[in\_pixel\_index + 2] += ring\_buffer\_entry[in\_pixel\_index + 2] * coefficient;}
\DoxyCodeLine{1946                 \}}
\DoxyCodeLine{1947             \}}
\DoxyCodeLine{1948             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1949         \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{1950             \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1951             \{}
\DoxyCodeLine{1952                 \textcolor{keywordtype}{int} coefficient\_index = coefficient\_counter++;}
\DoxyCodeLine{1953                 \textcolor{keywordtype}{float}* ring\_buffer\_entry = stbir\_\_get\_ring\_buffer\_scanline(k, ring\_buffer, ring\_buffer\_begin\_index, ring\_buffer\_first\_scanline, ring\_buffer\_entries, ring\_buffer\_length);}
\DoxyCodeLine{1954                 \textcolor{keywordtype}{float} coefficient = vertical\_coefficients[coefficient\_group + coefficient\_index];}
\DoxyCodeLine{1955                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; ++x)}
\DoxyCodeLine{1956                 \{}
\DoxyCodeLine{1957                     \textcolor{keywordtype}{int} in\_pixel\_index = x * 4;}
\DoxyCodeLine{1958                     encode\_buffer[in\_pixel\_index + 0] += ring\_buffer\_entry[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{1959                     encode\_buffer[in\_pixel\_index + 1] += ring\_buffer\_entry[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{1960                     encode\_buffer[in\_pixel\_index + 2] += ring\_buffer\_entry[in\_pixel\_index + 2] * coefficient;}
\DoxyCodeLine{1961                     encode\_buffer[in\_pixel\_index + 3] += ring\_buffer\_entry[in\_pixel\_index + 3] * coefficient;}
\DoxyCodeLine{1962                 \}}
\DoxyCodeLine{1963             \}}
\DoxyCodeLine{1964             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1965         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{1966             \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{1967             \{}
\DoxyCodeLine{1968                 \textcolor{keywordtype}{int} coefficient\_index = coefficient\_counter++;}
\DoxyCodeLine{1969                 \textcolor{keywordtype}{float}* ring\_buffer\_entry = stbir\_\_get\_ring\_buffer\_scanline(k, ring\_buffer, ring\_buffer\_begin\_index, ring\_buffer\_first\_scanline, ring\_buffer\_entries, ring\_buffer\_length);}
\DoxyCodeLine{1970                 \textcolor{keywordtype}{float} coefficient = vertical\_coefficients[coefficient\_group + coefficient\_index];}
\DoxyCodeLine{1971                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; ++x)}
\DoxyCodeLine{1972                 \{}
\DoxyCodeLine{1973                     \textcolor{keywordtype}{int} in\_pixel\_index = x * channels;}
\DoxyCodeLine{1974                     \textcolor{keywordtype}{int} c;}
\DoxyCodeLine{1975                     \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{1976                         encode\_buffer[in\_pixel\_index + c] += ring\_buffer\_entry[in\_pixel\_index + c] * coefficient;}
\DoxyCodeLine{1977                 \}}
\DoxyCodeLine{1978             \}}
\DoxyCodeLine{1979             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1980     \}}
\DoxyCodeLine{1981     stbir\_\_encode\_scanline(stbir\_info, output\_w, (\textcolor{keywordtype}{char} *) output\_data + output\_row\_start, encode\_buffer, channels, alpha\_channel, decode);}
\DoxyCodeLine{1982 \}}
\DoxyCodeLine{1983 }
\DoxyCodeLine{1984 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_resample\_vertical\_downsample(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1985 \{}
\DoxyCodeLine{1986     \textcolor{keywordtype}{int} x, k;}
\DoxyCodeLine{1987     \textcolor{keywordtype}{int} output\_w = stbir\_info-\/>output\_w;}
\DoxyCodeLine{1988     stbir\_\_contributors* vertical\_contributors = stbir\_info-\/>vertical\_contributors;}
\DoxyCodeLine{1989     \textcolor{keywordtype}{float}* vertical\_coefficients = stbir\_info-\/>vertical\_coefficients;}
\DoxyCodeLine{1990     \textcolor{keywordtype}{int} channels = stbir\_info-\/>channels;}
\DoxyCodeLine{1991     \textcolor{keywordtype}{int} ring\_buffer\_entries = stbir\_info-\/>ring\_buffer\_num\_entries;}
\DoxyCodeLine{1992     \textcolor{keywordtype}{float}* horizontal\_buffer = stbir\_info-\/>horizontal\_buffer;}
\DoxyCodeLine{1993     \textcolor{keywordtype}{int} coefficient\_width = stbir\_info-\/>vertical\_coefficient\_width;}
\DoxyCodeLine{1994     \textcolor{keywordtype}{int} contributor = n + stbir\_info-\/>vertical\_filter\_pixel\_margin;}
\DoxyCodeLine{1995 }
\DoxyCodeLine{1996     \textcolor{keywordtype}{float}* ring\_buffer = stbir\_info-\/>ring\_buffer;}
\DoxyCodeLine{1997     \textcolor{keywordtype}{int} ring\_buffer\_begin\_index = stbir\_info-\/>ring\_buffer\_begin\_index;}
\DoxyCodeLine{1998     \textcolor{keywordtype}{int} ring\_buffer\_first\_scanline = stbir\_info-\/>ring\_buffer\_first\_scanline;}
\DoxyCodeLine{1999     \textcolor{keywordtype}{int} ring\_buffer\_length = stbir\_info-\/>ring\_buffer\_length\_bytes/\textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{2000     \textcolor{keywordtype}{int} n0,n1;}
\DoxyCodeLine{2001 }
\DoxyCodeLine{2002     n0 = vertical\_contributors[contributor].n0;}
\DoxyCodeLine{2003     n1 = vertical\_contributors[contributor].n1;}
\DoxyCodeLine{2004 }
\DoxyCodeLine{2005     STBIR\_ASSERT(!stbir\_\_use\_height\_upsampling(stbir\_info));}
\DoxyCodeLine{2006 }
\DoxyCodeLine{2007     \textcolor{keywordflow}{for} (k = n0; k <= n1; k++)}
\DoxyCodeLine{2008     \{}
\DoxyCodeLine{2009         \textcolor{keywordtype}{int} coefficient\_index = k -\/ n0;}
\DoxyCodeLine{2010         \textcolor{keywordtype}{int} coefficient\_group = coefficient\_width * contributor;}
\DoxyCodeLine{2011         \textcolor{keywordtype}{float} coefficient = vertical\_coefficients[coefficient\_group + coefficient\_index];}
\DoxyCodeLine{2012 }
\DoxyCodeLine{2013         \textcolor{keywordtype}{float}* ring\_buffer\_entry = stbir\_\_get\_ring\_buffer\_scanline(k, ring\_buffer, ring\_buffer\_begin\_index, ring\_buffer\_first\_scanline, ring\_buffer\_entries, ring\_buffer\_length);}
\DoxyCodeLine{2014 }
\DoxyCodeLine{2015         \textcolor{keywordflow}{switch} (channels) \{}
\DoxyCodeLine{2016             \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{2017                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; x++)}
\DoxyCodeLine{2018                 \{}
\DoxyCodeLine{2019                     \textcolor{keywordtype}{int} in\_pixel\_index = x * 1;}
\DoxyCodeLine{2020                     ring\_buffer\_entry[in\_pixel\_index + 0] += horizontal\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{2021                 \}}
\DoxyCodeLine{2022                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{2023             \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{2024                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; x++)}
\DoxyCodeLine{2025                 \{}
\DoxyCodeLine{2026                     \textcolor{keywordtype}{int} in\_pixel\_index = x * 2;}
\DoxyCodeLine{2027                     ring\_buffer\_entry[in\_pixel\_index + 0] += horizontal\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{2028                     ring\_buffer\_entry[in\_pixel\_index + 1] += horizontal\_buffer[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{2029                 \}}
\DoxyCodeLine{2030                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{2031             \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{2032                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; x++)}
\DoxyCodeLine{2033                 \{}
\DoxyCodeLine{2034                     \textcolor{keywordtype}{int} in\_pixel\_index = x * 3;}
\DoxyCodeLine{2035                     ring\_buffer\_entry[in\_pixel\_index + 0] += horizontal\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{2036                     ring\_buffer\_entry[in\_pixel\_index + 1] += horizontal\_buffer[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{2037                     ring\_buffer\_entry[in\_pixel\_index + 2] += horizontal\_buffer[in\_pixel\_index + 2] * coefficient;}
\DoxyCodeLine{2038                 \}}
\DoxyCodeLine{2039                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{2040             \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{2041                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; x++)}
\DoxyCodeLine{2042                 \{}
\DoxyCodeLine{2043                     \textcolor{keywordtype}{int} in\_pixel\_index = x * 4;}
\DoxyCodeLine{2044                     ring\_buffer\_entry[in\_pixel\_index + 0] += horizontal\_buffer[in\_pixel\_index + 0] * coefficient;}
\DoxyCodeLine{2045                     ring\_buffer\_entry[in\_pixel\_index + 1] += horizontal\_buffer[in\_pixel\_index + 1] * coefficient;}
\DoxyCodeLine{2046                     ring\_buffer\_entry[in\_pixel\_index + 2] += horizontal\_buffer[in\_pixel\_index + 2] * coefficient;}
\DoxyCodeLine{2047                     ring\_buffer\_entry[in\_pixel\_index + 3] += horizontal\_buffer[in\_pixel\_index + 3] * coefficient;}
\DoxyCodeLine{2048                 \}}
\DoxyCodeLine{2049                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{2050             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{2051                 \textcolor{keywordflow}{for} (x = 0; x < output\_w; x++)}
\DoxyCodeLine{2052                 \{}
\DoxyCodeLine{2053                     \textcolor{keywordtype}{int} in\_pixel\_index = x * channels;}
\DoxyCodeLine{2054 }
\DoxyCodeLine{2055                     \textcolor{keywordtype}{int} c;}
\DoxyCodeLine{2056                     \textcolor{keywordflow}{for} (c = 0; c < channels; c++)}
\DoxyCodeLine{2057                         ring\_buffer\_entry[in\_pixel\_index + c] += horizontal\_buffer[in\_pixel\_index + c] * coefficient;}
\DoxyCodeLine{2058                 \}}
\DoxyCodeLine{2059                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{2060         \}}
\DoxyCodeLine{2061     \}}
\DoxyCodeLine{2062 \}}
\DoxyCodeLine{2063 }
\DoxyCodeLine{2064 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_buffer\_loop\_upsample(stbir\_\_info* stbir\_info)}
\DoxyCodeLine{2065 \{}
\DoxyCodeLine{2066     \textcolor{keywordtype}{int} y;}
\DoxyCodeLine{2067     \textcolor{keywordtype}{float} scale\_ratio = stbir\_info-\/>vertical\_scale;}
\DoxyCodeLine{2068     \textcolor{keywordtype}{float} out\_scanlines\_radius = stbir\_\_filter\_info\_table[stbir\_info-\/>vertical\_filter].support(1/scale\_ratio) * scale\_ratio;}
\DoxyCodeLine{2069 }
\DoxyCodeLine{2070     STBIR\_ASSERT(stbir\_\_use\_height\_upsampling(stbir\_info));}
\DoxyCodeLine{2071 }
\DoxyCodeLine{2072     \textcolor{keywordflow}{for} (y = 0; y < stbir\_info-\/>output\_h; y++)}
\DoxyCodeLine{2073     \{}
\DoxyCodeLine{2074         \textcolor{keywordtype}{float} in\_center\_of\_out = 0; \textcolor{comment}{// Center of the current out scanline in the in scanline space}}
\DoxyCodeLine{2075         \textcolor{keywordtype}{int} in\_first\_scanline = 0, in\_last\_scanline = 0;}
\DoxyCodeLine{2076 }
\DoxyCodeLine{2077         stbir\_\_calculate\_sample\_range\_upsample(y, out\_scanlines\_radius, scale\_ratio, stbir\_info-\/>vertical\_shift, \&in\_first\_scanline, \&in\_last\_scanline, \&in\_center\_of\_out);}
\DoxyCodeLine{2078 }
\DoxyCodeLine{2079         STBIR\_ASSERT(in\_last\_scanline -\/ in\_first\_scanline + 1 <= stbir\_info-\/>ring\_buffer\_num\_entries);}
\DoxyCodeLine{2080 }
\DoxyCodeLine{2081         \textcolor{keywordflow}{if} (stbir\_info-\/>ring\_buffer\_begin\_index >= 0)}
\DoxyCodeLine{2082         \{}
\DoxyCodeLine{2083             \textcolor{comment}{// Get rid of whatever we don't need anymore.}}
\DoxyCodeLine{2084             \textcolor{keywordflow}{while} (in\_first\_scanline > stbir\_info-\/>ring\_buffer\_first\_scanline)}
\DoxyCodeLine{2085             \{}
\DoxyCodeLine{2086                 \textcolor{keywordflow}{if} (stbir\_info-\/>ring\_buffer\_first\_scanline == stbir\_info-\/>ring\_buffer\_last\_scanline)}
\DoxyCodeLine{2087                 \{}
\DoxyCodeLine{2088                     \textcolor{comment}{// We just popped the last scanline off the ring buffer.}}
\DoxyCodeLine{2089                     \textcolor{comment}{// Reset it to the empty state.}}
\DoxyCodeLine{2090                     stbir\_info-\/>ring\_buffer\_begin\_index = -\/1;}
\DoxyCodeLine{2091                     stbir\_info-\/>ring\_buffer\_first\_scanline = 0;}
\DoxyCodeLine{2092                     stbir\_info-\/>ring\_buffer\_last\_scanline = 0;}
\DoxyCodeLine{2093                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{2094                 \}}
\DoxyCodeLine{2095                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{2096                 \{}
\DoxyCodeLine{2097                     stbir\_info-\/>ring\_buffer\_first\_scanline++;}
\DoxyCodeLine{2098                     stbir\_info-\/>ring\_buffer\_begin\_index = (stbir\_info-\/>ring\_buffer\_begin\_index + 1) \% stbir\_info-\/>ring\_buffer\_num\_entries;}
\DoxyCodeLine{2099                 \}}
\DoxyCodeLine{2100             \}}
\DoxyCodeLine{2101         \}}
\DoxyCodeLine{2102 }
\DoxyCodeLine{2103         \textcolor{comment}{// Load in new ones.}}
\DoxyCodeLine{2104         \textcolor{keywordflow}{if} (stbir\_info-\/>ring\_buffer\_begin\_index < 0)}
\DoxyCodeLine{2105             stbir\_\_decode\_and\_resample\_upsample(stbir\_info, in\_first\_scanline);}
\DoxyCodeLine{2106 }
\DoxyCodeLine{2107         \textcolor{keywordflow}{while} (in\_last\_scanline > stbir\_info-\/>ring\_buffer\_last\_scanline)}
\DoxyCodeLine{2108             stbir\_\_decode\_and\_resample\_upsample(stbir\_info, stbir\_info-\/>ring\_buffer\_last\_scanline + 1);}
\DoxyCodeLine{2109 }
\DoxyCodeLine{2110         \textcolor{comment}{// Now all buffers should be ready to write a row of vertical sampling.}}
\DoxyCodeLine{2111         stbir\_\_resample\_vertical\_upsample(stbir\_info, y);}
\DoxyCodeLine{2112 }
\DoxyCodeLine{2113         STBIR\_PROGRESS\_REPORT((\textcolor{keywordtype}{float})y / stbir\_info-\/>output\_h);}
\DoxyCodeLine{2114     \}}
\DoxyCodeLine{2115 \}}
\DoxyCodeLine{2116 }
\DoxyCodeLine{2117 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_empty\_ring\_buffer(stbir\_\_info* stbir\_info, \textcolor{keywordtype}{int} first\_necessary\_scanline)}
\DoxyCodeLine{2118 \{}
\DoxyCodeLine{2119     \textcolor{keywordtype}{int} output\_stride\_bytes = stbir\_info-\/>output\_stride\_bytes;}
\DoxyCodeLine{2120     \textcolor{keywordtype}{int} channels = stbir\_info-\/>channels;}
\DoxyCodeLine{2121     \textcolor{keywordtype}{int} alpha\_channel = stbir\_info-\/>alpha\_channel;}
\DoxyCodeLine{2122     \textcolor{keywordtype}{int} type = stbir\_info-\/>type;}
\DoxyCodeLine{2123     \textcolor{keywordtype}{int} colorspace = stbir\_info-\/>colorspace;}
\DoxyCodeLine{2124     \textcolor{keywordtype}{int} output\_w = stbir\_info-\/>output\_w;}
\DoxyCodeLine{2125     \textcolor{keywordtype}{void}* output\_data = stbir\_info-\/>output\_data;}
\DoxyCodeLine{2126     \textcolor{keywordtype}{int} decode = STBIR\_\_DECODE(type, colorspace);}
\DoxyCodeLine{2127 }
\DoxyCodeLine{2128     \textcolor{keywordtype}{float}* ring\_buffer = stbir\_info-\/>ring\_buffer;}
\DoxyCodeLine{2129     \textcolor{keywordtype}{int} ring\_buffer\_length = stbir\_info-\/>ring\_buffer\_length\_bytes/\textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{2130 }
\DoxyCodeLine{2131     \textcolor{keywordflow}{if} (stbir\_info-\/>ring\_buffer\_begin\_index >= 0)}
\DoxyCodeLine{2132     \{}
\DoxyCodeLine{2133         \textcolor{comment}{// Get rid of whatever we don't need anymore.}}
\DoxyCodeLine{2134         \textcolor{keywordflow}{while} (first\_necessary\_scanline > stbir\_info-\/>ring\_buffer\_first\_scanline)}
\DoxyCodeLine{2135         \{}
\DoxyCodeLine{2136             \textcolor{keywordflow}{if} (stbir\_info-\/>ring\_buffer\_first\_scanline >= 0 \&\& stbir\_info-\/>ring\_buffer\_first\_scanline < stbir\_info-\/>output\_h)}
\DoxyCodeLine{2137             \{}
\DoxyCodeLine{2138                 \textcolor{keywordtype}{int} output\_row\_start = stbir\_info-\/>ring\_buffer\_first\_scanline * output\_stride\_bytes;}
\DoxyCodeLine{2139                 \textcolor{keywordtype}{float}* ring\_buffer\_entry = stbir\_\_get\_ring\_buffer\_entry(ring\_buffer, stbir\_info-\/>ring\_buffer\_begin\_index, ring\_buffer\_length);}
\DoxyCodeLine{2140                 stbir\_\_encode\_scanline(stbir\_info, output\_w, (\textcolor{keywordtype}{char} *) output\_data + output\_row\_start, ring\_buffer\_entry, channels, alpha\_channel, decode);}
\DoxyCodeLine{2141                 STBIR\_PROGRESS\_REPORT((\textcolor{keywordtype}{float})stbir\_info-\/>ring\_buffer\_first\_scanline / stbir\_info-\/>output\_h);}
\DoxyCodeLine{2142             \}}
\DoxyCodeLine{2143 }
\DoxyCodeLine{2144             \textcolor{keywordflow}{if} (stbir\_info-\/>ring\_buffer\_first\_scanline == stbir\_info-\/>ring\_buffer\_last\_scanline)}
\DoxyCodeLine{2145             \{}
\DoxyCodeLine{2146                 \textcolor{comment}{// We just popped the last scanline off the ring buffer.}}
\DoxyCodeLine{2147                 \textcolor{comment}{// Reset it to the empty state.}}
\DoxyCodeLine{2148                 stbir\_info-\/>ring\_buffer\_begin\_index = -\/1;}
\DoxyCodeLine{2149                 stbir\_info-\/>ring\_buffer\_first\_scanline = 0;}
\DoxyCodeLine{2150                 stbir\_info-\/>ring\_buffer\_last\_scanline = 0;}
\DoxyCodeLine{2151                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{2152             \}}
\DoxyCodeLine{2153             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2154             \{}
\DoxyCodeLine{2155                 stbir\_info-\/>ring\_buffer\_first\_scanline++;}
\DoxyCodeLine{2156                 stbir\_info-\/>ring\_buffer\_begin\_index = (stbir\_info-\/>ring\_buffer\_begin\_index + 1) \% stbir\_info-\/>ring\_buffer\_num\_entries;}
\DoxyCodeLine{2157             \}}
\DoxyCodeLine{2158         \}}
\DoxyCodeLine{2159     \}}
\DoxyCodeLine{2160 \}}
\DoxyCodeLine{2161 }
\DoxyCodeLine{2162 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_buffer\_loop\_downsample(stbir\_\_info* stbir\_info)}
\DoxyCodeLine{2163 \{}
\DoxyCodeLine{2164     \textcolor{keywordtype}{int} y;}
\DoxyCodeLine{2165     \textcolor{keywordtype}{float} scale\_ratio = stbir\_info-\/>vertical\_scale;}
\DoxyCodeLine{2166     \textcolor{keywordtype}{int} output\_h = stbir\_info-\/>output\_h;}
\DoxyCodeLine{2167     \textcolor{keywordtype}{float} in\_pixels\_radius = stbir\_\_filter\_info\_table[stbir\_info-\/>vertical\_filter].support(scale\_ratio) / scale\_ratio;}
\DoxyCodeLine{2168     \textcolor{keywordtype}{int} pixel\_margin = stbir\_info-\/>vertical\_filter\_pixel\_margin;}
\DoxyCodeLine{2169     \textcolor{keywordtype}{int} max\_y = stbir\_info-\/>input\_h + pixel\_margin;}
\DoxyCodeLine{2170 }
\DoxyCodeLine{2171     STBIR\_ASSERT(!stbir\_\_use\_height\_upsampling(stbir\_info));}
\DoxyCodeLine{2172 }
\DoxyCodeLine{2173     \textcolor{keywordflow}{for} (y = -\/pixel\_margin; y < max\_y; y++)}
\DoxyCodeLine{2174     \{}
\DoxyCodeLine{2175         \textcolor{keywordtype}{float} out\_center\_of\_in; \textcolor{comment}{// Center of the current out scanline in the in scanline space}}
\DoxyCodeLine{2176         \textcolor{keywordtype}{int} out\_first\_scanline, out\_last\_scanline;}
\DoxyCodeLine{2177 }
\DoxyCodeLine{2178         stbir\_\_calculate\_sample\_range\_downsample(y, in\_pixels\_radius, scale\_ratio, stbir\_info-\/>vertical\_shift, \&out\_first\_scanline, \&out\_last\_scanline, \&out\_center\_of\_in);}
\DoxyCodeLine{2179 }
\DoxyCodeLine{2180         STBIR\_ASSERT(out\_last\_scanline -\/ out\_first\_scanline + 1 <= stbir\_info-\/>ring\_buffer\_num\_entries);}
\DoxyCodeLine{2181 }
\DoxyCodeLine{2182         \textcolor{keywordflow}{if} (out\_last\_scanline < 0 || out\_first\_scanline >= output\_h)}
\DoxyCodeLine{2183             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{2184 }
\DoxyCodeLine{2185         stbir\_\_empty\_ring\_buffer(stbir\_info, out\_first\_scanline);}
\DoxyCodeLine{2186 }
\DoxyCodeLine{2187         stbir\_\_decode\_and\_resample\_downsample(stbir\_info, y);}
\DoxyCodeLine{2188 }
\DoxyCodeLine{2189         \textcolor{comment}{// Load in new ones.}}
\DoxyCodeLine{2190         \textcolor{keywordflow}{if} (stbir\_info-\/>ring\_buffer\_begin\_index < 0)}
\DoxyCodeLine{2191             stbir\_\_add\_empty\_ring\_buffer\_entry(stbir\_info, out\_first\_scanline);}
\DoxyCodeLine{2192 }
\DoxyCodeLine{2193         \textcolor{keywordflow}{while} (out\_last\_scanline > stbir\_info-\/>ring\_buffer\_last\_scanline)}
\DoxyCodeLine{2194             stbir\_\_add\_empty\_ring\_buffer\_entry(stbir\_info, stbir\_info-\/>ring\_buffer\_last\_scanline + 1);}
\DoxyCodeLine{2195 }
\DoxyCodeLine{2196         \textcolor{comment}{// Now the horizontal buffer is ready to write to all ring buffer rows.}}
\DoxyCodeLine{2197         stbir\_\_resample\_vertical\_downsample(stbir\_info, y);}
\DoxyCodeLine{2198     \}}
\DoxyCodeLine{2199 }
\DoxyCodeLine{2200     stbir\_\_empty\_ring\_buffer(stbir\_info, stbir\_info-\/>output\_h);}
\DoxyCodeLine{2201 \}}
\DoxyCodeLine{2202 }
\DoxyCodeLine{2203 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_setup(stbir\_\_info *info, \textcolor{keywordtype}{int} input\_w, \textcolor{keywordtype}{int} input\_h, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} channels)}
\DoxyCodeLine{2204 \{}
\DoxyCodeLine{2205     info-\/>input\_w = input\_w;}
\DoxyCodeLine{2206     info-\/>input\_h = input\_h;}
\DoxyCodeLine{2207     info-\/>output\_w = output\_w;}
\DoxyCodeLine{2208     info-\/>output\_h = output\_h;}
\DoxyCodeLine{2209     info-\/>channels = channels;}
\DoxyCodeLine{2210 \}}
\DoxyCodeLine{2211 }
\DoxyCodeLine{2212 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_calculate\_transform(stbir\_\_info *info, \textcolor{keywordtype}{float} s0, \textcolor{keywordtype}{float} t0, \textcolor{keywordtype}{float} s1, \textcolor{keywordtype}{float} t1, \textcolor{keywordtype}{float} *transform)}
\DoxyCodeLine{2213 \{}
\DoxyCodeLine{2214     info-\/>s0 = s0;}
\DoxyCodeLine{2215     info-\/>t0 = t0;}
\DoxyCodeLine{2216     info-\/>s1 = s1;}
\DoxyCodeLine{2217     info-\/>t1 = t1;}
\DoxyCodeLine{2218 }
\DoxyCodeLine{2219     \textcolor{keywordflow}{if} (transform)}
\DoxyCodeLine{2220     \{}
\DoxyCodeLine{2221         info-\/>horizontal\_scale = transform[0];}
\DoxyCodeLine{2222         info-\/>vertical\_scale   = transform[1];}
\DoxyCodeLine{2223         info-\/>horizontal\_shift = transform[2];}
\DoxyCodeLine{2224         info-\/>vertical\_shift   = transform[3];}
\DoxyCodeLine{2225     \}}
\DoxyCodeLine{2226     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2227     \{}
\DoxyCodeLine{2228         info-\/>horizontal\_scale = ((float)info-\/>output\_w / info-\/>input\_w) / (s1 -\/ s0);}
\DoxyCodeLine{2229         info-\/>vertical\_scale = ((float)info-\/>output\_h / info-\/>input\_h) / (t1 -\/ t0);}
\DoxyCodeLine{2230 }
\DoxyCodeLine{2231         info-\/>horizontal\_shift = s0 * info-\/>output\_w / (s1 -\/ s0);}
\DoxyCodeLine{2232         info-\/>vertical\_shift = t0 * info-\/>output\_h / (t1 -\/ t0);}
\DoxyCodeLine{2233     \}}
\DoxyCodeLine{2234 \}}
\DoxyCodeLine{2235 }
\DoxyCodeLine{2236 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbir\_\_choose\_filter(stbir\_\_info *info, stbir\_filter h\_filter, stbir\_filter v\_filter)}
\DoxyCodeLine{2237 \{}
\DoxyCodeLine{2238     \textcolor{keywordflow}{if} (h\_filter == 0)}
\DoxyCodeLine{2239         h\_filter = stbir\_\_use\_upsampling(info-\/>horizontal\_scale) ? STBIR\_DEFAULT\_FILTER\_UPSAMPLE : STBIR\_DEFAULT\_FILTER\_DOWNSAMPLE;}
\DoxyCodeLine{2240     \textcolor{keywordflow}{if} (v\_filter == 0)}
\DoxyCodeLine{2241         v\_filter = stbir\_\_use\_upsampling(info-\/>vertical\_scale)   ? STBIR\_DEFAULT\_FILTER\_UPSAMPLE : STBIR\_DEFAULT\_FILTER\_DOWNSAMPLE;}
\DoxyCodeLine{2242     info-\/>horizontal\_filter = h\_filter;}
\DoxyCodeLine{2243     info-\/>vertical\_filter = v\_filter;}
\DoxyCodeLine{2244 \}}
\DoxyCodeLine{2245 }
\DoxyCodeLine{2246 \textcolor{keyword}{static} stbir\_uint32 stbir\_\_calculate\_memory(stbir\_\_info *info)}
\DoxyCodeLine{2247 \{}
\DoxyCodeLine{2248     \textcolor{keywordtype}{int} pixel\_margin = stbir\_\_get\_filter\_pixel\_margin(info-\/>horizontal\_filter, info-\/>horizontal\_scale);}
\DoxyCodeLine{2249     \textcolor{keywordtype}{int} filter\_height = stbir\_\_get\_filter\_pixel\_width(info-\/>vertical\_filter, info-\/>vertical\_scale);}
\DoxyCodeLine{2250 }
\DoxyCodeLine{2251     info-\/>horizontal\_num\_contributors = stbir\_\_get\_contributors(info-\/>horizontal\_scale, info-\/>horizontal\_filter, info-\/>input\_w, info-\/>output\_w);}
\DoxyCodeLine{2252     info-\/>vertical\_num\_contributors   = stbir\_\_get\_contributors(info-\/>vertical\_scale  , info-\/>vertical\_filter  , info-\/>input\_h, info-\/>output\_h);}
\DoxyCodeLine{2253 }
\DoxyCodeLine{2254     \textcolor{comment}{// One extra entry because floating point precision problems sometimes cause an extra to be necessary.}}
\DoxyCodeLine{2255     info-\/>ring\_buffer\_num\_entries = filter\_height + 1;}
\DoxyCodeLine{2256 }
\DoxyCodeLine{2257     info-\/>horizontal\_contributors\_size = info-\/>horizontal\_num\_contributors * \textcolor{keyword}{sizeof}(stbir\_\_contributors);}
\DoxyCodeLine{2258     info-\/>horizontal\_coefficients\_size = stbir\_\_get\_total\_horizontal\_coefficients(info) * \textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{2259     info-\/>vertical\_contributors\_size = info-\/>vertical\_num\_contributors * \textcolor{keyword}{sizeof}(stbir\_\_contributors);}
\DoxyCodeLine{2260     info-\/>vertical\_coefficients\_size = stbir\_\_get\_total\_vertical\_coefficients(info) * \textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{2261     info-\/>decode\_buffer\_size = (info-\/>input\_w + pixel\_margin * 2) * info-\/>channels * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float});}
\DoxyCodeLine{2262     info-\/>horizontal\_buffer\_size = info-\/>output\_w * info-\/>channels * \textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{2263     info-\/>ring\_buffer\_size = info-\/>output\_w * info-\/>channels * info-\/>ring\_buffer\_num\_entries * \textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{2264     info-\/>encode\_buffer\_size = info-\/>output\_w * info-\/>channels * \textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{2265 }
\DoxyCodeLine{2266     STBIR\_ASSERT(info-\/>horizontal\_filter != 0);}
\DoxyCodeLine{2267     STBIR\_ASSERT(info-\/>horizontal\_filter < STBIR\_\_ARRAY\_SIZE(stbir\_\_filter\_info\_table)); \textcolor{comment}{// this now happens too late}}
\DoxyCodeLine{2268     STBIR\_ASSERT(info-\/>vertical\_filter != 0);}
\DoxyCodeLine{2269     STBIR\_ASSERT(info-\/>vertical\_filter < STBIR\_\_ARRAY\_SIZE(stbir\_\_filter\_info\_table)); \textcolor{comment}{// this now happens too late}}
\DoxyCodeLine{2270 }
\DoxyCodeLine{2271     \textcolor{keywordflow}{if} (stbir\_\_use\_height\_upsampling(info))}
\DoxyCodeLine{2272         \textcolor{comment}{// The horizontal buffer is for when we're downsampling the height and we}}
\DoxyCodeLine{2273         \textcolor{comment}{// can't output the result of sampling the decode buffer directly into the}}
\DoxyCodeLine{2274         \textcolor{comment}{// ring buffers.}}
\DoxyCodeLine{2275         info-\/>horizontal\_buffer\_size = 0;}
\DoxyCodeLine{2276     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2277         \textcolor{comment}{// The encode buffer is to retain precision in the height upsampling method}}
\DoxyCodeLine{2278         \textcolor{comment}{// and isn't used when height downsampling.}}
\DoxyCodeLine{2279         info-\/>encode\_buffer\_size = 0;}
\DoxyCodeLine{2280 }
\DoxyCodeLine{2281     \textcolor{keywordflow}{return} info-\/>horizontal\_contributors\_size + info-\/>horizontal\_coefficients\_size}
\DoxyCodeLine{2282         + info-\/>vertical\_contributors\_size + info-\/>vertical\_coefficients\_size}
\DoxyCodeLine{2283         + info-\/>decode\_buffer\_size + info-\/>horizontal\_buffer\_size}
\DoxyCodeLine{2284         + info-\/>ring\_buffer\_size + info-\/>encode\_buffer\_size;}
\DoxyCodeLine{2285 \}}
\DoxyCodeLine{2286 }
\DoxyCodeLine{2287 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_resize\_allocated(stbir\_\_info *info,}
\DoxyCodeLine{2288     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* input\_data, \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2289     \textcolor{keywordtype}{void}* output\_data, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2290     \textcolor{keywordtype}{int} alpha\_channel, stbir\_uint32 flags, stbir\_datatype type,}
\DoxyCodeLine{2291     stbir\_edge edge\_horizontal, stbir\_edge edge\_vertical, stbir\_colorspace colorspace,}
\DoxyCodeLine{2292     \textcolor{keywordtype}{void}* tempmem, \textcolor{keywordtype}{size\_t} tempmem\_size\_in\_bytes)}
\DoxyCodeLine{2293 \{}
\DoxyCodeLine{2294     \textcolor{keywordtype}{size\_t} memory\_required = stbir\_\_calculate\_memory(info);}
\DoxyCodeLine{2295 }
\DoxyCodeLine{2296     \textcolor{keywordtype}{int} width\_stride\_input = input\_stride\_in\_bytes ? input\_stride\_in\_bytes : info-\/>channels * info-\/>input\_w * stbir\_\_type\_size[type];}
\DoxyCodeLine{2297     \textcolor{keywordtype}{int} width\_stride\_output = output\_stride\_in\_bytes ? output\_stride\_in\_bytes : info-\/>channels * info-\/>output\_w * stbir\_\_type\_size[type];}
\DoxyCodeLine{2298 }
\DoxyCodeLine{2299 \textcolor{preprocessor}{\#ifdef STBIR\_DEBUG\_OVERWRITE\_TEST}}
\DoxyCodeLine{2300 \textcolor{preprocessor}{\#define OVERWRITE\_ARRAY\_SIZE 8}}
\DoxyCodeLine{2301     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} overwrite\_output\_before\_pre[OVERWRITE\_ARRAY\_SIZE];}
\DoxyCodeLine{2302     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} overwrite\_tempmem\_before\_pre[OVERWRITE\_ARRAY\_SIZE];}
\DoxyCodeLine{2303     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} overwrite\_output\_after\_pre[OVERWRITE\_ARRAY\_SIZE];}
\DoxyCodeLine{2304     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} overwrite\_tempmem\_after\_pre[OVERWRITE\_ARRAY\_SIZE];}
\DoxyCodeLine{2305 }
\DoxyCodeLine{2306     \textcolor{keywordtype}{size\_t} begin\_forbidden = width\_stride\_output * (info-\/>output\_h -\/ 1) + info-\/>output\_w * info-\/>channels * stbir\_\_type\_size[type];}
\DoxyCodeLine{2307     memcpy(overwrite\_output\_before\_pre, \&((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)output\_data)[-\/OVERWRITE\_ARRAY\_SIZE], OVERWRITE\_ARRAY\_SIZE);}
\DoxyCodeLine{2308     memcpy(overwrite\_output\_after\_pre, \&((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)output\_data)[begin\_forbidden], OVERWRITE\_ARRAY\_SIZE);}
\DoxyCodeLine{2309     memcpy(overwrite\_tempmem\_before\_pre, \&((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)tempmem)[-\/OVERWRITE\_ARRAY\_SIZE], OVERWRITE\_ARRAY\_SIZE);}
\DoxyCodeLine{2310     memcpy(overwrite\_tempmem\_after\_pre, \&((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)tempmem)[tempmem\_size\_in\_bytes], OVERWRITE\_ARRAY\_SIZE);}
\DoxyCodeLine{2311 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2312 }
\DoxyCodeLine{2313     STBIR\_ASSERT(info-\/>channels >= 0);}
\DoxyCodeLine{2314     STBIR\_ASSERT(info-\/>channels <= STBIR\_MAX\_CHANNELS);}
\DoxyCodeLine{2315 }
\DoxyCodeLine{2316     \textcolor{keywordflow}{if} (info-\/>channels < 0 || info-\/>channels > STBIR\_MAX\_CHANNELS)}
\DoxyCodeLine{2317         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2318 }
\DoxyCodeLine{2319     STBIR\_ASSERT(info-\/>horizontal\_filter < STBIR\_\_ARRAY\_SIZE(stbir\_\_filter\_info\_table));}
\DoxyCodeLine{2320     STBIR\_ASSERT(info-\/>vertical\_filter < STBIR\_\_ARRAY\_SIZE(stbir\_\_filter\_info\_table));}
\DoxyCodeLine{2321 }
\DoxyCodeLine{2322     \textcolor{keywordflow}{if} (info-\/>horizontal\_filter >= STBIR\_\_ARRAY\_SIZE(stbir\_\_filter\_info\_table))}
\DoxyCodeLine{2323         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2324     \textcolor{keywordflow}{if} (info-\/>vertical\_filter >= STBIR\_\_ARRAY\_SIZE(stbir\_\_filter\_info\_table))}
\DoxyCodeLine{2325         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2326 }
\DoxyCodeLine{2327     \textcolor{keywordflow}{if} (alpha\_channel < 0)}
\DoxyCodeLine{2328         flags |= STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE | STBIR\_FLAG\_ALPHA\_PREMULTIPLIED;}
\DoxyCodeLine{2329 }
\DoxyCodeLine{2330     \textcolor{keywordflow}{if} (!(flags\&STBIR\_FLAG\_ALPHA\_USES\_COLORSPACE) || !(flags\&STBIR\_FLAG\_ALPHA\_PREMULTIPLIED)) \{}
\DoxyCodeLine{2331         STBIR\_ASSERT(alpha\_channel >= 0 \&\& alpha\_channel < info-\/>channels);}
\DoxyCodeLine{2332     \}}
\DoxyCodeLine{2333 }
\DoxyCodeLine{2334     \textcolor{keywordflow}{if} (alpha\_channel >= info-\/>channels)}
\DoxyCodeLine{2335         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2336 }
\DoxyCodeLine{2337     STBIR\_ASSERT(tempmem);}
\DoxyCodeLine{2338 }
\DoxyCodeLine{2339     \textcolor{keywordflow}{if} (!tempmem)}
\DoxyCodeLine{2340         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2341 }
\DoxyCodeLine{2342     STBIR\_ASSERT(tempmem\_size\_in\_bytes >= memory\_required);}
\DoxyCodeLine{2343 }
\DoxyCodeLine{2344     \textcolor{keywordflow}{if} (tempmem\_size\_in\_bytes < memory\_required)}
\DoxyCodeLine{2345         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2346 }
\DoxyCodeLine{2347     memset(tempmem, 0, tempmem\_size\_in\_bytes);}
\DoxyCodeLine{2348 }
\DoxyCodeLine{2349     info-\/>input\_data = input\_data;}
\DoxyCodeLine{2350     info-\/>input\_stride\_bytes = width\_stride\_input;}
\DoxyCodeLine{2351 }
\DoxyCodeLine{2352     info-\/>output\_data = output\_data;}
\DoxyCodeLine{2353     info-\/>output\_stride\_bytes = width\_stride\_output;}
\DoxyCodeLine{2354 }
\DoxyCodeLine{2355     info-\/>alpha\_channel = alpha\_channel;}
\DoxyCodeLine{2356     info-\/>flags = flags;}
\DoxyCodeLine{2357     info-\/>type = type;}
\DoxyCodeLine{2358     info-\/>edge\_horizontal = edge\_horizontal;}
\DoxyCodeLine{2359     info-\/>edge\_vertical = edge\_vertical;}
\DoxyCodeLine{2360     info-\/>colorspace = colorspace;}
\DoxyCodeLine{2361 }
\DoxyCodeLine{2362     info-\/>horizontal\_coefficient\_width   = stbir\_\_get\_coefficient\_width  (info-\/>horizontal\_filter, info-\/>horizontal\_scale);}
\DoxyCodeLine{2363     info-\/>vertical\_coefficient\_width     = stbir\_\_get\_coefficient\_width  (info-\/>vertical\_filter  , info-\/>vertical\_scale  );}
\DoxyCodeLine{2364     info-\/>horizontal\_filter\_pixel\_width  = stbir\_\_get\_filter\_pixel\_width (info-\/>horizontal\_filter, info-\/>horizontal\_scale);}
\DoxyCodeLine{2365     info-\/>vertical\_filter\_pixel\_width    = stbir\_\_get\_filter\_pixel\_width (info-\/>vertical\_filter  , info-\/>vertical\_scale  );}
\DoxyCodeLine{2366     info-\/>horizontal\_filter\_pixel\_margin = stbir\_\_get\_filter\_pixel\_margin(info-\/>horizontal\_filter, info-\/>horizontal\_scale);}
\DoxyCodeLine{2367     info-\/>vertical\_filter\_pixel\_margin   = stbir\_\_get\_filter\_pixel\_margin(info-\/>vertical\_filter  , info-\/>vertical\_scale  );}
\DoxyCodeLine{2368 }
\DoxyCodeLine{2369     info-\/>ring\_buffer\_length\_bytes = info-\/>output\_w * info-\/>channels * \textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{2370     info-\/>decode\_buffer\_pixels = info-\/>input\_w + info-\/>horizontal\_filter\_pixel\_margin * 2;}
\DoxyCodeLine{2371 }
\DoxyCodeLine{2372 \textcolor{preprocessor}{\#define STBIR\_\_NEXT\_MEMPTR(current, newtype) (newtype*)(((unsigned char*)current) + current\#\#\_size)}}
\DoxyCodeLine{2373 }
\DoxyCodeLine{2374     info-\/>horizontal\_contributors = (stbir\_\_contributors *) tempmem;}
\DoxyCodeLine{2375     info-\/>horizontal\_coefficients = STBIR\_\_NEXT\_MEMPTR(info-\/>horizontal\_contributors, \textcolor{keywordtype}{float});}
\DoxyCodeLine{2376     info-\/>vertical\_contributors = STBIR\_\_NEXT\_MEMPTR(info-\/>horizontal\_coefficients, stbir\_\_contributors);}
\DoxyCodeLine{2377     info-\/>vertical\_coefficients = STBIR\_\_NEXT\_MEMPTR(info-\/>vertical\_contributors, \textcolor{keywordtype}{float});}
\DoxyCodeLine{2378     info-\/>decode\_buffer = STBIR\_\_NEXT\_MEMPTR(info-\/>vertical\_coefficients, \textcolor{keywordtype}{float});}
\DoxyCodeLine{2379 }
\DoxyCodeLine{2380     \textcolor{keywordflow}{if} (stbir\_\_use\_height\_upsampling(info))}
\DoxyCodeLine{2381     \{}
\DoxyCodeLine{2382         info-\/>horizontal\_buffer = NULL;}
\DoxyCodeLine{2383         info-\/>ring\_buffer = STBIR\_\_NEXT\_MEMPTR(info-\/>decode\_buffer, \textcolor{keywordtype}{float});}
\DoxyCodeLine{2384         info-\/>encode\_buffer = STBIR\_\_NEXT\_MEMPTR(info-\/>ring\_buffer, \textcolor{keywordtype}{float});}
\DoxyCodeLine{2385 }
\DoxyCodeLine{2386         STBIR\_ASSERT((\textcolor{keywordtype}{size\_t})STBIR\_\_NEXT\_MEMPTR(info-\/>encode\_buffer, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}) == (\textcolor{keywordtype}{size\_t})tempmem + tempmem\_size\_in\_bytes);}
\DoxyCodeLine{2387     \}}
\DoxyCodeLine{2388     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2389     \{}
\DoxyCodeLine{2390         info-\/>horizontal\_buffer = STBIR\_\_NEXT\_MEMPTR(info-\/>decode\_buffer, \textcolor{keywordtype}{float});}
\DoxyCodeLine{2391         info-\/>ring\_buffer = STBIR\_\_NEXT\_MEMPTR(info-\/>horizontal\_buffer, \textcolor{keywordtype}{float});}
\DoxyCodeLine{2392         info-\/>encode\_buffer = NULL;}
\DoxyCodeLine{2393 }
\DoxyCodeLine{2394         STBIR\_ASSERT((\textcolor{keywordtype}{size\_t})STBIR\_\_NEXT\_MEMPTR(info-\/>ring\_buffer, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}) == (\textcolor{keywordtype}{size\_t})tempmem + tempmem\_size\_in\_bytes);}
\DoxyCodeLine{2395     \}}
\DoxyCodeLine{2396 }
\DoxyCodeLine{2397 \textcolor{preprocessor}{\#undef STBIR\_\_NEXT\_MEMPTR}}
\DoxyCodeLine{2398 }
\DoxyCodeLine{2399     \textcolor{comment}{// This signals that the ring buffer is empty}}
\DoxyCodeLine{2400     info-\/>ring\_buffer\_begin\_index = -\/1;}
\DoxyCodeLine{2401 }
\DoxyCodeLine{2402     stbir\_\_calculate\_filters(info-\/>horizontal\_contributors, info-\/>horizontal\_coefficients, info-\/>horizontal\_filter, info-\/>horizontal\_scale, info-\/>horizontal\_shift, info-\/>input\_w, info-\/>output\_w);}
\DoxyCodeLine{2403     stbir\_\_calculate\_filters(info-\/>vertical\_contributors, info-\/>vertical\_coefficients, info-\/>vertical\_filter, info-\/>vertical\_scale, info-\/>vertical\_shift, info-\/>input\_h, info-\/>output\_h);}
\DoxyCodeLine{2404 }
\DoxyCodeLine{2405     STBIR\_PROGRESS\_REPORT(0);}
\DoxyCodeLine{2406 }
\DoxyCodeLine{2407     \textcolor{keywordflow}{if} (stbir\_\_use\_height\_upsampling(info))}
\DoxyCodeLine{2408         stbir\_\_buffer\_loop\_upsample(info);}
\DoxyCodeLine{2409     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2410         stbir\_\_buffer\_loop\_downsample(info);}
\DoxyCodeLine{2411 }
\DoxyCodeLine{2412     STBIR\_PROGRESS\_REPORT(1);}
\DoxyCodeLine{2413 }
\DoxyCodeLine{2414 \textcolor{preprocessor}{\#ifdef STBIR\_DEBUG\_OVERWRITE\_TEST}}
\DoxyCodeLine{2415     STBIR\_ASSERT(memcmp(overwrite\_output\_before\_pre, \&((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)output\_data)[-\/OVERWRITE\_ARRAY\_SIZE], OVERWRITE\_ARRAY\_SIZE) == 0);}
\DoxyCodeLine{2416     STBIR\_ASSERT(memcmp(overwrite\_output\_after\_pre, \&((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)output\_data)[begin\_forbidden], OVERWRITE\_ARRAY\_SIZE) == 0);}
\DoxyCodeLine{2417     STBIR\_ASSERT(memcmp(overwrite\_tempmem\_before\_pre, \&((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)tempmem)[-\/OVERWRITE\_ARRAY\_SIZE], OVERWRITE\_ARRAY\_SIZE) == 0);}
\DoxyCodeLine{2418     STBIR\_ASSERT(memcmp(overwrite\_tempmem\_after\_pre, \&((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)tempmem)[tempmem\_size\_in\_bytes], OVERWRITE\_ARRAY\_SIZE) == 0);}
\DoxyCodeLine{2419 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2420 }
\DoxyCodeLine{2421     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2422 \}}
\DoxyCodeLine{2423 }
\DoxyCodeLine{2424 }
\DoxyCodeLine{2425 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbir\_\_resize\_arbitrary(}
\DoxyCodeLine{2426     \textcolor{keywordtype}{void} *alloc\_context,}
\DoxyCodeLine{2427     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* input\_data, \textcolor{keywordtype}{int} input\_w, \textcolor{keywordtype}{int} input\_h, \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2428     \textcolor{keywordtype}{void}* output\_data, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2429     \textcolor{keywordtype}{float} s0, \textcolor{keywordtype}{float} t0, \textcolor{keywordtype}{float} s1, \textcolor{keywordtype}{float} t1, \textcolor{keywordtype}{float} *transform,}
\DoxyCodeLine{2430     \textcolor{keywordtype}{int} channels, \textcolor{keywordtype}{int} alpha\_channel, stbir\_uint32 flags, stbir\_datatype type,}
\DoxyCodeLine{2431     stbir\_filter h\_filter, stbir\_filter v\_filter,}
\DoxyCodeLine{2432     stbir\_edge edge\_horizontal, stbir\_edge edge\_vertical, stbir\_colorspace colorspace)}
\DoxyCodeLine{2433 \{}
\DoxyCodeLine{2434     stbir\_\_info info;}
\DoxyCodeLine{2435     \textcolor{keywordtype}{int} result;}
\DoxyCodeLine{2436     \textcolor{keywordtype}{size\_t} memory\_required;}
\DoxyCodeLine{2437     \textcolor{keywordtype}{void}* extra\_memory;}
\DoxyCodeLine{2438 }
\DoxyCodeLine{2439     stbir\_\_setup(\&info, input\_w, input\_h, output\_w, output\_h, channels);}
\DoxyCodeLine{2440     stbir\_\_calculate\_transform(\&info, s0,t0,s1,t1,transform);}
\DoxyCodeLine{2441     stbir\_\_choose\_filter(\&info, h\_filter, v\_filter);}
\DoxyCodeLine{2442     memory\_required = stbir\_\_calculate\_memory(\&info);}
\DoxyCodeLine{2443     extra\_memory = STBIR\_MALLOC(memory\_required, alloc\_context);}
\DoxyCodeLine{2444 }
\DoxyCodeLine{2445     \textcolor{keywordflow}{if} (!extra\_memory)}
\DoxyCodeLine{2446         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2447 }
\DoxyCodeLine{2448     result = stbir\_\_resize\_allocated(\&info, input\_data, input\_stride\_in\_bytes,}
\DoxyCodeLine{2449                                             output\_data, output\_stride\_in\_bytes,}
\DoxyCodeLine{2450                                             alpha\_channel, flags, type,}
\DoxyCodeLine{2451                                             edge\_horizontal, edge\_vertical,}
\DoxyCodeLine{2452                                             colorspace, extra\_memory, memory\_required);}
\DoxyCodeLine{2453 }
\DoxyCodeLine{2454     STBIR\_FREE(extra\_memory, alloc\_context);}
\DoxyCodeLine{2455 }
\DoxyCodeLine{2456     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{2457 \}}
\DoxyCodeLine{2458 }
\DoxyCodeLine{2459 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint8(     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2460                                            \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2461                                      \textcolor{keywordtype}{int} num\_channels)}
\DoxyCodeLine{2462 \{}
\DoxyCodeLine{2463     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(NULL, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2464         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2465         0,0,1,1,NULL,num\_channels,-\/1,0, STBIR\_TYPE\_UINT8, STBIR\_FILTER\_DEFAULT, STBIR\_FILTER\_DEFAULT,}
\DoxyCodeLine{2466         STBIR\_EDGE\_CLAMP, STBIR\_EDGE\_CLAMP, STBIR\_COLORSPACE\_LINEAR);}
\DoxyCodeLine{2467 \}}
\DoxyCodeLine{2468 }
\DoxyCodeLine{2469 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_float(     \textcolor{keyword}{const} \textcolor{keywordtype}{float} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2470                                            \textcolor{keywordtype}{float} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2471                                      \textcolor{keywordtype}{int} num\_channels)}
\DoxyCodeLine{2472 \{}
\DoxyCodeLine{2473     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(NULL, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2474         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2475         0,0,1,1,NULL,num\_channels,-\/1,0, STBIR\_TYPE\_FLOAT, STBIR\_FILTER\_DEFAULT, STBIR\_FILTER\_DEFAULT,}
\DoxyCodeLine{2476         STBIR\_EDGE\_CLAMP, STBIR\_EDGE\_CLAMP, STBIR\_COLORSPACE\_LINEAR);}
\DoxyCodeLine{2477 \}}
\DoxyCodeLine{2478 }
\DoxyCodeLine{2479 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint8\_srgb(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2480                                            \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2481                                      \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags)}
\DoxyCodeLine{2482 \{}
\DoxyCodeLine{2483     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(NULL, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2484         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2485         0,0,1,1,NULL,num\_channels,alpha\_channel,flags, STBIR\_TYPE\_UINT8, STBIR\_FILTER\_DEFAULT, STBIR\_FILTER\_DEFAULT,}
\DoxyCodeLine{2486         STBIR\_EDGE\_CLAMP, STBIR\_EDGE\_CLAMP, STBIR\_COLORSPACE\_SRGB);}
\DoxyCodeLine{2487 \}}
\DoxyCodeLine{2488 }
\DoxyCodeLine{2489 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint8\_srgb\_edgemode(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2490                                                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2491                                               \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{2492                                               stbir\_edge edge\_wrap\_mode)}
\DoxyCodeLine{2493 \{}
\DoxyCodeLine{2494     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(NULL, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2495         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2496         0,0,1,1,NULL,num\_channels,alpha\_channel,flags, STBIR\_TYPE\_UINT8, STBIR\_FILTER\_DEFAULT, STBIR\_FILTER\_DEFAULT,}
\DoxyCodeLine{2497         edge\_wrap\_mode, edge\_wrap\_mode, STBIR\_COLORSPACE\_SRGB);}
\DoxyCodeLine{2498 \}}
\DoxyCodeLine{2499 }
\DoxyCodeLine{2500 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint8\_generic( \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2501                                                \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2502                                          \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{2503                                          stbir\_edge edge\_wrap\_mode, stbir\_filter filter, stbir\_colorspace space,}
\DoxyCodeLine{2504                                          \textcolor{keywordtype}{void} *alloc\_context)}
\DoxyCodeLine{2505 \{}
\DoxyCodeLine{2506     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(alloc\_context, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2507         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2508         0,0,1,1,NULL,num\_channels,alpha\_channel,flags, STBIR\_TYPE\_UINT8, filter, filter,}
\DoxyCodeLine{2509         edge\_wrap\_mode, edge\_wrap\_mode, space);}
\DoxyCodeLine{2510 \}}
\DoxyCodeLine{2511 }
\DoxyCodeLine{2512 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_uint16\_generic(\textcolor{keyword}{const} stbir\_uint16 *input\_pixels  , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2513                                                stbir\_uint16 *output\_pixels , \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2514                                          \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{2515                                          stbir\_edge edge\_wrap\_mode, stbir\_filter filter, stbir\_colorspace space,}
\DoxyCodeLine{2516                                          \textcolor{keywordtype}{void} *alloc\_context)}
\DoxyCodeLine{2517 \{}
\DoxyCodeLine{2518     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(alloc\_context, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2519         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2520         0,0,1,1,NULL,num\_channels,alpha\_channel,flags, STBIR\_TYPE\_UINT16, filter, filter,}
\DoxyCodeLine{2521         edge\_wrap\_mode, edge\_wrap\_mode, space);}
\DoxyCodeLine{2522 \}}
\DoxyCodeLine{2523 }
\DoxyCodeLine{2524 }
\DoxyCodeLine{2525 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_float\_generic( \textcolor{keyword}{const} \textcolor{keywordtype}{float} *input\_pixels         , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2526                                                \textcolor{keywordtype}{float} *output\_pixels        , \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2527                                          \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{2528                                          stbir\_edge edge\_wrap\_mode, stbir\_filter filter, stbir\_colorspace space,}
\DoxyCodeLine{2529                                          \textcolor{keywordtype}{void} *alloc\_context)}
\DoxyCodeLine{2530 \{}
\DoxyCodeLine{2531     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(alloc\_context, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2532         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2533         0,0,1,1,NULL,num\_channels,alpha\_channel,flags, STBIR\_TYPE\_FLOAT, filter, filter,}
\DoxyCodeLine{2534         edge\_wrap\_mode, edge\_wrap\_mode, space);}
\DoxyCodeLine{2535 \}}
\DoxyCodeLine{2536 }
\DoxyCodeLine{2537 }
\DoxyCodeLine{2538 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize(         \textcolor{keyword}{const} \textcolor{keywordtype}{void} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2539                                          \textcolor{keywordtype}{void} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2540                                    stbir\_datatype datatype,}
\DoxyCodeLine{2541                                    \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{2542                                    stbir\_edge edge\_mode\_horizontal, stbir\_edge edge\_mode\_vertical,}
\DoxyCodeLine{2543                                    stbir\_filter filter\_horizontal,  stbir\_filter filter\_vertical,}
\DoxyCodeLine{2544                                    stbir\_colorspace space, \textcolor{keywordtype}{void} *alloc\_context)}
\DoxyCodeLine{2545 \{}
\DoxyCodeLine{2546     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(alloc\_context, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2547         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2548         0,0,1,1,NULL,num\_channels,alpha\_channel,flags, datatype, filter\_horizontal, filter\_vertical,}
\DoxyCodeLine{2549         edge\_mode\_horizontal, edge\_mode\_vertical, space);}
\DoxyCodeLine{2550 \}}
\DoxyCodeLine{2551 }
\DoxyCodeLine{2552 }
\DoxyCodeLine{2553 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_subpixel(\textcolor{keyword}{const} \textcolor{keywordtype}{void} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2554                                          \textcolor{keywordtype}{void} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2555                                    stbir\_datatype datatype,}
\DoxyCodeLine{2556                                    \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{2557                                    stbir\_edge edge\_mode\_horizontal, stbir\_edge edge\_mode\_vertical,}
\DoxyCodeLine{2558                                    stbir\_filter filter\_horizontal,  stbir\_filter filter\_vertical,}
\DoxyCodeLine{2559                                    stbir\_colorspace space, \textcolor{keywordtype}{void} *alloc\_context,}
\DoxyCodeLine{2560                                    \textcolor{keywordtype}{float} x\_scale, \textcolor{keywordtype}{float} y\_scale,}
\DoxyCodeLine{2561                                    \textcolor{keywordtype}{float} x\_offset, \textcolor{keywordtype}{float} y\_offset)}
\DoxyCodeLine{2562 \{}
\DoxyCodeLine{2563     \textcolor{keywordtype}{float} transform[4];}
\DoxyCodeLine{2564     transform[0] = x\_scale;}
\DoxyCodeLine{2565     transform[1] = y\_scale;}
\DoxyCodeLine{2566     transform[2] = x\_offset;}
\DoxyCodeLine{2567     transform[3] = y\_offset;}
\DoxyCodeLine{2568     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(alloc\_context, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2569         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2570         0,0,1,1,transform,num\_channels,alpha\_channel,flags, datatype, filter\_horizontal, filter\_vertical,}
\DoxyCodeLine{2571         edge\_mode\_horizontal, edge\_mode\_vertical, space);}
\DoxyCodeLine{2572 \}}
\DoxyCodeLine{2573 }
\DoxyCodeLine{2574 STBIRDEF \textcolor{keywordtype}{int} stbir\_resize\_region(  \textcolor{keyword}{const} \textcolor{keywordtype}{void} *input\_pixels , \textcolor{keywordtype}{int} input\_w , \textcolor{keywordtype}{int} input\_h , \textcolor{keywordtype}{int} input\_stride\_in\_bytes,}
\DoxyCodeLine{2575                                          \textcolor{keywordtype}{void} *output\_pixels, \textcolor{keywordtype}{int} output\_w, \textcolor{keywordtype}{int} output\_h, \textcolor{keywordtype}{int} output\_stride\_in\_bytes,}
\DoxyCodeLine{2576                                    stbir\_datatype datatype,}
\DoxyCodeLine{2577                                    \textcolor{keywordtype}{int} num\_channels, \textcolor{keywordtype}{int} alpha\_channel, \textcolor{keywordtype}{int} flags,}
\DoxyCodeLine{2578                                    stbir\_edge edge\_mode\_horizontal, stbir\_edge edge\_mode\_vertical,}
\DoxyCodeLine{2579                                    stbir\_filter filter\_horizontal,  stbir\_filter filter\_vertical,}
\DoxyCodeLine{2580                                    stbir\_colorspace space, \textcolor{keywordtype}{void} *alloc\_context,}
\DoxyCodeLine{2581                                    \textcolor{keywordtype}{float} s0, \textcolor{keywordtype}{float} t0, \textcolor{keywordtype}{float} s1, \textcolor{keywordtype}{float} t1)}
\DoxyCodeLine{2582 \{}
\DoxyCodeLine{2583     \textcolor{keywordflow}{return} stbir\_\_resize\_arbitrary(alloc\_context, input\_pixels, input\_w, input\_h, input\_stride\_in\_bytes,}
\DoxyCodeLine{2584         output\_pixels, output\_w, output\_h, output\_stride\_in\_bytes,}
\DoxyCodeLine{2585         s0,t0,s1,t1,NULL,num\_channels,alpha\_channel,flags, datatype, filter\_horizontal, filter\_vertical,}
\DoxyCodeLine{2586         edge\_mode\_horizontal, edge\_mode\_vertical, space);}
\DoxyCodeLine{2587 \}}
\DoxyCodeLine{2588 }
\DoxyCodeLine{2589 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STB\_IMAGE\_RESIZE\_IMPLEMENTATION}}
\DoxyCodeLine{2590 }
\DoxyCodeLine{2591 \textcolor{comment}{/*}}
\DoxyCodeLine{2592 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2593 \textcolor{comment}{This software is available under 2 licenses -\/-\/ choose whichever you prefer.}}
\DoxyCodeLine{2594 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2595 \textcolor{comment}{ALTERNATIVE A -\/ MIT License}}
\DoxyCodeLine{2596 \textcolor{comment}{Copyright (c) 2017 Sean Barrett}}
\DoxyCodeLine{2597 \textcolor{comment}{Permission is hereby granted, free of charge, to any person obtaining a copy of}}
\DoxyCodeLine{2598 \textcolor{comment}{this software and associated documentation files (the "{}Software"{}), to deal in}}
\DoxyCodeLine{2599 \textcolor{comment}{the Software without restriction, including without limitation the rights to}}
\DoxyCodeLine{2600 \textcolor{comment}{use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies}}
\DoxyCodeLine{2601 \textcolor{comment}{of the Software, and to permit persons to whom the Software is furnished to do}}
\DoxyCodeLine{2602 \textcolor{comment}{so, subject to the following conditions:}}
\DoxyCodeLine{2603 \textcolor{comment}{The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{2604 \textcolor{comment}{copies or substantial portions of the Software.}}
\DoxyCodeLine{2605 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{2606 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{2607 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{2608 \textcolor{comment}{AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{2609 \textcolor{comment}{LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{2610 \textcolor{comment}{OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{2611 \textcolor{comment}{SOFTWARE.}}
\DoxyCodeLine{2612 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2613 \textcolor{comment}{ALTERNATIVE B -\/ Public Domain (www.unlicense.org)}}
\DoxyCodeLine{2614 \textcolor{comment}{This is free and unencumbered software released into the public domain.}}
\DoxyCodeLine{2615 \textcolor{comment}{Anyone is free to copy, modify, publish, use, compile, sell, or distribute this}}
\DoxyCodeLine{2616 \textcolor{comment}{software, either in source code form or as a compiled binary, for any purpose,}}
\DoxyCodeLine{2617 \textcolor{comment}{commercial or non-\/commercial, and by any means.}}
\DoxyCodeLine{2618 \textcolor{comment}{In jurisdictions that recognize copyright laws, the author or authors of this}}
\DoxyCodeLine{2619 \textcolor{comment}{software dedicate any and all copyright interest in the software to the public}}
\DoxyCodeLine{2620 \textcolor{comment}{domain. We make this dedication for the benefit of the public at large and to}}
\DoxyCodeLine{2621 \textcolor{comment}{the detriment of our heirs and successors. We intend this dedication to be an}}
\DoxyCodeLine{2622 \textcolor{comment}{overt act of relinquishment in perpetuity of all present and future rights to}}
\DoxyCodeLine{2623 \textcolor{comment}{this software under copyright law.}}
\DoxyCodeLine{2624 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{2625 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{2626 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{2627 \textcolor{comment}{AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN}}
\DoxyCodeLine{2628 \textcolor{comment}{ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION}}
\DoxyCodeLine{2629 \textcolor{comment}{WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{2630 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2631 \textcolor{comment}{*/}}

\end{DoxyCode}
